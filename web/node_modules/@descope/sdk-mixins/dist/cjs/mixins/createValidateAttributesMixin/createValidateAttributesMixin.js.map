{"version":3,"file":"createValidateAttributesMixin.js","sources":["../../../../src/mixins/createValidateAttributesMixin/createValidateAttributesMixin.ts"],"sourcesContent":["import { compose } from '@descope/sdk-helpers';\nimport { observeAttributesMixin } from '../observeAttributesMixin';\nimport { initLifecycleMixin } from '../initLifecycleMixin';\nimport { loggerMixin } from '../loggerMixin';\nimport { missingAttrValidator } from './commonValidators';\n\nconst createValidateAttributesMixin =\n  (mappings: Record<string, CheckValueFn | string>) =>\n  <T extends CustomElementConstructor>(superclass: T) => {\n    const BaseClass = compose(\n      loggerMixin,\n      initLifecycleMixin,\n      observeAttributesMixin,\n    )(superclass);\n    const mappingsNames = Object.keys(mappings);\n\n    return class ValidateAttributesMixinClass extends BaseClass {\n      #handleError(attrName: string, newValue: string | null) {\n        const onError = mappings[attrName];\n\n        const error =\n          typeof onError === 'function' ? onError(attrName, newValue) : onError;\n\n        if (error) {\n          this.logger.error(error);\n        }\n      }\n\n      constructor(...args: any) {\n        super(...args);\n\n        this.observeAttributes(mappingsNames, this.#handleError.bind(this));\n      }\n\n      async init() {\n        // check attributes initial values\n        mappingsNames.forEach((attr) =>\n          this.#handleError(attr, this.getAttribute(attr)),\n        );\n        await super.init?.();\n      }\n    };\n  };\n\ncreateValidateAttributesMixin.missingAttrValidator = missingAttrValidator;\n\nexport type CheckValueFn = (\n  attrName: string,\n  value: string | null,\n) => false | string;\n\nexport { createValidateAttributesMixin };\n"],"names":["compose","loggerMixin","initLifecycleMixin","observeAttributesMixin","__classPrivateFieldGet","missingAttrValidator"],"mappings":";;;;;;;;;AAMM,MAAA,6BAA6B,GACjC,CAAC,QAA+C,KAChD,CAAqC,UAAa,KAAI;;AACpD,IAAA,MAAM,SAAS,GAAGA,kBAAO,CACvBC,uBAAW,EACXC,qCAAkB,EAClBC,6CAAsB,CACvB,CAAC,UAAU,CAAC,CAAC;IACd,MAAM,aAAa,GAAG,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;IAE5C,OAAO,EAAA,GAAA,MAAM,4BAA6B,SAAQ,SAAS,CAAA;AAYzD,YAAA,WAAA,CAAY,GAAG,IAAS,EAAA;AACtB,gBAAA,KAAK,CAAC,GAAG,IAAI,CAAC,CAAC;;AAEf,gBAAA,IAAI,CAAC,iBAAiB,CAAC,aAAa,EAAEC,4BAAA,CAAA,IAAI,EAAa,uCAAA,EAAA,GAAA,EAAA,yCAAA,CAAA,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;aACrE;AAED,YAAA,MAAM,IAAI,GAAA;;;gBAER,aAAa,CAAC,OAAO,CAAC,CAAC,IAAI,KACzBA,4BAAA,CAAA,IAAI,EAAa,uCAAA,EAAA,GAAA,EAAA,yCAAA,CAAA,CAAA,IAAA,CAAjB,IAAI,EAAc,IAAI,EAAE,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC,CACjD,CAAC;AACF,gBAAA,OAAM,CAAA,EAAA,GAAA,KAAK,CAAC,IAAI,MAAA,IAAA,IAAA,EAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,EAAA,CAAA,IAAA,CAAA,IAAA,CAAI,CAAA,CAAC;aACtB;AACF,SAAA;;AAxBc,QAAA,yCAAA,GAAA,SAAA,yCAAA,CAAA,QAAgB,EAAE,QAAuB,EAAA;AACpD,YAAA,MAAM,OAAO,GAAG,QAAQ,CAAC,QAAQ,CAAC,CAAC;AAEnC,YAAA,MAAM,KAAK,GACT,OAAO,OAAO,KAAK,UAAU,GAAG,OAAO,CAAC,QAAQ,EAAE,QAAQ,CAAC,GAAG,OAAO,CAAC;YAExE,IAAI,KAAK,EAAE;AACT,gBAAA,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;aAC1B;SACF;AAeD,QAAA,EAAA,CAAA;AACJ,EAAE;AAEJ,6BAA6B,CAAC,oBAAoB,GAAGC,qCAAoB;;;;"}