"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../node_modules/.pnpm/@rollup_plugin-typescript@11.1.6_rollup@4.22.4_tslib@2.8.1_typescript@5.4.5/node_modules/tslib/tslib.es6.js"),t=require("react"),r=require("../constants.js"),s=require("../hooks/Context.js"),n=require("../sdk.js"),o=require("./withPropsMapping/index.js");function a(e){return e&&e.__esModule?e:{default:e}}var l=a(t);const u=t.lazy((async()=>(((null===customElements||void 0===customElements?void 0:customElements.get("descope-wc"))||await import("@descope/web-component").then((e=>e.default))).sdkConfigOverrides={baseHeaders:r.baseHeaders,persistTokens:!1,hooks:{get beforeRequest(){return n.getGlobalSdk().httpClient.hooks.beforeRequest},set beforeRequest(e){}}},{default:o.default(l.default.forwardRef(((s,n)=>{var{"external-request-id":o}=s,a=e.__rest(s,["external-request-id"]);return t.useMemo((()=>{var e,t;e="x-external-rid",(t=o)?r.baseHeaders[e]=t:delete r.baseHeaders[e]}),[o]),l.default.createElement("descope-wc",Object.assign({ref:n},a))})))}))),d=l.default.forwardRef((({flowId:e,onSuccess:r,onError:n,onReady:o,logger:a,tenant:d,theme:c,nonce:i,locale:p,debug:f,client:m,form:v,telemetryKey:b,redirectUrl:E,autoFocus:h,validateOnBlur:y,restartOnError:L,errorTransformer:g,styleId:k,onScreenUpdate:q,dismissScreenErrorOnInput:U,outboundAppId:_,outboundAppScopes:w,children:x,externalRequestId:I},S)=>{const[C,R]=t.useState(null);t.useImperativeHandle(S,(()=>C));const{projectId:j,baseUrl:O,baseStaticUrl:A,baseCdnUrl:H,storeLastAuthenticatedUser:M,keepLastAuthenticatedUserAfterLogout:N,refreshCookieName:T,sdk:B}=l.default.useContext(s.default),F=t.useCallback((async e=>{await B.httpClient.hooks.afterRequest({},new Response(JSON.stringify(e.detail))),r&&r(e)}),[r]);return t.useEffect((()=>{const e=C;return null==e||e.addEventListener("success",F),n&&(null==e||e.addEventListener("error",n)),o&&(null==e||e.addEventListener("ready",o)),()=>{n&&(null==e||e.removeEventListener("error",n)),o&&(null==e||e.removeEventListener("ready",o)),null==e||e.removeEventListener("success",F)}}),[C,n,F]),t.useEffect((()=>{const e=C;return null==e||e.addEventListener("success",F),()=>{null==e||e.removeEventListener("success",F)}}),[C,F]),t.useEffect((()=>{const e=C;return n&&(null==e||e.addEventListener("error",n)),()=>{n&&(null==e||e.removeEventListener("error",n))}}),[C,n]),t.useEffect((()=>{const e=C;return o&&(null==e||e.addEventListener("ready",o)),()=>{o&&(null==e||e.removeEventListener("error",o))}}),[C,o]),l.default.createElement("form",null,l.default.createElement(t.Suspense,{fallback:null},l.default.createElement(u,{projectId:j,flowId:e,baseUrl:O,baseStaticUrl:A,baseCdnUrl:H,ref:R,telemetryKey:b,redirectUrl:E,autoFocus:h,styleId:k,validateOnBlur:y,restartOnError:L,keepLastAuthenticatedUserAfterLogout:N,tenant:d,externalRequestId:I,"theme.attr":c,"nonce.attr":i,"locale.attr":p,"form.attr":v,"client.attr":m,"debug.attr":f,"outbound-app-id.attr":_,"outbound-app-scopes.attr":w,"store-last-authenticated-user.attr":M,"refreshCookieName.attr":T,"dismiss-screen-error-on-input.attr":U,"errorTransformer.prop":g,"logger.prop":a,"onScreenUpdate.prop":q},x)))}));exports.default=d;
//# sourceMappingURL=Descope.js.map
