
      /**
       * @descope/user-profile-widget v0.6.14
       */
      import{__awaiter as e,__classPrivateFieldGet as t,__classPrivateFieldSet as i}from"tslib";import{createTemplate as s,kebabCase as o,createSingletonMixin as r,compose as a,withMemCache as h}from"@descope/sdk-helpers";import{projectIdMixin as l,observeAttributesMixin as n,loggerMixin as d,baseUrlMixin as c,cookieConfigMixin as u,createStateManagementMixin as f,initLifecycleMixin as v,modalMixin as g,themeMixin as m,staticResourcesMixin as p,createValidateAttributesMixin as w,descopeUiMixin as b,initElementMixin as U,debuggerMixin as y}from"@descope/sdk-mixins";import{FlowDriver as k,AvatarDriver as C,UserAttributeDriver as R,ButtonDriver as S,UserAuthMethodDriver as M}from"@descope/sdk-component-drivers";import{createAsyncThunk as W}from"@reduxjs/toolkit";import"@descope/core-js-sdk";import I from"@descope/web-js-sdk";import{createSelector as A}from"reselect";import"@descope/web-component";const j=(e={})=>{const t=s("<descope-wc></descope-wc>");return Object.entries(e).forEach((([e,i])=>{t.content.querySelector("descope-wc").setAttribute(o(e),i)})),t};function N(e){return new URLSearchParams(window.location.search).get(e)}const F=e=>(...t)=>i=>{i.addCase(e.pending,((e,i)=>{t.forEach((({onPending:t})=>{null==t||t(e,i)}))})),i.addCase(e.fulfilled,((e,i)=>{t.forEach((({onFulfilled:t})=>{null==t||t(e,i)}))})),i.addCase(e.rejected,((e,i)=>{t.forEach((({onRejected:t})=>{null==t||t(e,i)}))}))},x=W("users/me",((e,{extra:{api:t}})=>t.user.me())),T=F(x)({onFulfilled:(e,t)=>{e.me.data=t.payload}},(E=e=>e.me,{onFulfilled:e=>{E(e).loading=!1},onPending:e=>{E(e).loading=!0,E(e).error=null},onRejected:(e,t)=>{E(e).loading=!1,E(e).error=t.error}}));var E;const O={action:x,reducer:T},q=W("users/logout",((e,{extra:{api:t}})=>t.user.logout())),P={action:q,reducer:F(q)({})},L={me:{loading:!1,error:null,data:{}}},D={me:"/v1/auth/me"},$=()=>e(void 0,void 0,void 0,(function*(){return new Promise((e=>{e({loginIds:["user@company.com"],externalIds:["user@company.com"],userId:"user-1",name:"Test User",email:"user@company.com",roleNames:["Role"],phone:"+1-202-555-010",verifiedEmail:!0,verifiedPhone:!0,userTenants:[],status:"enabled",editable:!0,createdTime:(new Date).getTime(),customAttributes:{},familyName:"",givenName:"",middleName:"",picture:void 0,password:!0,SAML:!1,test:!1,TOTP:!1,webauthn:!0})}))})),B=({httpClient:t,mock:i})=>({me:()=>e(void 0,void 0,void 0,(function*(){if(i)return $();const s=yield t.get(D.me);return yield(t=>e(void 0,void 0,void 0,(function*(){const e=yield t.text(),i=JSON.parse(e);if(!t.ok){const e=`${i.errorDescription}${i.errorMessage?`: ${i.errorMessage}`:""}`;throw Error(e||`${t.status} ${t.statusText}`)}t.json=()=>Promise.resolve(i),t.text=()=>Promise.resolve(e)})))(s),s.json()}))}),H=r((s=>{var o,r,h,f;const v=a(l,n,d,c,u)(s);return f=class extends v{constructor(){super(...arguments),o.add(this),r.set(this,void 0)}get widgetId(){return this.getAttribute("widget-id")}get mock(){return this.getAttribute("mock")}get api(){return t(this,r,"f")||t(this,o,"m",h).call(this),t(this,r,"f")}init(){const i=Object.create(null,{init:{get:()=>super.init}});return e(this,void 0,void 0,(function*(){var e;yield null===(e=i.init)||void 0===e?void 0:e.call(this),this.observeAttributes(["project-id","base-url"],(()=>{t(this,r,"f")&&t(this,o,"m",h).call(this)}))}))}},r=new WeakMap,o=new WeakSet,h=function(){this.logger.debug("creating an sdk instance"),i(this,r,((t,i,s)=>{const o=I(Object.assign(Object.assign({},t),{persistTokens:!0,baseHeaders:{"x-descope-widget-type":"user-profile-widget","x-descope-widget-id":s,"x-descope-widget-version":"0.6.14"}}));return{user:Object.assign(Object.assign({},B({httpClient:o.httpClient,mock:i})),{logout:i?()=>e(void 0,void 0,void 0,(function*(){})):o.logout})}})({projectId:this.projectId,baseUrl:this.baseUrl,refreshCookieName:this.refreshCookieName},"true"===this.mock,this.widgetId),"f")},f})),V=r((e=>{const t=a(f({name:"widget",initialState:L,reducers:{},extraReducers:e=>{O.reducer(e),P.reducer(e)},asyncActions:{getMe:O.action,logout:P.action}}),v,d,H)(e);return class extends t{constructor(...e){super(...e),this.state=L,this.subscribe((e=>{this.logger.debug("State update:",e),this.state=e}))}}})),X="widget-flow",G=r((i=>{var s,o,r;return r=class extends(a(v,g,V,u,d,m)(i)){constructor(){super(...arguments),s.add(this)}init(){const i=Object.create(null,{init:{get:()=>super.init}});return e(this,void 0,void 0,(function*(){var e;yield null===(e=i.init)||void 0===e?void 0:e.call(this);const r=N(X);r&&(!function(e){if(window.history.replaceState&&N(e)){const t=new URL(window.location.href),i=new URLSearchParams(t.search);i.delete(e),t.search=i.toString(),window.history.replaceState({},"",t.toString())}}(X),t(this,s,"m",o).call(this,r))}))}},s=new WeakSet,o=function(e){const t=this.createModal({"data-id":"redirect-flow"});t.setContent(j({projectId:this.projectId,flowId:e,baseUrl:this.baseUrl,baseStaticUrl:this.baseStaticUrl,baseCdnUrl:this.baseCdnUrl,refreshCookieName:this.refreshCookieName,theme:this.theme}));new k((()=>{var e;return null===(e=t.ele)||void 0===e?void 0:e.querySelector("descope-wc")}),{logger:this.logger}).onSuccess((()=>{t.close(),this.actions.getMe()})),t.afterClose=()=>{t.remove()},t.open()},r})),J=e=>e.me.data,Y=A(J,(e=>e.picture)),_=A(J,(e=>e.email)),z=A(J,(e=>e.verifiedEmail)),K=A(J,(e=>e.name)),Q=A(J,(e=>e.phone)),Z=A(J,(e=>e.verifiedPhone)),ee=A(J,(e=>e.webauthn));A(J,(e=>e.password));const te=A(J,(e=>e.TOTP)),ie=A(J,(e=>e.customAttributes)),se=A(J,(e=>({givenName:e.givenName,middleName:e.middleName,familyName:e.familyName}))),oe=r((t=>{const i=a(p,w({"widget-id":w.missingAttrValidator}))(t);return class extends i{get widgetId(){return this.getAttribute("widget-id")}fetchWidgetPage(t){return e(this,void 0,void 0,(function*(){return(yield this.fetchStaticResource(`user-profile-widget/${this.widgetId}/${t}`,"text")).body}))}}})),re=r((i=>{var o,r,h;return h=class extends(a(d,v,b,U,oe,V)(i)){constructor(){super(...arguments),o.add(this)}onWidgetRootReady(){return e(this,void 0,void 0,(function*(){}))}init(){const i=Object.create(null,{init:{get:()=>super.init}});return e(this,void 0,void 0,(function*(){var e;yield null===(e=i.init)||void 0===e?void 0:e.call(this),yield Promise.all([this.actions.getMe(),t(this,o,"m",r).call(this)]),this.onWidgetRootReady()}))}},o=new WeakSet,r=function(){return e(this,void 0,void 0,(function*(){const e=s(yield this.fetchWidgetPage("root.html"));yield this.loadDescopeUiComponents(e),this.contentRootElement.append(e.content.cloneNode(!0))}))},h})),ae=r((e=>class extends(a(m,n)(e)){syncFlowTheme(e){e.theme=this.theme,this.observeAttributes(["theme"],(()=>{e.theme=this.theme}))}})),he=r((s=>{var o,r,l,n,c,f,v,p,w;return w=class extends(a(ae,m,V,d,u,re,g)(s)){constructor(){super(...arguments),o.add(this),r.set(this,void 0),l.set(this,void 0),v.set(this,h((e=>{this.avatar.image=e}))),p.set(this,h((e=>{this.avatar.displayName=e})))}onWidgetRootReady(){const i=Object.create(null,{onWidgetRootReady:{get:()=>super.onWidgetRootReady}});return e(this,void 0,void 0,(function*(){var e;yield null===(e=i.onWidgetRootReady)||void 0===e?void 0:e.call(this),t(this,o,"m",f).call(this),t(this,o,"m",n).call(this),t(this,v,"f").call(this,Y(this.state)),t(this,p,"f").call(this,K(this.state)),this.subscribe(t(this,v,"f").bind(this),Y),this.subscribe(t(this,p,"f").bind(this),K)}))}},r=new WeakMap,l=new WeakMap,v=new WeakMap,p=new WeakMap,o=new WeakSet,n=function(){this.avatar.flowId&&(i(this,r,this.createModal({"data-id":"update-pic"}),"f"),i(this,l,new k((()=>{var e;return null===(e=t(this,r,"f").ele)||void 0===e?void 0:e.querySelector("descope-wc")}),{logger:this.logger}),"f"),t(this,r,"f").afterClose=t(this,o,"m",c).bind(this),t(this,o,"m",c).call(this),this.syncFlowTheme(t(this,l,"f")))},c=function(){t(this,r,"f").setContent(j({projectId:this.projectId,flowId:this.avatar.flowId,baseUrl:this.baseUrl,baseStaticUrl:this.baseStaticUrl,baseCdnUrl:this.baseCdnUrl,refreshCookieName:this.refreshCookieName,theme:this.theme})),t(this,l,"f").onSuccess((()=>{t(this,r,"f").close(),this.actions.getMe()}))},f=function(){this.avatar=new C((()=>{var e;return null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("descope-avatar")}),{logger:this.logger}),this.avatar.onClick((()=>{var e;null===(e=t(this,r,"f"))||void 0===e||e.open()}))},w})),le=r((s=>{var o,r,l,n,c,f,v,m,p,w,b,U,y;return y=class extends(a(ae,V,d,re,u,g)(s)){constructor(){super(...arguments),o.add(this),r.set(this,void 0),l.set(this,void 0),n.set(this,void 0),c.set(this,void 0),b.set(this,h((e=>{this.emailUserAttr.value=e}))),U.set(this,h((e=>{this.emailUserAttr.badgeLabel=e?"":"Unverified"})))}onWidgetRootReady(){const i=Object.create(null,{onWidgetRootReady:{get:()=>super.onWidgetRootReady}});return e(this,void 0,void 0,(function*(){var e;yield null===(e=i.onWidgetRootReady)||void 0===e?void 0:e.call(this),t(this,o,"m",w).call(this),t(this,o,"m",f).call(this),t(this,o,"m",m).call(this),t(this,b,"f").call(this,_(this.state)),t(this,U,"f").call(this,z(this.state)),this.subscribe(t(this,b,"f").bind(this),_),this.subscribe(t(this,U,"f").bind(this),z)}))}},r=new WeakMap,l=new WeakMap,n=new WeakMap,c=new WeakMap,b=new WeakMap,U=new WeakMap,o=new WeakSet,f=function(){this.emailUserAttr.editFlowId&&(i(this,r,this.createModal({"data-id":"edit-email"}),"f"),i(this,l,new k((()=>{var e;return null===(e=t(this,r,"f").ele)||void 0===e?void 0:e.querySelector("descope-wc")}),{logger:this.logger}),"f"),t(this,r,"f").afterClose=t(this,o,"m",v).bind(this),t(this,o,"m",v).call(this),this.syncFlowTheme(t(this,l,"f")))},v=function(){t(this,r,"f").setContent(j({projectId:this.projectId,flowId:this.emailUserAttr.editFlowId,baseUrl:this.baseUrl,baseStaticUrl:this.baseStaticUrl,baseCdnUrl:this.baseCdnUrl,refreshCookieName:this.refreshCookieName,theme:this.theme})),t(this,l,"f").onSuccess((()=>{t(this,r,"f").close(),this.actions.getMe()}))},m=function(){this.emailUserAttr.deleteFlowId&&(i(this,n,this.createModal({"data-id":"delete-email"}),"f"),i(this,c,new k((()=>{var e;return null===(e=t(this,n,"f").ele)||void 0===e?void 0:e.querySelector("descope-wc")}),{logger:this.logger}),"f"),t(this,n,"f").afterClose=t(this,o,"m",p).bind(this),t(this,o,"m",p).call(this),this.syncFlowTheme(t(this,c,"f")))},p=function(){t(this,n,"f").setContent(j({projectId:this.projectId,flowId:this.emailUserAttr.deleteFlowId,baseUrl:this.baseUrl,baseStaticUrl:this.baseStaticUrl,baseCdnUrl:this.baseCdnUrl,refreshCookieName:this.refreshCookieName,theme:this.theme})),t(this,c,"f").onSuccess((()=>{t(this,n,"f").close(),this.actions.getMe()}))},w=function(){this.emailUserAttr=new R((()=>{var e;return null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector('descope-user-attribute[data-id="email"]')}),{logger:this.logger}),this.emailUserAttr.onEditClick((()=>{var e;null===(e=t(this,r,"f"))||void 0===e||e.open()})),this.emailUserAttr.onDeleteClick((()=>{var e;null===(e=t(this,n,"f"))||void 0===e||e.open()}))},y})),ne=r((i=>{var s,o,r;return r=class extends(a(V,d,re,g)(i)){constructor(){super(...arguments),s.add(this)}onWidgetRootReady(){const i=Object.create(null,{onWidgetRootReady:{get:()=>super.onWidgetRootReady}});return e(this,void 0,void 0,(function*(){var e;yield null===(e=i.onWidgetRootReady)||void 0===e?void 0:e.call(this),t(this,s,"m",o).call(this)}))}},s=new WeakSet,o=function(){this.logout=new S((()=>{var e;return null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector('descope-button[data-id="logout"]')}),{logger:this.logger}),this.logout.onClick((()=>e(this,void 0,void 0,(function*(){yield this.actions.logout(),this.dispatchEvent(new CustomEvent("logout"))}))))},r})),de=r((s=>{var o,r,l,n,c,f,v,m,p,w,b,U;return U=class extends(a(ae,V,d,re,u,g)(s)){constructor(){super(...arguments),o.add(this),r.set(this,void 0),l.set(this,void 0),n.set(this,void 0),c.set(this,void 0),b.set(this,h((e=>{this.nameUserAttr.value=e})))}onWidgetRootReady(){const i=Object.create(null,{onWidgetRootReady:{get:()=>super.onWidgetRootReady}});return e(this,void 0,void 0,(function*(){var e;yield null===(e=i.onWidgetRootReady)||void 0===e?void 0:e.call(this),t(this,o,"m",w).call(this),t(this,o,"m",f).call(this),t(this,o,"m",m).call(this),t(this,b,"f").call(this,K(this.state)),this.subscribe(t(this,b,"f").bind(this),K)}))}},r=new WeakMap,l=new WeakMap,n=new WeakMap,c=new WeakMap,b=new WeakMap,o=new WeakSet,f=function(){this.nameUserAttr.editFlowId&&(i(this,r,this.createModal({"data-id":"edit-name"}),"f"),i(this,l,new k((()=>{var e;return null===(e=t(this,r,"f").ele)||void 0===e?void 0:e.querySelector("descope-wc")}),{logger:this.logger}),"f"),t(this,r,"f").afterClose=t(this,o,"m",v).bind(this),t(this,o,"m",v).call(this),this.syncFlowTheme(t(this,l,"f")))},v=function(){t(this,r,"f").setContent(j({projectId:this.projectId,flowId:this.nameUserAttr.editFlowId,baseUrl:this.baseUrl,baseStaticUrl:this.baseStaticUrl,baseCdnUrl:this.baseCdnUrl,refreshCookieName:this.refreshCookieName,theme:this.theme})),t(this,l,"f").onSuccess((()=>{t(this,r,"f").close(),this.actions.getMe()}))},m=function(){this.nameUserAttr.deleteFlowId&&(i(this,n,this.createModal({"data-id":"delete-name"}),"f"),i(this,c,new k((()=>{var e;return null===(e=t(this,n,"f").ele)||void 0===e?void 0:e.querySelector("descope-wc")}),{logger:this.logger}),"f"),t(this,n,"f").afterClose=t(this,o,"m",p).bind(this),t(this,o,"m",p).call(this),this.syncFlowTheme(t(this,c,"f")))},p=function(){t(this,n,"f").setContent(j({projectId:this.projectId,flowId:this.nameUserAttr.deleteFlowId,baseUrl:this.baseUrl,baseStaticUrl:this.baseStaticUrl,baseCdnUrl:this.baseCdnUrl,refreshCookieName:this.refreshCookieName,theme:this.theme})),t(this,c,"f").onSuccess((()=>{t(this,n,"f").close(),this.actions.getMe()}))},w=function(){this.nameUserAttr=new R((()=>{var e;return null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector('descope-user-attribute[data-id="name"]')}),{logger:this.logger}),this.nameUserAttr.onEditClick((()=>{var e;null===(e=t(this,r,"f"))||void 0===e||e.open()})),this.nameUserAttr.onDeleteClick((()=>{var e;null===(e=t(this,n,"f"))||void 0===e||e.open()}))},U})),ce=r((s=>{var o,r,l,n,c,f,v,m,p,w,b,U;return U=class extends(a(ae,V,d,re,u,g)(s)){constructor(){super(...arguments),o.add(this),r.set(this,void 0),l.set(this,void 0),n.set(this,void 0),c.set(this,void 0),b.set(this,h((e=>{this.passkeyUserAuthMethod.fulfilled=e})))}onWidgetRootReady(){const i=Object.create(null,{onWidgetRootReady:{get:()=>super.onWidgetRootReady}});return e(this,void 0,void 0,(function*(){var e;yield null===(e=i.onWidgetRootReady)||void 0===e?void 0:e.call(this),t(this,o,"m",w).call(this),t(this,o,"m",f).call(this),t(this,o,"m",m).call(this),t(this,b,"f").call(this,ee(this.state)),this.subscribe(t(this,b,"f").bind(this),ee)}))}},r=new WeakMap,l=new WeakMap,n=new WeakMap,c=new WeakMap,b=new WeakMap,o=new WeakSet,f=function(){this.passkeyUserAuthMethod.flowId&&(i(this,r,this.createModal({"data-id":"add-passkey"}),"f"),i(this,l,new k((()=>{var e;return null===(e=t(this,r,"f").ele)||void 0===e?void 0:e.querySelector("descope-wc")}),{logger:this.logger}),"f"),t(this,r,"f").afterClose=t(this,o,"m",v).bind(this),t(this,o,"m",v).call(this),this.syncFlowTheme(t(this,l,"f")))},v=function(){t(this,r,"f").setContent(j({projectId:this.projectId,flowId:this.passkeyUserAuthMethod.flowId,baseUrl:this.baseUrl,baseStaticUrl:this.baseStaticUrl,baseCdnUrl:this.baseCdnUrl,refreshCookieName:this.refreshCookieName,theme:this.theme})),t(this,l,"f").onSuccess((()=>{t(this,r,"f").close(),this.actions.getMe()}))},m=function(){this.passkeyUserAuthMethod.fulfilledFlowId&&(i(this,n,this.createModal({"data-id":"remove-passkey"}),"f"),i(this,c,new k((()=>{var e;return null===(e=t(this,n,"f").ele)||void 0===e?void 0:e.querySelector("descope-wc")}),{logger:this.logger}),"f"),t(this,n,"f").afterClose=t(this,o,"m",p).bind(this),t(this,o,"m",p).call(this),this.syncFlowTheme(t(this,c,"f")))},p=function(){t(this,n,"f").setContent(j({projectId:this.projectId,flowId:this.passkeyUserAuthMethod.fulfilledFlowId,baseUrl:this.baseUrl,baseStaticUrl:this.baseStaticUrl,baseCdnUrl:this.baseCdnUrl,refreshCookieName:this.refreshCookieName,theme:this.theme})),t(this,c,"f").onSuccess((()=>{t(this,n,"f").close(),this.actions.getMe()}))},w=function(){this.passkeyUserAuthMethod=new M((()=>{var e;return null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector('descope-user-auth-method[data-id="passkey"]')}),{logger:this.logger}),this.passkeyUserAuthMethod.onUnfulfilledButtonClick((()=>{var e;null===(e=t(this,r,"f"))||void 0===e||e.open()})),this.passkeyUserAuthMethod.onFulfilledButtonClick((()=>{var e;null===(e=t(this,n,"f"))||void 0===e||e.open()}))},U})),ue=r((s=>{var o,r,h,l,n,c;return c=class extends(a(ae,V,d,re,u,g)(s)){constructor(){super(...arguments),o.add(this),r.set(this,void 0),h.set(this,void 0)}initPasswordAuthMethod(){this.passwordUserAuthMethod=new M((()=>{var e;return null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector('descope-user-auth-method[data-id="password"]')}),{logger:this.logger}),this.passwordUserAuthMethod.onUnfulfilledButtonClick((()=>{var e;null===(e=t(this,r,"f"))||void 0===e||e.open()}))}onWidgetRootReady(){const i=Object.create(null,{onWidgetRootReady:{get:()=>super.onWidgetRootReady}});return e(this,void 0,void 0,(function*(){var e;yield null===(e=i.onWidgetRootReady)||void 0===e?void 0:e.call(this),this.initPasswordAuthMethod(),t(this,o,"m",l).call(this)}))}},r=new WeakMap,h=new WeakMap,o=new WeakSet,l=function(){this.passwordUserAuthMethod.flowId&&(i(this,r,this.createModal({"data-id":"password"}),"f"),i(this,h,new k((()=>{var e;return null===(e=t(this,r,"f").ele)||void 0===e?void 0:e.querySelector("descope-wc")}),{logger:this.logger}),"f"),t(this,r,"f").afterClose=t(this,o,"m",n).bind(this),t(this,o,"m",n).call(this),this.syncFlowTheme(t(this,h,"f")))},n=function(){t(this,r,"f").setContent(j({projectId:this.projectId,flowId:this.passwordUserAuthMethod.flowId,baseUrl:this.baseUrl,baseStaticUrl:this.baseStaticUrl,baseCdnUrl:this.baseCdnUrl,refreshCookieName:this.refreshCookieName,theme:this.theme})),t(this,h,"f").onSuccess((()=>{t(this,r,"f").close()}))},c})),fe=r((s=>{var o,r,l,n,c,f,v,m,p,w,b,U,y;return y=class extends(a(ae,V,d,re,u,g)(s)){constructor(){super(...arguments),o.add(this),r.set(this,void 0),l.set(this,void 0),n.set(this,void 0),c.set(this,void 0),b.set(this,h((e=>{this.phoneUserAttr.value=e}))),U.set(this,h((e=>{this.phoneUserAttr.badgeLabel=e?"":"Unverified"})))}onWidgetRootReady(){const i=Object.create(null,{onWidgetRootReady:{get:()=>super.onWidgetRootReady}});return e(this,void 0,void 0,(function*(){var e;yield null===(e=i.onWidgetRootReady)||void 0===e?void 0:e.call(this),t(this,o,"m",w).call(this),t(this,o,"m",f).call(this),t(this,o,"m",m).call(this),t(this,b,"f").call(this,Q(this.state)),t(this,U,"f").call(this,Z(this.state)),this.subscribe(t(this,b,"f").bind(this),Q),this.subscribe(t(this,U,"f").bind(this),Z)}))}},r=new WeakMap,l=new WeakMap,n=new WeakMap,c=new WeakMap,b=new WeakMap,U=new WeakMap,o=new WeakSet,f=function(){this.phoneUserAttr.editFlowId&&(i(this,r,this.createModal({"data-id":"edit-phone"}),"f"),i(this,l,new k((()=>{var e;return null===(e=t(this,r,"f").ele)||void 0===e?void 0:e.querySelector("descope-wc")}),{logger:this.logger}),"f"),t(this,r,"f").afterClose=t(this,o,"m",v).bind(this),t(this,o,"m",v).call(this),this.syncFlowTheme(t(this,l,"f")))},v=function(){t(this,r,"f").setContent(j({projectId:this.projectId,flowId:this.phoneUserAttr.editFlowId,baseUrl:this.baseUrl,baseStaticUrl:this.baseStaticUrl,baseCdnUrl:this.baseCdnUrl,refreshCookieName:this.refreshCookieName,theme:this.theme})),t(this,l,"f").onSuccess((()=>{t(this,r,"f").close(),this.actions.getMe()}))},m=function(){this.phoneUserAttr.deleteFlowId&&(i(this,n,this.createModal({"data-id":"delete-phone"}),"f"),i(this,c,new k((()=>{var e;return null===(e=t(this,n,"f").ele)||void 0===e?void 0:e.querySelector("descope-wc")}),{logger:this.logger}),"f"),t(this,n,"f").afterClose=t(this,o,"m",p).bind(this),t(this,o,"m",p).call(this),this.syncFlowTheme(t(this,c,"f")))},p=function(){t(this,n,"f").setContent(j({projectId:this.projectId,flowId:this.phoneUserAttr.deleteFlowId,baseUrl:this.baseUrl,baseStaticUrl:this.baseStaticUrl,baseCdnUrl:this.baseCdnUrl,refreshCookieName:this.refreshCookieName,theme:this.theme})),t(this,c,"f").onSuccess((()=>{t(this,n,"f").close(),this.actions.getMe()}))},w=function(){this.phoneUserAttr=new R((()=>{var e;return null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector('descope-user-attribute[data-id="phone"]')}),{logger:this.logger}),this.phoneUserAttr.onEditClick((()=>{var e;null===(e=t(this,r,"f"))||void 0===e||e.open()})),this.phoneUserAttr.onDeleteClick((()=>{var e;null===(e=t(this,n,"f"))||void 0===e||e.open()}))},y})),ve=r((s=>{var o,r,l,n,c,f,v,m;return m=class extends(a(ae,V,d,re,u,g)(s)){constructor(){super(...arguments),o.add(this),r.set(this,void 0),l.set(this,void 0),v.set(this,h((e=>{this.totpUserAuthMethod.fulfilled=e})))}onWidgetRootReady(){const i=Object.create(null,{onWidgetRootReady:{get:()=>super.onWidgetRootReady}});return e(this,void 0,void 0,(function*(){var e;yield null===(e=i.onWidgetRootReady)||void 0===e?void 0:e.call(this),t(this,o,"m",f).call(this),t(this,o,"m",n).call(this),t(this,v,"f").call(this,te(this.state)),this.subscribe(t(this,v,"f").bind(this),te)}))}},r=new WeakMap,l=new WeakMap,v=new WeakMap,o=new WeakSet,n=function(){this.totpUserAuthMethod.flowId&&(i(this,r,this.createModal({"data-id":"totp"}),"f"),i(this,l,new k((()=>{var e;return null===(e=t(this,r,"f").ele)||void 0===e?void 0:e.querySelector("descope-wc")}),{logger:this.logger}),"f"),t(this,r,"f").afterClose=t(this,o,"m",c).bind(this),t(this,o,"m",c).call(this),this.syncFlowTheme(t(this,l,"f")))},c=function(){t(this,r,"f").setContent(j({projectId:this.projectId,flowId:this.totpUserAuthMethod.flowId,baseUrl:this.baseUrl,baseStaticUrl:this.baseStaticUrl,baseCdnUrl:this.baseCdnUrl,refreshCookieName:this.refreshCookieName,theme:this.theme})),t(this,l,"f").onSuccess((()=>{t(this,r,"f").close(),this.actions.getMe()}))},f=function(){this.totpUserAuthMethod=new M((()=>{var e;return null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector('descope-user-auth-method[data-id="totp"]')}),{logger:this.logger}),this.totpUserAuthMethod.onUnfulfilledButtonClick((()=>{var e;null===(e=t(this,r,"f"))||void 0===e||e.open()}))},m})),ge=r((i=>{var s,o,r,l,n,c,f,v,m,p,w;return w=class extends(a(ae,V,d,re,u,g)(i)){constructor(){super(...arguments),s.add(this),o.set(this,{}),r.set(this,{}),l.set(this,{}),n.set(this,{}),v.set(this,h((e=>{var i;const o=null===(i=this.shadowRoot)||void 0===i?void 0:i.querySelectorAll('descope-user-attribute[data-id^="builtin."]');Array.from(o).forEach((i=>{const o=i.getAttribute("data-id").replace("builtin.",""),r=e[o],a=new R(i,{logger:this.logger});a.value=(r||"").toString(),t(this,s,"m",m).call(this,i,o,a),t(this,s,"m",p).call(this,i,o,a)}))})))}onWidgetRootReady(){const i=Object.create(null,{onWidgetRootReady:{get:()=>super.onWidgetRootReady}});return e(this,void 0,void 0,(function*(){var e;yield null===(e=i.onWidgetRootReady)||void 0===e?void 0:e.call(this),t(this,v,"f").call(this,se(this.state)),this.subscribe(t(this,v,"f").bind(this),se)}))}},o=new WeakMap,r=new WeakMap,l=new WeakMap,n=new WeakMap,v=new WeakMap,s=new WeakSet,c=function(e){var i,s;null===(i=t(this,o,"f")[e])||void 0===i||i.setContent(j({projectId:this.projectId,flowId:e,baseUrl:this.baseUrl,baseStaticUrl:this.baseStaticUrl,baseCdnUrl:this.baseCdnUrl,refreshCookieName:this.refreshCookieName,theme:this.theme})),null===(s=t(this,r,"f")[e])||void 0===s||s.onSuccess((()=>{var i;null===(i=t(this,o,"f")[e])||void 0===i||i.close(),this.actions.getMe()}))},f=function(e){var i,s;null===(i=t(this,l,"f")[e])||void 0===i||i.setContent(j({projectId:this.projectId,flowId:e,baseUrl:this.baseUrl,baseStaticUrl:this.baseStaticUrl,baseCdnUrl:this.baseCdnUrl,refreshCookieName:this.refreshCookieName,theme:this.theme})),null===(s=t(this,n,"f")[e])||void 0===s||s.onSuccess((()=>{var i;null===(i=t(this,l,"f")[e])||void 0===i||i.close(),this.actions.getMe()}))},m=function(e,i,a){const h=e.getAttribute("edit-flow-id");h&&(t(this,o,"f")[h]=this.createModal({"data-id":`edit-${i}`}),t(this,r,"f")[h]=new k((()=>{var e,i;return null===(i=null===(e=t(this,o,"f")[h])||void 0===e?void 0:e.ele)||void 0===i?void 0:i.querySelector("descope-wc")}),{logger:this.logger}),t(this,o,"f")[h].afterClose=t(this,s,"m",c).bind(this,h),a.onEditClick((()=>{var e,i;null===(i=null===(e=t(this,o,"f"))||void 0===e?void 0:e[h])||void 0===i||i.open()})),t(this,s,"m",c).call(this,h),this.syncFlowTheme(t(this,r,"f")[h]))},p=function(e,i,o){const r=e.getAttribute("delete-flow-id");r&&(t(this,l,"f")[r]=this.createModal({"data-id":`delete-${i}`}),t(this,n,"f")[r]=new k((()=>{var e,i;return null===(i=null===(e=t(this,l,"f")[r])||void 0===e?void 0:e.ele)||void 0===i?void 0:i.querySelector("descope-wc")}),{logger:this.logger}),t(this,l,"f")[r].afterClose=t(this,s,"m",f).bind(this,r),o.onDeleteClick((()=>{var e,i;null===(i=null===(e=t(this,l,"f"))||void 0===e?void 0:e[r])||void 0===i||i.open()})),t(this,s,"m",f).call(this,r),this.syncFlowTheme(t(this,n,"f")[r]))},w}));var me;!function(e){e.TEXT="text",e.NUMBER="number",e.BOOLEAN="boolean",e.SINGLE_SELECT="singleSelect",e.ARRAY="array",e.DATE="date"}(me||(me={}));const pe=r((i=>{var s,o,r,l,n,c,f,v,m,p,w;return o=class extends(a(ae,V,d,re,u,g)(i)){constructor(){super(...arguments),s.add(this),r.set(this,{}),l.set(this,{}),n.set(this,{}),c.set(this,{}),m.set(this,h((e=>{var i;const r=null===(i=this.shadowRoot)||void 0===i?void 0:i.querySelectorAll('descope-user-attribute[data-id^="customAttributes."]');Array.from(r).forEach((i=>{const r=i.getAttribute("data-id").replace("customAttributes.",""),a=i.getAttribute("data-type")||me.TEXT,h=e[r],l=new R(i,{logger:this.logger});l.value=o.getFormattedValue(a,h),t(this,s,"m",p).call(this,i,r,l),t(this,s,"m",w).call(this,i,r,l)}))})))}static getFormattedValue(e,t){return e===me.DATE&&t?new Date(t).toLocaleString():e===me.BOOLEAN&&void 0!==t?t?"True":"False":(t||"").toString()}onWidgetRootReady(){const i=Object.create(null,{onWidgetRootReady:{get:()=>super.onWidgetRootReady}});return e(this,void 0,void 0,(function*(){var e;yield null===(e=i.onWidgetRootReady)||void 0===e?void 0:e.call(this),t(this,m,"f").call(this,ie(this.state)),this.subscribe(t(this,m,"f").bind(this),ie)}))}},r=new WeakMap,l=new WeakMap,n=new WeakMap,c=new WeakMap,m=new WeakMap,s=new WeakSet,f=function(e){var i,s;null===(i=t(this,r,"f")[e])||void 0===i||i.setContent(j({projectId:this.projectId,flowId:e,baseUrl:this.baseUrl,baseStaticUrl:this.baseStaticUrl,baseCdnUrl:this.baseCdnUrl,refreshCookieName:this.refreshCookieName,theme:this.theme})),null===(s=t(this,l,"f")[e])||void 0===s||s.onSuccess((()=>{var i;null===(i=t(this,r,"f")[e])||void 0===i||i.close(),this.actions.getMe()}))},v=function(e){var i,s;null===(i=t(this,n,"f")[e])||void 0===i||i.setContent(j({projectId:this.projectId,flowId:e,baseUrl:this.baseUrl,baseStaticUrl:this.baseStaticUrl,baseCdnUrl:this.baseCdnUrl,refreshCookieName:this.refreshCookieName,theme:this.theme})),null===(s=t(this,c,"f")[e])||void 0===s||s.onSuccess((()=>{var i;null===(i=t(this,n,"f")[e])||void 0===i||i.close(),this.actions.getMe()}))},p=function(e,i,o){const a=e.getAttribute("edit-flow-id");a&&(t(this,r,"f")[a]=this.createModal({"data-id":`edit-${i}`}),t(this,l,"f")[a]=new k((()=>{var e,i;return null===(i=null===(e=t(this,r,"f")[a])||void 0===e?void 0:e.ele)||void 0===i?void 0:i.querySelector("descope-wc")}),{logger:this.logger}),t(this,r,"f")[a].afterClose=t(this,s,"m",f).bind(this,a),o.onEditClick((()=>{var e,i;null===(i=null===(e=t(this,r,"f"))||void 0===e?void 0:e[a])||void 0===i||i.open()})),t(this,s,"m",f).call(this,a),this.syncFlowTheme(t(this,l,"f")[a]))},w=function(e,i,o){const r=e.getAttribute("delete-flow-id");r&&(t(this,n,"f")[r]=this.createModal({"data-id":`delete-${i}`}),t(this,c,"f")[r]=new k((()=>{var e,i;return null===(i=null===(e=t(this,n,"f")[r])||void 0===e?void 0:e.ele)||void 0===i?void 0:i.querySelector("descope-wc")}),{logger:this.logger}),t(this,n,"f")[r].afterClose=t(this,s,"m",v).bind(this,r),o.onDeleteClick((()=>{var e,i;null===(i=null===(e=t(this,n,"f"))||void 0===e?void 0:e[r])||void 0===i||i.open()})),t(this,s,"m",v).call(this,r),this.syncFlowTheme(t(this,c,"f")[r]))},o})),we=r((t=>class extends(a(y,m,G,pe,le,he,de,fe,ce,ue,ve,ge,ne)(t)){init(){const t=Object.create(null,{init:{get:()=>super.init}});return e(this,void 0,void 0,(function*(){var e;yield null===(e=t.init)||void 0===e?void 0:e.call(this)}))}})),be=a((t=>class extends(we(t)){init(){const t=Object.create(null,{init:{get:()=>super.init}});return e(this,void 0,void 0,(function*(){var e;yield null===(e=t.init)||void 0===e?void 0:e.call(this);(customElements.get("descope-wc")||(yield import("@descope/web-component").then((e=>e.default)))).sdkConfigOverrides={baseHeaders:{"x-descope-widget-type":"user-profile-widget","x-descope-widget-id":this.getAttribute("widget-id"),"x-descope-widget-version":"0.6.14"}}}))}}))(HTMLElement);customElements.define("descope-user-profile-widget",be);export{be as default};
//# sourceMappingURL=index.js.map
