{"version":3,"file":"webauthn.js","sources":["../../../src/lib/helpers/webauthn.ts"],"sourcesContent":["/* eslint @typescript-eslint/no-use-before-define: 0 */\n\nimport { withMemCache, timeoutPromise, getChromiumVersion } from './helpers';\n\nconst CHROMIUM_VERSION_THAT_SUPPORTS_PASSKEYS = 108;\n\n// eslint-disable-next-line import/prefer-default-export\nexport const isConditionalLoginSupported = withMemCache(async () => {\n  if (\n    !window.PublicKeyCredential ||\n    !(<any>PublicKeyCredential).isConditionalMediationAvailable ||\n    !PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable\n  ) {\n    return false;\n  }\n  try {\n    const isSupported = Promise.all([\n      (<any>window.PublicKeyCredential)?.isConditionalMediationAvailable(),\n      window.PublicKeyCredential?.isUserVerifyingPlatformAuthenticatorAvailable(),\n    ]).then((arr) => arr.every((value) => !!value));\n\n    // when using Dashlane Chrome extension, \"isConditionalMediationAvailable\" never resolved and the app hangs\n    // if timeout exceeded, we are deciding if passkeys are supported based on the Chromium version\n    const isChromiumSupported =\n      getChromiumVersion() >= CHROMIUM_VERSION_THAT_SUPPORTS_PASSKEYS;\n\n    return await timeoutPromise(100, isSupported, isChromiumSupported);\n  } catch (err) {\n    // eslint-disable-next-line no-console\n    console.error('Conditional login check failed', err);\n    return false;\n  }\n});\n"],"names":["isConditionalLoginSupported","withMemCache","__awaiter","window","PublicKeyCredential","isConditionalMediationAvailable","isUserVerifyingPlatformAuthenticatorAvailable","isSupported","Promise","all","_a","_b","then","arr","every","value","isChromiumSupported","getChromiumVersion","timeoutPromise","err","console","error"],"mappings":"0HAIA,MAGaA,EAA8BC,GAAa,IAAWC,OAAA,OAAA,OAAA,GAAA,oBACjE,IACGC,OAAOC,sBACDA,oBAAqBC,kCAC3BD,oBAAoBE,8CAErB,OAAO,EAET,IACE,MAAMC,EAAcC,QAAQC,IAAI,CACG,QAAjCC,EAAMP,OAAOC,2BAAoB,IAAAM,OAAA,EAAAA,EAAEL,kCACT,QAA1BM,EAAAR,OAAOC,2BAAmB,IAAAO,OAAA,EAAAA,EAAEL,kDAC3BM,MAAMC,GAAQA,EAAIC,OAAOC,KAAYA,MAIlCC,EACJC,KApB0C,IAsB5C,aAAaC,EAAe,IAAKX,EAAaS,EAC/C,CAAC,MAAOG,GAGP,OADAC,QAAQC,MAAM,iCAAkCF,IACzC,CACR,CACH"}