"use strict";var e,t,s,i,r=require("tslib"),a=require("./helpers.js");function l(e,t){const s=Object.getOwnPropertyNames(e),i=Object.getOwnPropertyNames(t);if(s.length!==i.length)return!1;for(let i=0;i<s.length;i+=1){const r=s[i],a=e[r],c=t[r];if(null===a||null===c){if(a!==c)return!1}else if("object"==typeof a&&"object"==typeof c){if(!l(a,c))return!1}else if(a!==c)return!1}return!0}e=new WeakMap,t=new WeakMap,s=new WeakMap,i=new WeakMap,module.exports=class{constructor(c={},{forceUpdate:n=!1}={}){e.set(this,void 0),t.set(this,{}),s.set(this,0),i.set(this,!0),this.update=s=>{const c="function"==typeof s?s(r.__classPrivateFieldGet(this,e,"f")):s,n=Object.assign(Object.assign({},r.__classPrivateFieldGet(this,e,"f")),c),f=r.__classPrivateFieldGet(this,e,"f");r.__classPrivateFieldSet(this,e,n,"f"),Object.freeze(r.__classPrivateFieldGet(this,e,"f")),setTimeout((()=>{Object.values(r.__classPrivateFieldGet(this,t,"f")).forEach((({cb:e,selector:t,forceUpdate:s})=>{const c=t(f),o=t(n);(r.__classPrivateFieldGet(this,i,"f")||s||(function(e){if("object"!=typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return t===Object.prototype||null===t}(o)?!l(c,o):c!==o))&&e(o,c,a.createIsChanged(o,c))}))}),0)},r.__classPrivateFieldSet(this,e,c,"f"),r.__classPrivateFieldSet(this,i,n,"f")}get current(){return Object.assign({},r.__classPrivateFieldGet(this,e,"f"))}set forceUpdate(e){r.__classPrivateFieldSet(this,i,e,"f")}subscribe(e,i=e=>e,{forceUpdate:a=!1}={}){return r.__classPrivateFieldSet(this,s,r.__classPrivateFieldGet(this,s,"f")+1,"f"),r.__classPrivateFieldGet(this,t,"f")[r.__classPrivateFieldGet(this,s,"f")]={cb:e,selector:i,forceUpdate:a},r.__classPrivateFieldGet(this,s,"f").toString()}unsubscribe(e){const s=!!r.__classPrivateFieldGet(this,t,"f")[e];return s&&delete r.__classPrivateFieldGet(this,t,"f")[e],s}unsubscribeAll(){return r.__classPrivateFieldSet(this,t,{},"f"),!0}};
//# sourceMappingURL=state.js.map
