import {
  staticResourcesMixin,
  themeMixin
} from "./chunk-JGGIE4AD.js";
import {
  Ie,
  N,
  P
} from "./chunk-5SHIU7TC.js";
import {
  $,
  $e,
  Ae,
  Ce,
  E,
  Ee,
  F,
  Fe,
  Ie as Ie2,
  L,
  N as N2,
  Ne,
  O,
  Oe,
  Pe,
  R,
  Re,
  Se,
  T,
  Te,
  Ue,
  a,
  a2,
  be,
  c,
  c2,
  e,
  e2,
  f,
  j,
  je,
  k,
  ke,
  l,
  n,
  n2,
  n3,
  n4,
  o,
  s,
  s2,
  t,
  t2,
  w,
  we,
  xe,
  y,
  ye
} from "./chunk-K43J3HLY.js";
import {
  injectStyleMixin
} from "./chunk-PGJ4DCSZ.js";
import {
  __awaiter,
  __classPrivateFieldGet,
  __classPrivateFieldSet,
  __rest,
  h,
  r
} from "./chunk-C4K4ZQL2.js";

// node_modules/@descope/web-component/dist/esm/helpers/templates.js
var n5 = ["disabled"];
var l2 = (e6, t6, r3 = "") => {
  e6.querySelectorAll(`[${T}="${t6}"]`).forEach((e7) => {
    e7.textContent = r3, e7.classList[r3 ? "remove" : "add"]("hide");
  });
};
var i = (e6, t6) => {
  Object.entries(t6 || {}).forEach(([t7, o4]) => {
    Array.from(e6.querySelectorAll(`*[name="${t7}"]:not([${l}])`)).forEach((e7) => {
      e7.value = o4;
    });
  });
};
var a3 = (e6, t6) => t6.split(".").reduce((e7, t7) => (null == e7 ? void 0 : e7[t7]) || "", e6);
var d = (e6, o4, r3) => e6.replace(/{{(.+?)}}/g, (e7, c3) => r3 ? n3(a3(o4, c3)) : a3(o4, c3));
var u = (e6, t6, r3) => {
  e6.querySelectorAll(`[${T}="${t6}"]`).forEach((e7) => {
    e7.setAttribute("href", r3);
  });
};
var f2 = (e6, t6, o4, r3) => {
  o4 && Object.keys(o4).forEach((c3) => {
    t6.querySelector(c3) || r3.debug(`Skipping css vars for component "${c3}}"`, `Got css vars for component ${c3} but Could not find it on next page`);
    const s3 = customElements.get(c3);
    s3 ? Object.keys(o4[c3]).forEach((t7) => {
      var n8;
      const l3 = o4[c3], i2 = null === (n8 = null == s3 ? void 0 : s3.cssVarList) || void 0 === n8 ? void 0 : n8[t7];
      if (!i2) return void r3.info(`Could not find css variable name for ${t7} in ${c3}`, "Check if the css variable is defined in the component");
      const a4 = l3[t7];
      e6.style.setProperty(i2, a4);
    }) : r3.info(`Could not find component class for ${c3}`, "Check if the component is registered");
  });
};
var p = (e6, t6, o4) => {
  var r3, c3;
  const s3 = null === (r3 = customElements.get(t6)) || void 0 === r3 ? void 0 : r3.cssVarList.url;
  o4 && s3 && (null === (c3 = null == e6 ? void 0 : e6.style) || void 0 === c3 || c3.setProperty(s3, `url(data:image/jpg;base64,${o4})`));
};
var m = (t6, o4, c3, l3, i2) => {
  var a4, f3;
  u(t6, "totp-link", null === (a4 = null == o4 ? void 0 : o4.totp) || void 0 === a4 ? void 0 : a4.provisionUrl), u(t6, "notp-link", null === (f3 = null == o4 ? void 0 : o4.notp) || void 0 === f3 ? void 0 : f3.redirectUrl), ((e6, t7) => {
    e6.querySelectorAll("descope-text,descope-link,descope-enriched-text,descope-code-snippet").forEach((e7) => {
      const o5 = je(e7.localName);
      e7.textContent = d(e7.textContent, t7, o5);
      const r3 = e7.getAttribute("href");
      r3 && e7.setAttribute("href", d(r3, t7));
    });
  })(t6, o4), ((t7, o5, r3) => {
    if (!o5) return;
    const { componentsDynamicAttrs: c4 } = o5, s3 = __rest(o5, ["componentsDynamicAttrs"]), n8 = Object.keys(s3).reduce((e6, t8) => (e6[`[name=${t8}]`] = s3[t8], e6), {});
    c4 && Object.keys(c4).forEach((e6) => {
      const t8 = c4[e6];
      if (t8) {
        const { attributes: o6 } = t8;
        o6 && Object.keys(o6).length && (n8[e6] = o6);
      }
    }), Object.keys(n8).forEach((e6) => {
      t7.querySelectorAll(e6).forEach((t8) => {
        const o6 = n8[e6];
        Object.keys(o6).forEach((e7) => {
          let c5 = o6[e7];
          if ("string" != typeof c5) try {
            c5 = JSON.stringify(c5);
          } catch (t9) {
            r3.error(`Could not stringify value "${c5}" for "${e7}"`, t9.message), c5 = "";
          }
          t8.setAttribute(e7, c5);
        });
      });
    });
  })(t6, c3, i2), ((e6, t7) => {
    e6.querySelectorAll(`[${f}]`).forEach((e7) => {
      Array.from(e7.attributes).forEach((e8) => {
        e8.value = d(e8.value, t7);
      });
    });
  })(t6, o4), ((e6, t7) => {
    Object.entries(t7).forEach(([t8, o5]) => {
      e6.querySelectorAll(`[name="${t8}"]`).forEach((e7) => {
        Object.entries(o5).forEach(([t9, o6]) => {
          n5.includes(t9) && e7.setAttribute(t9, o6);
        });
      });
    });
  })(t6, l3);
};
var h2 = (e6, t6) => {
  i(e6, null == t6 ? void 0 : t6.inputs), i(e6, null == t6 ? void 0 : t6.form);
};
var v = (e6, t6) => {
  p(e6, "descope-totp-image", t6);
};
var y2 = (e6, t6) => {
  p(e6, "descope-notp-image", t6);
};
var b = (e6, t6) => {
  Array.from(e6.querySelectorAll('[default-code="autoDetect"]')).forEach((e7) => {
    e7.setAttribute("default-code", t6);
  });
};
var A = (e6) => {
  e6.querySelectorAll(`descope-button[${T}="biometrics"]`).forEach((e7) => e7.setAttribute("disabled", "true"));
};

// node_modules/@descope/web-component/dist/esm/helpers/abTestingKey.js
var t3 = "dls_ab_testing_id";
var o2 = () => {
  const o4 = localStorage.getItem(t3);
  if (!o4) {
    const o5 = Math.floor(100 * Math.random() + 1);
    return localStorage.setItem(t3, o5.toString()), o5;
  }
  return Number(o4);
};

// node_modules/@descope/web-component/dist/esm/helpers/conditions.js
var e3 = { "lastAuth.loginId": { "not-empty": (e6) => {
  var n8;
  return !!e6.loginId || !!(null === (n8 = e6.lastAuth) || void 0 === n8 ? void 0 : n8.loginId);
}, empty: (e6) => {
  var n8;
  return !e6.loginId && !(null === (n8 = e6.lastAuth) || void 0 === n8 ? void 0 : n8.loginId);
} }, idpInitiated: { "is-true": (e6) => !!e6.code, "is-false": (e6) => !e6.code }, externalToken: { "is-true": (e6) => !!e6.token, "is-false": (e6) => !e6.token }, abTestingKey: { "greater-than": (e6, n8) => (e6.abTestingKey || 0) > n8, "less-than": (e6, n8) => (e6.abTestingKey || 0) < n8, "greater-than-or-equal": (e6, n8) => (e6.abTestingKey || 0) >= n8, "less-than-or-equal": (e6, n8) => (e6.abTestingKey || 0) <= n8, "in-range": (e6, n8) => {
  const [t6, i2] = n8 ? n8.split(",").map(Number) : [void 0, void 0];
  return (e6.abTestingKey || 0) >= (null != t6 ? t6 : 0) && (e6.abTestingKey || 0) <= (null != i2 ? i2 : 0);
}, "not-in-range": (e6, n8) => {
  const [t6, i2] = n8 ? n8.split(",").map(Number) : [void 0, void 0];
  return !(void 0 !== t6 && void 0 !== i2 && !Number.isNaN(t6) && !Number.isNaN(i2)) || ((e6.abTestingKey || 0) < t6 || (e6.abTestingKey || 0) > i2);
}, "devised-by": (e6, n8) => {
  const t6 = Number(n8);
  return !Number.isNaN(t6) && (e6.abTestingKey || 0) % t6 == 0;
} } };
var n6 = (n8, t6) => {
  var i2;
  const r3 = null === (i2 = e3[null == n8 ? void 0 : n8.key]) || void 0 === i2 ? void 0 : i2[n8.operator];
  if (!r3) return {};
  const o4 = r3(t6, n8.predicate) ? n8.met : n8.unmet;
  return { startScreenId: null == o4 ? void 0 : o4.screenId, startScreenName: null == o4 ? void 0 : o4.screenName, conditionInteractionId: null == o4 ? void 0 : o4.interactionId };
};
var t4 = (n8, t6) => {
  const i2 = null == t6 ? void 0 : t6.find(({ key: t7, operator: i3, predicate: r3 }) => {
    var o4;
    if ("ELSE" === t7) return true;
    const a4 = null === (o4 = e3[t7]) || void 0 === o4 ? void 0 : o4[i3];
    return !!(null == a4 ? void 0 : a4(n8, r3));
  });
  return i2 ? { startScreenId: i2.met.screenId, startScreenName: i2.met.screenName, conditionInteractionId: i2.met.interactionId, clientScripts: i2.met.clientScripts, componentsConfig: i2.met.componentsConfig } : {};
};

// node_modules/@descope/web-component/dist/esm/helpers/lastAuth.js
function n7(o4) {
  const n8 = {};
  try {
    Object.assign(n8, JSON.parse(localStorage.getItem(n2)));
  } catch (t6) {
  }
  return (null == n8 ? void 0 : n8.loginId) || o4 ? n8 : {};
}
function e4(n8, e6) {
  (null == n8 ? void 0 : n8.authMethod) && (e6 && !(null == n8 ? void 0 : n8.loginId) || e && localStorage.setItem(n2, JSON.stringify(n8)));
}

// node_modules/@descope/web-component/dist/esm/helpers/flowInputs.js
var e5 = (t6, r3 = "") => Object.keys(t6).reduce((s3, a4) => {
  var n8;
  if (Array.isArray(t6[a4])) return Object.assign(Object.assign({}, s3), { [a4]: { value: t6[a4].map((t7) => "object" == typeof t7 && null !== t7 ? e5(t7) : t7) } });
  if ("object" == typeof t6[a4] && null !== t6[a4] && !(null === (n8 = t6[a4]) || void 0 === n8 ? void 0 : n8.value)) return Object.assign(Object.assign({}, s3), e5(t6[a4], `${r3 + a4}.`));
  const c3 = "object" == typeof t6[a4] ? t6[a4] : { value: t6[a4] }, i2 = Object.assign(Object.assign({}, s3), { [r3 + a4]: c3, [`form.${r3}${a4}`]: c3 });
  return "displayName" === a4 ? Object.assign(Object.assign({}, i2), { [`${r3}fullName`]: c3, [`form.${r3}fullName`]: c3 }) : i2;
}, []);
var t5 = (t6) => {
  try {
    return e5(JSON.parse(t6));
  } catch (e6) {
    return {};
  }
};
var r2 = (e6, t6) => Object.fromEntries(Object.entries(e6).map(([e7, r3]) => [e7, r3[t6]]));

// node_modules/@descope/web-component/dist/esm/mixins/formMountMixin.js
var o3 = h((e6) => {
  var o4, n8, r3, l3;
  return l3 = class extends e6 {
    constructor() {
      super(...arguments), o4.add(this);
    }
    connectedCallback() {
      var e7;
      __classPrivateFieldGet(this, o4, "m", n8).call(this) && __classPrivateFieldGet(this, o4, "m", r3).call(this), null === (e7 = super.connectedCallback) || void 0 === e7 || e7.call(this);
    }
  }, o4 = /* @__PURE__ */ new WeakSet(), n8 = function() {
    return !this.shadowRoot.host.closest("form") && F();
  }, r3 = function() {
    const t6 = this.shadowRoot.host, e7 = document.createElement("form");
    e7.style.width = "100%", e7.style.height = "100%", t6.parentElement.appendChild(e7), e7.appendChild(t6);
  }, l3;
});

// node_modules/@descope/web-component/dist/esm/descope-wc/BaseDescopeWc.js
var A2;
var x;
var y3;
var j2;
var I;
var E2;
var L2;
var U;
var M;
var S;
var O2;
var W;
var D;
var P2;
var N3;
var F2;
var R2;
var T2;
var B;
var V;
var q;
var H;
var J = r(themeMixin, staticResourcesMixin, o3, injectStyleMixin)(HTMLElement);
var K = class extends J {
  static get observedAttributes() {
    return ["project-id", "flow-id", "base-url", "tenant", "locale", "debug", "storage-prefix", "preview", "redirect-url", "auto-focus", "store-last-authenticated-user", "refresh-cookie-name", "keep-last-authenticated-user-after-logout", "validate-on-blur", "style-id"];
  }
  constructor(r3) {
    super(), A2.add(this), y3.set(this, false), this.flowStatus = "initial", this.loggerWrapper = { error: (e6, i2 = "") => {
      this.logger.error(e6, i2, new Error()), __classPrivateFieldGet(this, A2, "m", q).call(this, e6, i2);
    }, warn: (t6, e6 = "") => {
      this.logger.warn(t6, e6);
    }, info: (t6, e6 = "", i2 = {}) => {
      this.logger.info(t6, e6, i2);
    }, debug: (t6, e6 = "") => {
      this.logger.debug(t6, e6);
    } }, j2.set(this, new c2()), I.set(this, new c2()), E2.set(this, {}), this.getComponentsContext = () => __classPrivateFieldGet(this, E2, "f"), this.nextRequestStatus = new c2({ isLoading: false }), L2.set(this, void 0), U.set(this, { popstate: __classPrivateFieldGet(this, A2, "m", D).bind(this), componentsContext: __classPrivateFieldGet(this, A2, "m", T2).bind(this) }), M.set(this, void 0), this.getConfig = () => __awaiter(this, void 0, void 0, function* () {
      return (yield this.config) || { isMissingConfig: true };
    }), __classPrivateFieldSet(this, M, r3, "f"), __classPrivateFieldGet(this, A2, "m", O2).call(this);
  }
  get flowId() {
    return this.getAttribute("flow-id");
  }
  get client() {
    try {
      return JSON.parse(this.getAttribute("client")) || {};
    } catch (t6) {
      return {};
    }
  }
  get tenantId() {
    return this.getAttribute("tenant") || void 0;
  }
  get redirectUrl() {
    return this.getAttribute("redirect-url") || void 0;
  }
  get debug() {
    return "true" === this.getAttribute("debug");
  }
  get locale() {
    return this.getAttribute("locale") || void 0;
  }
  get autoFocus() {
    var t6;
    const e6 = null !== (t6 = this.getAttribute("auto-focus")) && void 0 !== t6 ? t6 : "true";
    return "skipFirstScreen" === e6 ? e6 : "true" === e6;
  }
  get validateOnBlur() {
    return "true" === this.getAttribute("validate-on-blur");
  }
  get storeLastAuthenticatedUser() {
    var t6;
    return "true" === (null !== (t6 = this.getAttribute("store-last-authenticated-user")) && void 0 !== t6 ? t6 : "true");
  }
  get refreshCookieName() {
    return this.getAttribute("refresh-cookie-name") || "";
  }
  get keepLastAuthenticatedUserAfterLogout() {
    return "true" === this.getAttribute("keep-last-authenticated-user-after-logout");
  }
  get storagePrefix() {
    return this.getAttribute("storage-prefix") || "";
  }
  get preview() {
    return !!this.getAttribute("preview");
  }
  get formConfig() {
    return t5(this.form);
  }
  get form() {
    return this.getAttribute("form");
  }
  get formConfigValues() {
    return r2(this.formConfig, "value");
  }
  get outboundAppId() {
    return this.getAttribute("outbound-app-id");
  }
  get outboundAppScopes() {
    try {
      const t6 = JSON.parse(this.getAttribute("outbound-app-scopes"));
      return t6 || null;
    } catch (t6) {
      return null;
    }
  }
  get isRestartOnError() {
    return "true" === this.getAttribute("restart-on-error");
  }
  getExecutionContext() {
    return __awaiter(this, void 0, void 0, function* () {
      const t6 = yield this.getConfig();
      return "executionContext" in t6 ? t6.executionContext : void 0;
    });
  }
  getProjectConfig() {
    return __awaiter(this, void 0, void 0, function* () {
      const t6 = yield this.getConfig();
      return "projectConfig" in t6 ? t6.projectConfig : void 0;
    });
  }
  getFlowConfig() {
    return __awaiter(this, void 0, void 0, function* () {
      var t6, e6;
      const i2 = yield this.getProjectConfig(), r3 = (null === (t6 = null == i2 ? void 0 : i2.flows) || void 0 === t6 ? void 0 : t6[this.flowId]) || {};
      return null !== (e6 = r3.version) && void 0 !== e6 || (r3.version = 0), r3;
    });
  }
  getTargetLocales() {
    return __awaiter(this, void 0, void 0, function* () {
      const t6 = yield this.getFlowConfig();
      return ((null == t6 ? void 0 : t6.targetLocales) || []).map((t7) => t7.toLowerCase());
    });
  }
  getComponentsVersion() {
    return __awaiter(this, void 0, void 0, function* () {
      var t6;
      const e6 = yield this.getConfig(), i2 = "projectConfig" in e6 ? null === (t6 = e6.projectConfig) || void 0 === t6 ? void 0 : t6.componentsVersion : {};
      return i2 || (this.logger.error("Did not get components version, using latest version"), "latest");
    });
  }
  init() {
    const r3 = Object.create(null, { init: { get: () => super.init } });
    return __awaiter(this, void 0, void 0, function* () {
      var e6;
      if (this.flowStatus = "loading", ["ready", "error", "success"].forEach((t6) => this.addEventListener(t6, () => {
        this.flowStatus = t6;
      })), yield null === (e6 = r3.init) || void 0 === e6 ? void 0 : e6.call(this), __classPrivateFieldGet(this, I, "f").subscribe(__classPrivateFieldGet(this, A2, "m", V).bind(this)), __classPrivateFieldGet(this, I, "f").update({ isDebug: this.debug }), __classPrivateFieldGet(this, A2, "m", W).call(this), yield __classPrivateFieldGet(this, A2, "m", F2).call(this)) return void this.loggerWrapper.error("This SDK version does not support your flows version", "Make sure to upgrade your flows to the latest version or use an older SDK version");
      const o4 = yield this.getConfig();
      if ("isMissingConfig" in o4 && o4.isMissingConfig) return void this.loggerWrapper.error("Cannot get config file", "Make sure that your projectId & flowId are correct");
      __classPrivateFieldGet(this, A2, "m", H).call(this);
      const { executionId: s3, stepId: n8, token: u2, code: a4, isPopup: d2, exchangeError: c3, redirectAuthCallbackUrl: h3, redirectAuthBackupCallbackUri: f3, redirectAuthCodeChallenge: g, redirectAuthInitiator: p2, ssoQueryParams: m2 } = be(this.flowId, this.loggerWrapper);
      window.addEventListener("popstate", __classPrivateFieldGet(this, U, "f").popstate), window.addEventListener("components-context", __classPrivateFieldGet(this, U, "f").componentsContext), __classPrivateFieldGet(this, j2, "f").subscribe(__classPrivateFieldGet(this, A2, "m", N3).bind(this)), __classPrivateFieldGet(this, j2, "f").update(Object.assign({ projectId: this.projectId, flowId: this.flowId, baseUrl: this.baseUrl, tenant: this.tenantId, redirectUrl: this.redirectUrl, locale: this.locale, stepId: n8, executionId: s3, token: u2, code: a4, isPopup: d2, exchangeError: c3, redirectAuthCallbackUrl: h3, redirectAuthBackupCallbackUri: f3, redirectAuthCodeChallenge: g, redirectAuthInitiator: p2 }, m2)), __classPrivateFieldSet(this, y3, true, "f");
    });
  }
  disconnectedCallback() {
    __classPrivateFieldGet(this, j2, "f").unsubscribeAll(), __classPrivateFieldGet(this, I, "f").unsubscribeAll(), __classPrivateFieldGet(this, A2, "m", B).call(this), window.removeEventListener("popstate", __classPrivateFieldGet(this, U, "f").popstate), window.removeEventListener("components-context", __classPrivateFieldGet(this, U, "f").componentsContext);
  }
  attributeChangedCallback(e6, i2, r3) {
    if (this.shadowRoot.isConnected && __classPrivateFieldGet(this, y3, "f") && i2 !== r3 && x.observedAttributes.includes(e6)) {
      __classPrivateFieldGet(this, A2, "m", W).call(this);
      const o4 = null === i2;
      __classPrivateFieldGet(this, j2, "f").update(({ stepId: t6, executionId: i3 }) => {
        let s3 = t6, n8 = i3;
        return o4 || (n8 = null, s3 = null, N2()), { [we(e6)]: r3, stepId: s3, executionId: n8 };
      }), __classPrivateFieldGet(this, I, "f").update({ isDebug: this.debug });
    }
  }
};
x = K, y3 = /* @__PURE__ */ new WeakMap(), j2 = /* @__PURE__ */ new WeakMap(), I = /* @__PURE__ */ new WeakMap(), E2 = /* @__PURE__ */ new WeakMap(), L2 = /* @__PURE__ */ new WeakMap(), U = /* @__PURE__ */ new WeakMap(), M = /* @__PURE__ */ new WeakMap(), A2 = /* @__PURE__ */ new WeakSet(), S = function() {
  this.injectStyle("\n    :host {\n			width: 100%;\n      display: block;\n		}\n\n		#root {\n			height: 100%;\n      display: flex;\n      flex-direction: column;\n		}\n\n    #content-root {\n      all: initial;\n      transition: opacity 200ms ease-in-out;\n    }\n\n		#root[data-theme] {\n			background-color: transparent;\n		}\n\n		.fade-out {\n			opacity: 0.1!important;\n		}\n\n    .hidden {\n      display: none;\n    }\n    ");
}, O2 = function() {
  __classPrivateFieldGet(this, A2, "m", S).call(this), this.slotElement = document.createElement("slot"), this.slotElement.classList.add("hidden"), this.rootElement.appendChild(this.slotElement);
}, W = function() {
  const t6 = ["base-url", "tenant", "locale", "debug", "redirect-url", "auto-focus", "store-last-authenticated-user", "refresh-cookie-name", "keep-last-authenticated-user-after-logout", "preview", "storage-prefix", "form", "client", "validate-on-blur", "style-id", "outbound-app-id", "outbound-app-scopes"];
  x.observedAttributes.forEach((e6) => {
    if (!t6.includes(e6) && !this[we(e6)]) throw Error(`${e6} cannot be empty`);
  });
}, D = function() {
  const { stepId: e6, executionId: i2 } = O(this.flowId);
  __classPrivateFieldGet(this, j2, "f").update({ stepId: e6, executionId: i2 });
}, P2 = function(t6, i2) {
  this.sdk = Ie(Object.assign(Object.assign({ persistTokens: true, preview: this.preview, storagePrefix: this.storagePrefix, storeLastAuthenticatedUser: this.storeLastAuthenticatedUser, keepLastAuthenticatedUserAfterLogout: this.keepLastAuthenticatedUserAfterLogout, refreshCookieName: this.refreshCookieName }, x.sdkConfigOverrides), { projectId: t6, baseUrl: i2 })), ["start", "next"].forEach((t7) => {
    const i3 = this.sdk.flow[t7];
    this.sdk.flow[t7] = (...t8) => __awaiter(this, void 0, void 0, function* () {
      try {
        return yield i3(...t8);
      } catch (t9) {
        return { error: { errorCode: o, errorDescription: t9.toString() } };
      }
    });
  });
}, N3 = function(i2, r3, o4) {
  return __awaiter(this, void 0, void 0, function* () {
    const { projectId: e6, baseUrl: r4 } = i2;
    if (o4("projectId") || o4("baseUrl")) {
      if (!e6) return;
      __classPrivateFieldGet(this, A2, "m", P2).call(this, e6, r4);
    }
    __classPrivateFieldGet(this, M, "f").call(this, i2);
  });
}, F2 = function() {
  return __awaiter(this, void 0, void 0, function* () {
    const e6 = yield this.getConfig();
    return "isMissingConfig" in e6 && e6.isMissingConfig && (yield __classPrivateFieldGet(this, A2, "m", R2).call(this));
  });
}, R2 = function() {
  return __awaiter(this, void 0, void 0, function* () {
    const t6 = j({ projectId: this.projectId, filename: c, assetsFolder: s, baseUrl: this.baseStaticUrl });
    try {
      return yield $(t6, "json"), true;
    } catch (t7) {
      return false;
    }
  });
}, T2 = function(e6) {
  __classPrivateFieldSet(this, E2, Object.assign(Object.assign({}, __classPrivateFieldGet(this, E2, "f")), e6.detail), "f");
}, B = function() {
  var e6;
  null === (e6 = __classPrivateFieldGet(this, L2, "f")) || void 0 === e6 || e6.remove(), __classPrivateFieldSet(this, L2, null, "f");
}, V = function(r3) {
  return __awaiter(this, arguments, void 0, function* ({ isDebug: e6 }) {
    e6 ? (__classPrivateFieldSet(this, L2, document.createElement("descope-debugger"), "f"), Object.assign(__classPrivateFieldGet(this, L2, "f").style, { position: "fixed", top: "0", right: "0", height: "100vh", width: "100vw", pointerEvents: "none", zIndex: 99999 }), yield import("./debugger-wc-CB4IPKRY.js"), document.body.appendChild(__classPrivateFieldGet(this, L2, "f"))) : __classPrivateFieldGet(this, A2, "m", B).call(this);
  });
}, q = function(e6, i2) {
  var r3;
  e6 && this.debug && (null === (r3 = __classPrivateFieldGet(this, L2, "f")) || void 0 === r3 || r3.updateData({ title: e6, description: i2 }));
}, H = function() {
  this.rootElement.onkeydown = (t6) => {
    var e6, i2, r3;
    const o4 = !!(null === (e6 = this.shadowRoot.activeElement) || void 0 === e6 ? void 0 : e6.getAttribute("href")), s3 = k.includes(null !== (r3 = null === (i2 = this.shadowRoot.activeElement) || void 0 === i2 ? void 0 : i2.localName) && void 0 !== r3 ? r3 : "");
    if ("Enter" !== t6.key || o4 || s3) return;
    t6.preventDefault();
    const n8 = this.rootElement.querySelectorAll("descope-button");
    if (1 === n8.length && "false" !== n8[0].getAttribute("auto-submit")) return void n8[0].click();
    const u2 = Array.from(n8).filter((t7) => "true" === t7.getAttribute("auto-submit"));
    if (1 === u2.length) return void u2[0].click();
    const l3 = Array.from(n8).filter((t7) => "button" === t7.getAttribute("data-type"));
    if (1 === l3.length) "false" !== l3[0].getAttribute("auto-submit") && l3[0].click();
    else if (0 === l3.length) {
      const t7 = Array.from(n8).filter((t8) => "sso" === t8.getAttribute("data-type"));
      1 === t7.length && "false" !== t7[0].getAttribute("auto-submit") && t7[0].click();
    }
  };
}, K.sdkConfigOverrides = { baseHeaders: { "x-descope-sdk-name": "web-component", "x-descope-sdk-version": "3.47.1" } };

// node_modules/@descope/web-component/dist/esm/descope-wc/DescopeWc.js
var Z;
var ee;
var te;
var ie;
var se;
var oe;
var ne;
var re;
var ae;
var le;
var de;
var ce;
var he;
var pe;
var ue;
var ge;
var ve;
var me;
var fe;
var be2;
var we2;
var Se2;
var ye2;
var Ie3;
var Ce2;
var ke2;
var Re2;
var We;
var Oe2;
var Ee2;
var xe2;
var Ae2;
var je2;
var Te2;
var Le;
var Ue2 = class extends K {
  static set sdkConfigOverrides(e6) {
    K.sdkConfigOverrides = e6;
  }
  static get sdkConfigOverrides() {
    return K.sdkConfigOverrides;
  }
  constructor() {
    const s3 = new c2({ deferredRedirect: false });
    super(s3.update.bind(s3)), Z.add(this), this.stepState = new c2({}), ee.set(this, void 0), te.set(this, null), ie.set(this, null), se.set(this, { visibilitychange: __classPrivateFieldGet(this, Z, "m", oe).bind(this) }), this.bridgeVersion = 2, this.nativeCallbacks = {}, pe.set(this, false), this.handleRedirect = (e6) => {
      window.location.assign(e6);
    }, ge.set(this, (t6) => {
      const i2 = () => {
        this.contentRootElement.classList.toggle("hidden", t6), this.slotElement.classList.toggle("hidden", !t6), t6 && (this.contentRootElement.innerHTML = "");
      };
      t6 && this.contentRootElement.hasChildNodes() ? __classPrivateFieldGet(this, Z, "m", ve).call(this, i2) : i2();
    }), me.set(this, (s4, o4, n8, l3, d2 = false) => {
      const c3 = [n, a];
      if (this.flowState.current.action === L.poll) {
        this.logger.debug("polling - Scheduling polling request");
        const r3 = Date.now(), h3 = d2 ? 500 : 2e3;
        __classPrivateFieldSet(this, ee, setTimeout(() => __awaiter(this, void 0, void 0, function* () {
          var t6, i2;
          this.logger.debug("polling - Calling next");
          const p2 = this.sdk.flow.next(s4, o4, w.polling, n8, l3, {}), u2 = document.hidden && !d2 && Date.now() - r3 > h3 + 500;
          let g;
          u2 && this.logger.debug("polling - The polling seems to be throttled");
          try {
            const e6 = u2 ? 1e3 : 6e3;
            g = yield Ce(e6, p2);
          } catch (t7) {
            return this.logger.warn(`polling - The ${u2 ? "throttled fetch" : "fetch"} call timed out or was aborted`), void __classPrivateFieldGet(this, me, "f").call(this, s4, o4, n8, l3, u2);
          }
          if ((null === (t6 = null == g ? void 0 : g.error) || void 0 === t6 ? void 0 : t6.errorCode) === o) return this.logger.debug("polling - Got a generic error due to exception in fetch call"), void __classPrivateFieldGet(this, me, "f").call(this, s4, o4, n8, l3);
          this.logger.debug("polling - Got a response"), (null == g ? void 0 : g.error) && this.logger.debug("polling - Response has an error", JSON.stringify(g.error, null, 4)), (null === (i2 = null == g ? void 0 : g.error) || void 0 === i2 ? void 0 : i2.errorCode) && c3.includes(g.error.errorCode) ? this.logger.debug("polling - Stopping polling due to error") : __classPrivateFieldGet(this, me, "f").call(this, s4, o4, n8, l3), __classPrivateFieldGet(this, be2, "f").call(this, g);
        }), h3), "f");
      }
    }), fe.set(this, () => {
      clearTimeout(__classPrivateFieldGet(this, ee, "f")), __classPrivateFieldSet(this, ee, null, "f");
    }), be2.set(this, (i2) => {
      var s4, o4, n8, a4, l3, d2, c3, h3, p2, u2, g, v2, m2;
      if (!(null == i2 ? void 0 : i2.ok)) {
        const t6 = null === (s4 = null == i2 ? void 0 : i2.response) || void 0 === s4 ? void 0 : s4.url, r3 = `${null === (o4 = null == i2 ? void 0 : i2.response) || void 0 === o4 ? void 0 : o4.status} - ${null === (n8 = null == i2 ? void 0 : i2.response) || void 0 === n8 ? void 0 : n8.statusText}`;
        __classPrivateFieldGet(this, Z, "m", Le).call(this, "error", (null == i2 ? void 0 : i2.error) || { errorCode: t, errorDescription: r3, errorMessage: t6 }), this.loggerWrapper.error((null === (a4 = null == i2 ? void 0 : i2.error) || void 0 === a4 ? void 0 : a4.errorDescription) || t6, (null === (l3 = null == i2 ? void 0 : i2.error) || void 0 === l3 ? void 0 : l3.errorMessage) || r3);
        const c4 = null === (d2 = null == i2 ? void 0 : i2.error) || void 0 === d2 ? void 0 : d2.errorCode;
        return void (c4 !== E && c4 !== n || !this.isRestartOnError || __classPrivateFieldGet(this, Z, "m", he).call(this));
      }
      null === (h3 = null === (c3 = i2.data) || void 0 === c3 ? void 0 : c3.runnerLogs) || void 0 === h3 || h3.forEach((e6) => {
        const { level: t6, title: i3, log: s5 } = e6;
        t6 && this.loggerWrapper[t6] ? this.loggerWrapper[t6](i3, s5) : this.loggerWrapper.info(i3, s5);
      });
      const f3 = null === (g = null === (u2 = null === (p2 = i2.data) || void 0 === p2 ? void 0 : p2.screen) || void 0 === u2 ? void 0 : u2.state) || void 0 === g ? void 0 : g.errorText;
      (null === (v2 = i2.data) || void 0 === v2 ? void 0 : v2.error) ? this.loggerWrapper.error(`[${i2.data.error.code}]: ${i2.data.error.description}`, `${f3 ? `${f3} - ` : ""}${i2.data.error.message}`) : f3 && this.loggerWrapper.error(f3);
      const { status: b2, authInfo: w2, lastAuth: S2, action: y4, openInNewTabUrl: I2 } = i2.data;
      if (y4 !== L.poll && __classPrivateFieldGet(this, fe, "f").call(this), "completed" === b2) return this.storeLastAuthenticatedUser && e4(S2), void __classPrivateFieldGet(this, Z, "m", Le).call(this, "success", w2);
      this.storeLastAuthenticatedUser && e4(S2, true), I2 && window.open(I2, "_blank");
      const { executionId: C, stepId: k2, stepName: R3, screen: W2, redirect: O3, webauthn: E3, error: x2, samlIdpResponse: A3, nativeResponse: j3 } = i2.data, T3 = Date.now();
      y4 !== L.poll ? (this.loggerWrapper.info(`Step "${R3 || `#${k2}`}" is ${b2}`, "", { screen: W2, status: b2, stepId: k2, stepName: R3, action: y4, error: x2 }), (null === (m2 = W2.state) || void 0 === m2 ? void 0 : m2.clientScripts) && __classPrivateFieldSet(this, ie, this.loadSdkScripts(W2.state.clientScripts), "f"), this.flowState.update({ stepId: k2, stepName: R3, executionId: C, action: y4, redirectTo: null == O3 ? void 0 : O3.url, redirectIsPopup: null == O3 ? void 0 : O3.isPopup, screenId: null == W2 ? void 0 : W2.id, screenState: null == W2 ? void 0 : W2.state, webauthnTransactionId: null == E3 ? void 0 : E3.transactionId, webauthnOptions: null == E3 ? void 0 : E3.options, samlIdpResponseUrl: null == A3 ? void 0 : A3.url, samlIdpResponseSamlResponse: null == A3 ? void 0 : A3.samlResponse, samlIdpResponseRelayState: null == A3 ? void 0 : A3.relayState, nativeResponseType: null == j3 ? void 0 : j3.type, nativePayload: null == j3 ? void 0 : j3.payload, reqTimestamp: T3 })) : this.flowState.update({ action: y4, reqTimestamp: T3 });
    }), we2.set(this, Se(() => __awaiter(this, void 0, void 0, function* () {
      var e6;
      try {
        const t6 = yield this.sdk.webauthn.signIn.start("", window.location.origin);
        return t6.ok || this.loggerWrapper.warn("Webauthn start failed", null === (e6 = null == t6 ? void 0 : t6.error) || void 0 === e6 ? void 0 : e6.errorMessage), t6.data;
      } catch (e7) {
        this.loggerWrapper.warn("Webauthn start failed", e7.message);
      }
    }))), Re2.set(this, null), Ae2.set(this, xe((t6, s4) => __awaiter(this, void 0, void 0, function* () {
      var i2;
      if ("true" === t6.getAttribute("formnovalidate") || __classPrivateFieldGet(this, Z, "m", Ce2).call(this)) {
        const o4 = null == t6 ? void 0 : t6.getAttribute("id");
        __classPrivateFieldGet(this, Z, "m", We).call(this, t6);
        const n8 = yield __classPrivateFieldGet(this, Z, "m", ke2).call(this), r3 = Ae(t6);
        if (this.nextRequestStatus.update({ isLoading: true }), __classPrivateFieldGet(this, ie, "f")) {
          this.loggerWrapper.debug("Waiting for sdk scripts to load");
          const t7 = Date.now();
          yield __classPrivateFieldGet(this, ie, "f"), this.loggerWrapper.debug("Sdk scripts loaded for", (Date.now() - t7).toString());
        }
        const a4 = this.loadSdkScriptsModules();
        if (a4.length > 0) {
          const e6 = a4.filter((e7) => "function" == typeof e7.refresh).map((e7) => e7.refresh());
          e6.length > 0 && (yield Ce(y, Promise.all(e6), null));
        }
        const l3 = this.getComponentsContext(), d2 = Object.assign(Object.assign(Object.assign(Object.assign({}, l3), r3), n8), { origin: (null === (i2 = this.nativeOptions) || void 0 === i2 ? void 0 : i2.origin) || window.location.origin });
        yield s4(o4, d2), this.nextRequestStatus.update({ isLoading: false }), __classPrivateFieldGet(this, Z, "m", Oe2).call(this, n8);
      }
    }))), this.flowState = s3;
  }
  nativeResume(t6, i2) {
    var s3, o4, n8, r3, a4;
    const h3 = JSON.parse(i2);
    if ("oauthWeb" === t6 || "sso" === t6) {
      let { exchangeCode: e6 } = h3;
      if (!e6) {
        e6 = null === (s3 = new URL(h3.url).searchParams) || void 0 === s3 ? void 0 : s3.get(a2);
      }
      null === (n8 = (o4 = this.nativeCallbacks).complete) || void 0 === n8 || n8.call(o4, { exchangeCode: e6, idpInitiated: true });
    } else if ("magicLink" === t6) {
      const t7 = new URL(h3.url), i3 = t7.searchParams.get(t2), s4 = t7.searchParams.get(e2).split("_").pop();
      __classPrivateFieldGet(this, fe, "f").call(this), this.flowState.update({ token: i3, stepId: s4, action: void 0 });
    } else if ("beforeScreen" === t6) {
      const { screenResolve: e6 } = this.nativeCallbacks;
      this.nativeCallbacks.screenResolve = null;
      const { override: t7 } = h3;
      t7 || (this.nativeCallbacks.screenNext = null), null == e6 || e6(t7);
    } else if ("resumeScreen" === t6) {
      const { interactionId: e6, form: t7 } = h3, { screenNext: i3 } = this.nativeCallbacks;
      this.nativeCallbacks.screenNext = null, null == i3 || i3(e6, t7);
    } else null === (a4 = (r3 = this.nativeCallbacks).complete) || void 0 === a4 || a4.call(r3, h3);
  }
  loadSdkScriptsModules() {
    const e6 = this.shadowRoot.querySelectorAll("div[data-script-id]");
    return Array.from(e6).map((e7) => e7.moduleRes).filter((e7) => !!e7);
  }
  loadSdkScripts(e6) {
    if (!(null == e6 ? void 0 : e6.length)) return null;
    const t6 = (e7, t7) => (i2) => {
      this.dispatchEvent(new CustomEvent("components-context", { detail: { [Fe(e7.id, e7.resultKey)]: i2 }, bubbles: true, composed: true })), t7(e7.id);
    };
    this.loggerWrapper.debug(`Preparing to load scripts: ${e6.map((e7) => e7.id).join(", ")}`);
    const s3 = Promise.all(null == e6 ? void 0 : e6.map((e7) => __awaiter(this, void 0, void 0, function* () {
      var i2, s4;
      const o5 = this.shadowRoot.querySelector(`[data-script-id="${e7.id}"]`);
      if (o5) {
        this.loggerWrapper.debug("Script already loaded", e7.id);
        const { moduleRes: t7 } = o5;
        return null === (i2 = null == t7 ? void 0 : t7.start) || void 0 === i2 || i2.call(t7), t7;
      }
      yield this.injectNpmLib("@descope/flow-scripts", "1.0.11", `dist/${e7.id}.js`);
      const n8 = null === (s4 = globalThis.descope) || void 0 === s4 ? void 0 : s4[e7.id];
      return new Promise((i3, s5) => {
        try {
          const s6 = n8(e7.initArgs, { baseUrl: this.baseUrl, ref: this }, t6(e7, i3));
          if (s6) {
            const t7 = document.createElement("div");
            t7.setAttribute("data-script-id", e7.id), t7.moduleRes = s6, this.shadowRoot.appendChild(t7), this.nextRequestStatus.subscribe(() => {
              var t8;
              this.loggerWrapper.debug("Unloading script", e7.id), null === (t8 = s6.stop) || void 0 === t8 || t8.call(s6);
            });
          }
        } catch (e8) {
          s5(e8);
        }
      });
    }))), o4 = new Promise((e7) => {
      setTimeout(() => {
        this.loggerWrapper.warn("SDK scripts loading timeout"), e7(true);
      }, y);
    });
    return Promise.race([s3, o4]);
  }
  get isDismissScreenErrorOnInput() {
    return "true" === this.getAttribute("dismiss-screen-error-on-input");
  }
  init() {
    if (!window.descopeBridge) return this._init();
    this.lazyInit = this._init;
  }
  _init() {
    const t6 = Object.create(null, { init: { get: () => super.init } });
    return __awaiter(this, void 0, void 0, function* () {
      var i2, s3;
      this.shadowRoot.isConnected && (null === (i2 = this.flowState) || void 0 === i2 || i2.subscribe(this.onFlowChange.bind(this)), __classPrivateFieldGet(this, Z, "m", de).call(this), window.addEventListener("visibilitychange", __classPrivateFieldGet(this, se, "f").visibilitychange)), yield null === (s3 = t6.init) || void 0 === s3 ? void 0 : s3.call(this);
    });
  }
  disconnectedCallback() {
    var i2;
    super.disconnectedCallback(), this.flowState.unsubscribeAll(), this.stepState.unsubscribeAll(), null === (i2 = __classPrivateFieldGet(this, te, "f")) || void 0 === i2 || i2.abort(), __classPrivateFieldSet(this, te, null, "f"), window.removeEventListener("visibilitychange", __classPrivateFieldGet(this, se, "f").visibilitychange);
  }
  getHtmlFilenameWithLocale(e6, t6) {
    return __awaiter(this, void 0, void 0, function* () {
      let i2;
      const s3 = Te(e6), o4 = yield this.getTargetLocales();
      return o4.includes(s3.locale) ? i2 = `${t6}-${s3.locale}.html` : o4.includes(s3.fallback) && (i2 = `${t6}-${s3.fallback}.html`), i2;
    });
  }
  getPageContent(e6, t6) {
    return __awaiter(this, void 0, void 0, function* () {
      if (t6) try {
        const { body: e7 } = yield this.fetchStaticResource(t6, "text");
        return e7;
      } catch (i2) {
        this.loggerWrapper.error(`Failed to fetch flow page from ${t6}. Fallback to url ${e6}`, i2);
      }
      try {
        const { body: t7 } = yield this.fetchStaticResource(e6, "text");
        return t7;
      } catch (e7) {
        this.loggerWrapper.error("Failed to fetch flow page", e7.message);
      }
      return null;
    });
  }
  onFlowChange(l3, d2, c3) {
    return __awaiter(this, void 0, void 0, function* () {
      var h3, p2;
      const { projectId: u2, flowId: g, tenant: v2, stepId: m2, executionId: f3, action: C, screenId: k2, screenState: R3, redirectTo: W2, redirectIsPopup: x2, redirectUrl: A3, token: j3, code: T3, isPopup: L3, exchangeError: U2, webauthnTransactionId: P3, webauthnOptions: N4, redirectAuthCodeChallenge: $2, redirectAuthCallbackUrl: q2, redirectAuthBackupCallbackUri: M2, redirectAuthInitiator: F3, locale: V2, samlIdpResponseUrl: H2, samlIdpResponseSamlResponse: _, samlIdpResponseRelayState: G, nativeResponseType: z, nativePayload: Q, reqTimestamp: X } = l3, Y = __rest(l3, ["projectId", "flowId", "tenant", "stepId", "executionId", "action", "screenId", "screenState", "redirectTo", "redirectIsPopup", "redirectUrl", "token", "code", "isPopup", "exchangeError", "webauthnTransactionId", "webauthnOptions", "redirectAuthCodeChallenge", "redirectAuthCallbackUrl", "redirectAuthBackupCallbackUri", "redirectAuthInitiator", "locale", "samlIdpResponseUrl", "samlIdpResponseSamlResponse", "samlIdpResponseRelayState", "nativeResponseType", "nativePayload", "reqTimestamp"]);
      let ee2, se2, oe2;
      const ne2 = o2(), { outboundAppId: re2 } = this, { outboundAppScopes: le2 } = this, de2 = this.sdk.getLastUserLoginId(), ce2 = yield this.getFlowConfig(), he2 = yield this.getProjectConfig(), pe2 = Object.entries(he2.flows || {}).reduce((e6, [t6, i2]) => (e6[t6] = i2.version, e6), {}), ge2 = q2 && $2 ? { callbackUrl: q2, codeChallenge: $2, backupCallbackUri: M2 } : void 0, ve2 = this.nativeOptions ? { platform: this.nativeOptions.platform, bridgeVersion: this.nativeOptions.bridgeVersion, oauthProvider: this.nativeOptions.oauthProvider, oauthRedirect: this.nativeOptions.oauthRedirect, magicLinkRedirect: this.nativeOptions.magicLinkRedirect, ssoRedirect: this.nativeOptions.ssoRedirect } : void 0;
      let fe2 = {};
      if (!f3) {
        const i2 = [...ce2.clientScripts || [], ...ce2.sdkScripts || []];
        if (ce2.conditions) {
          let e6 = [];
          ({ startScreenId: ee2, conditionInteractionId: oe2, startScreenName: se2, clientScripts: e6, componentsConfig: fe2 } = t4({ loginId: de2, code: T3, token: j3, abTestingKey: ne2, lastAuth: n7(de2) }, ce2.conditions)), i2.push(...e6 || []);
        } else ce2.condition ? { startScreenId: ee2, conditionInteractionId: oe2 } = n6(ce2.condition, { loginId: de2, code: T3, token: j3, abTestingKey: ne2, lastAuth: n7(de2) }) : (se2 = ce2.startScreenName, ee2 = ce2.startScreenId);
        if (__classPrivateFieldSet(this, ie, this.loadSdkScripts(i2), "f"), ce2.fingerprintEnabled && ce2.fingerprintKey ? yield N(ce2.fingerprintKey, this.baseUrl) : P(), !ke(ee2, Y)) {
          const t6 = yield this.sdk.flow.start(g, Object.assign(Object.assign(Object.assign(Object.assign({ tenant: v2, redirectAuth: ge2 }, Y), { client: this.client }), A3 && { redirectUrl: A3 }), { lastAuth: n7(de2), abTestingKey: ne2, locale: Te(V2).locale, nativeOptions: ve2, outboundAppId: re2, outboundAppScopes: le2 }), oe2, "", he2.componentsVersion, pe2, Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({}, this.formConfigValues), T3 ? { exchangeCode: T3, idpInitiated: true } : {}), Y.descopeIdpInitiated && { idpInitiated: true }), j3 ? { token: j3 } : {}), Y.oidcLoginHint ? { externalId: Y.oidcLoginHint } : {}));
          return __classPrivateFieldGet(this, be2, "f").call(this, t6), void ("completed" !== (null === (h3 = null == t6 ? void 0 : t6.data) || void 0 === h3 ? void 0 : h3.status) && this.flowState.update({ code: void 0, token: void 0 }));
        }
      }
      if (this.loggerWrapper.debug("Before popup postmessage send", JSON.stringify({ isPopup: L3, code: T3, exchangeError: U2, isCodeChanged: c3("code"), isExchangeErrorChanged: c3("exchangeError") })), L3 && (c3("code") && T3 || c3("exchangeError") && U2)) {
        this.loggerWrapper.debug("Creating popup channel", f3);
        const e6 = new BroadcastChannel(f3);
        return this.loggerWrapper.debug("Posting message to popup channel", JSON.stringify({ code: T3, exchangeError: U2 })), e6.postMessage({ data: { code: T3, exchangeError: U2 }, action: "code" }), this.loggerWrapper.debug("Popup channel message posted, closing channel"), e6.close(), this.loggerWrapper.debug("Popup channel closed, closing window"), void window.close();
      }
      if (f3 && (c3("token") && j3 || c3("code") && T3 || c3("exchangeError") && U2)) {
        const t6 = yield this.sdk.flow.next(f3, m2, w.submit, ce2.version, he2.componentsVersion, { token: j3, exchangeCode: T3, exchangeError: U2 });
        return __classPrivateFieldGet(this, be2, "f").call(this, t6), void this.flowState.update({ token: void 0, code: void 0, exchangeError: void 0 });
      }
      if (C === L.loadForm && ["samlIdpResponseUrl", "samlIdpResponseSamlResponse", "samlIdpResponseRelayState"].some((e6) => c3(e6))) {
        if (!H2 || !_) return void this.loggerWrapper.error("Did not get saml idp params data to load");
        Ee(H2, _, G || "", Pe);
      }
      if (C === L.redirect && (c3("redirectTo") || c3("deferredRedirect"))) {
        if (!W2) return void this.loggerWrapper.error("Did not get redirect url");
        if ("android" === F3 && document.hidden) return void this.flowState.update({ deferredRedirect: true });
        if (this.loggerWrapper.debug(`Redirect is popup ${x2}`), x2) {
          this.loggerWrapper.debug("Opening redirect in popup");
          const t6 = Ne(W2, "?", 598, 700);
          this.loggerWrapper.debug("Creating broadcast channel");
          const i2 = new BroadcastChannel(f3);
          this.loggerWrapper.debug("Starting popup closed detection");
          const s3 = setInterval(() => {
            t6.closed && (this.loggerWrapper.debug("Popup closed, dispatching popupclosed event and clearing interval"), clearInterval(s3), __classPrivateFieldGet(this, Z, "m", Le).call(this, "popupclosed", {}), this.loggerWrapper.debug("Closing channel"), i2.close());
          }, 1e3);
          this.loggerWrapper.debug("Listening for postMessage on channel");
          const o4 = (e6) => {
            if (this.loggerWrapper.debug("Received postMessage on channel", JSON.stringify(e6)), this.loggerWrapper.debug("Comparing origins", JSON.stringify({ eventOrigin: e6.origin, windowLocationOrigin: window.location.origin })), e6.origin !== window.location.origin) return;
            this.loggerWrapper.debug("PostMessage origin matches, processing message");
            const { action: t7, data: i3 } = e6.data;
            this.loggerWrapper.debug(`PostMessage action: ${t7}, data: ${JSON.stringify(i3)}`), "code" === t7 && (this.loggerWrapper.debug("Updating flow state with code and exchangeError"), this.flowState.update({ code: i3.code, exchangeError: i3.exchangeError }));
          };
          i2.onmessage = o4;
        } else this.handleRedirect(W2);
        return;
      }
      if (C === L.webauthnCreate || C === L.webauthnGet) {
        if (!P3 || !N4) return void this.loggerWrapper.error("Did not get webauthn transaction id or options");
        let i2, s3;
        null === (p2 = __classPrivateFieldGet(this, te, "f")) || void 0 === p2 || p2.abort(), __classPrivateFieldSet(this, te, null, "f");
        try {
          i2 = C === L.webauthnCreate ? yield this.sdk.webauthn.helpers.create(N4) : yield this.sdk.webauthn.helpers.get(N4);
        } catch (e6) {
          "InvalidStateError" === e6.name ? this.loggerWrapper.warn("WebAuthn operation failed", e6.message) : "NotAllowedError" !== e6.name && this.loggerWrapper.error(e6.message), s3 = e6.name;
        }
        const o4 = yield this.sdk.flow.next(f3, m2, w.submit, ce2.version, he2.componentsVersion, { transactionId: P3, response: i2, failure: s3 });
        __classPrivateFieldGet(this, be2, "f").call(this, o4);
      }
      if (C === L.nativeBridge) return this.nativeCallbacks.complete = (t6) => __awaiter(this, void 0, void 0, function* () {
        const i2 = yield this.sdk.flow.next(f3, m2, w.submit, ce2.version, he2.componentsVersion, t6);
        __classPrivateFieldGet(this, be2, "f").call(this, i2);
      }), void __classPrivateFieldGet(this, Z, "m", ae).call(this, z, Q);
      if (c3("action") && __classPrivateFieldGet(this, me, "f").call(this, f3, m2, ce2.version, he2.componentsVersion), !k2 && !ee2) return void this.loggerWrapper.warn("No screen was found to show");
      const we3 = ee2 || k2, Se3 = yield this.getHtmlFilenameWithLocale(V2, we3), { oidcLoginHint: ye3, oidcPrompt: Ie4, oidcErrorRedirectUri: Ce3, oidcResource: ke3, samlIdpUsername: Re3 } = Y, We2 = { direction: R(m2, d2.stepId), screenState: Object.assign(Object.assign({}, R3), { form: Object.assign(Object.assign({}, this.formConfigValues), null == R3 ? void 0 : R3.form), lastAuth: { loginId: de2, name: this.sdk.getLastUserDisplayName() || de2 }, componentsConfig: Object.assign(Object.assign(Object.assign({}, ce2.componentsConfig), fe2), null == R3 ? void 0 : R3.componentsConfig) }), htmlFilename: `${we3}.html`, htmlLocaleFilename: Se3, screenId: we3, stepName: l3.stepName || se2, samlIdpUsername: Re3, oidcLoginHint: ye3, oidcPrompt: Ie4, oidcErrorRedirectUri: Ce3, oidcResource: ke3, action: C }, Oe3 = n7(de2);
      ke(ee2, Y) ? We2.next = (t6, s3) => __awaiter(this, void 0, void 0, function* () {
        const i2 = yield this.sdk.flow.start(g, Object.assign(Object.assign(Object.assign(Object.assign({ tenant: v2, redirectAuth: ge2 }, Y), { lastAuth: Oe3, preview: this.preview, abTestingKey: ne2, client: this.client }), A3 && { redirectUrl: A3 }), { locale: Te(V2).locale, nativeOptions: ve2, outboundAppId: re2, outboundAppScopes: le2 }), oe2, t6, he2.componentsVersion, pe2, Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({}, this.formConfigValues), Oe(s3)), T3 && { exchangeCode: T3, idpInitiated: true }), Y.descopeIdpInitiated && { idpInitiated: true }), j3 && { token: j3 }));
        return __classPrivateFieldGet(this, be2, "f").call(this, i2), i2;
      }) : (c3("projectId") || c3("baseUrl") || c3("executionId") || c3("stepId")) && (We2.next = (t6, s3) => __awaiter(this, void 0, void 0, function* () {
        const i2 = yield this.sdk.flow.next(f3, m2, t6, ce2.version, he2.componentsVersion, Oe(s3));
        return __classPrivateFieldGet(this, be2, "f").call(this, i2), i2;
      })), this.loggerWrapper.debug("Got a screen with id", We2.screenId), yield __classPrivateFieldGet(this, Z, "m", ue).call(this, We2), this.stepState.update(We2);
    });
  }
  onStepChange(t6, s3) {
    return __awaiter(this, void 0, void 0, function* () {
      var o4, n8;
      const { htmlFilename: r3, htmlLocaleFilename: l3, direction: d2, next: c3, screenState: h3 } = t6;
      this.loggerWrapper.debug("Rendering a flow screen");
      const p2 = document.createElement("template");
      p2.innerHTML = yield this.getPageContent(r3, l3);
      const g = p2.content.cloneNode(true), v2 = this.loadDescopeUiComponents(p2);
      this.sdk.webauthn.helpers.isSupported() ? yield __classPrivateFieldGet(this, Z, "m", ye2).call(this, g, c3) : A(g), !t6.samlIdpUsername || (null === (o4 = h3.form) || void 0 === o4 ? void 0 : o4.loginId) || (null === (n8 = h3.form) || void 0 === n8 ? void 0 : n8.email) || (h3.form || (h3.form = {}), h3.form.loginId = t6.samlIdpUsername, h3.form.email = t6.samlIdpUsername), m(g, h3, h3.componentsConfig, this.formConfig, this.loggerWrapper);
      const { geo: m2 } = yield this.getExecutionContext();
      b(g, m2);
      const f3 = () => __awaiter(this, void 0, void 0, function* () {
        var i2, o5;
        yield v2;
        const n9 = this.contentRootElement;
        v(n9, null === (i2 = null == h3 ? void 0 : h3.totp) || void 0 === i2 ? void 0 : i2.image), y2(n9, null === (o5 = null == h3 ? void 0 : h3.notp) || void 0 === o5 ? void 0 : o5.image), f2(n9, g, h3.cssVars, this.loggerWrapper), n9.replaceChildren(g);
        const r4 = !s3.htmlFilename;
        setTimeout(() => {
          __classPrivateFieldGet(this, Z, "m", Ee2).call(this), this.validateOnBlur && Ie2(n9), h2(n9, h3), __classPrivateFieldGet(this, Z, "m", Ie3).call(this, { isFirstScreen: r4, isCustomScreen: false, stepName: t6.stepName }), ye(n9, this.autoFocus, r4);
        }), __classPrivateFieldGet(this, Z, "m", Te2).call(this, c3);
        n9.querySelector(`[${T}="polling"]`) && c3(w.polling, {});
      });
      d2 ? __classPrivateFieldGet(this, Z, "m", ve).call(this, f3) : f3();
    });
  }
  getInputs() {
    return Array.from(this.shadowRoot.querySelectorAll(`*:not(slot)[name]:not([${l}])`));
  }
};
ee = /* @__PURE__ */ new WeakMap(), te = /* @__PURE__ */ new WeakMap(), ie = /* @__PURE__ */ new WeakMap(), se = /* @__PURE__ */ new WeakMap(), pe = /* @__PURE__ */ new WeakMap(), ge = /* @__PURE__ */ new WeakMap(), me = /* @__PURE__ */ new WeakMap(), fe = /* @__PURE__ */ new WeakMap(), be2 = /* @__PURE__ */ new WeakMap(), we2 = /* @__PURE__ */ new WeakMap(), Re2 = /* @__PURE__ */ new WeakMap(), Ae2 = /* @__PURE__ */ new WeakMap(), Z = /* @__PURE__ */ new WeakSet(), oe = function() {
  document.hidden || setTimeout(() => {
    this.flowState.update({ deferredRedirect: false });
  }, 300);
}, ne = function(t6, s3, o4) {
  return __awaiter(this, void 0, void 0, function* () {
    var i2;
    return (null === (i2 = this.nativeOptions) || void 0 === i2 ? void 0 : i2.bridgeVersion) >= 2 && new Promise((i3) => {
      this.nativeCallbacks.screenNext = o4, this.nativeCallbacks.screenResolve = i3, __classPrivateFieldGet(this, Z, "m", ae).call(this, "beforeScreen", { screen: t6, context: s3 });
    });
  });
}, re = function(t6) {
  var i2;
  (null === (i2 = this.nativeOptions) || void 0 === i2 ? void 0 : i2.bridgeVersion) >= 2 && __classPrivateFieldGet(this, Z, "m", ae).call(this, "afterScreen", { screen: t6 });
}, ae = function(t6, i2) {
  __classPrivateFieldGet(this, Z, "m", Le).call(this, "bridge", { type: t6, payload: i2 });
}, le = function({ errorText: e6, errorType: t6 }) {
  const i2 = () => {
    var i3;
    let s3 = e6;
    try {
      s3 = (null === (i3 = this.errorTransformer) || void 0 === i3 ? void 0 : i3.call(this, { text: e6, type: t6 })) || e6;
    } catch (e7) {
      this.loggerWrapper.error("Error transforming error message", e7.message);
    }
    l2(this.contentRootElement, "error-message", s3);
  };
  this.addEventListener("screen-updated", i2, { once: true }), i2();
}, de = function() {
  var t6, i2, o4;
  null === (t6 = this.stepState) || void 0 === t6 || t6.subscribe(this.onStepChange.bind(this), (e6) => {
    var t7 = e6.screenState, i3 = __rest(void 0 === t7 ? {} : t7, ["errorText", "errorType"]), o5 = __rest(e6, ["screenState"]);
    return Object.assign(Object.assign({}, o5), { screenState: i3 });
  }), null === (i2 = this.stepState) || void 0 === i2 || i2.subscribe(__classPrivateFieldGet(this, Z, "m", le).bind(this), (e6) => {
    var t7, i3;
    return { errorText: null === (t7 = null == e6 ? void 0 : e6.screenState) || void 0 === t7 ? void 0 : t7.errorText, errorType: null === (i3 = null == e6 ? void 0 : e6.screenState) || void 0 === i3 ? void 0 : i3.errorType };
  }, { forceUpdate: true }), null === (o4 = this.stepState) || void 0 === o4 || o4.subscribe(__classPrivateFieldGet(this, Z, "m", ce).bind(this), (e6) => {
    var t7, i3;
    return { errorText: null === (t7 = null == e6 ? void 0 : e6.screenState) || void 0 === t7 ? void 0 : t7.errorText, errorType: null === (i3 = null == e6 ? void 0 : e6.screenState) || void 0 === i3 ? void 0 : i3.errorType };
  }, { forceUpdate: true });
}, ce = function({ errorText: e6, errorType: t6 }) {
  (t6 || e6) && (this.contentRootElement.querySelectorAll('descope-passcode[data-auto-submit="true"]').forEach((e7) => {
    e7.shadowRoot.querySelectorAll("descope-text-field[data-id]").forEach((e8) => {
      e8.value = "";
    });
  }), ye(this.contentRootElement, this.autoFocus, false));
}, he = function() {
  return __awaiter(this, void 0, void 0, function* () {
    this.loggerWrapper.debug("Trying to restart the flow");
    const e6 = yield this.getComponentsVersion();
    this.reset();
    e6 === (yield this.getComponentsVersion()) ? (this.loggerWrapper.debug("Components version was not changed, restarting flow"), this.flowState.update({ stepId: null, executionId: null })) : this.loggerWrapper.error("Components version mismatch, please reload the page");
  });
}, ue = function(o4) {
  return __awaiter(this, void 0, void 0, function* () {
    var i2;
    const n8 = Object.assign(Object.assign({}, this.stepState.current), o4), { next: r3, stepName: a4 } = n8, l3 = __rest(n8, ["next", "stepName"]), d2 = Re(l3);
    let c3 = yield __classPrivateFieldGet(this, Z, "m", ne).call(this, a4, d2, r3);
    c3 || (c3 = Boolean(yield null === (i2 = this.onScreenUpdate) || void 0 === i2 ? void 0 : i2.call(this, a4, d2, r3, this)));
    const h3 = !this.stepState.current.htmlFilename;
    if (__classPrivateFieldGet(this, ge, "f").call(this, c3), __classPrivateFieldGet(this, pe, "f") !== c3) {
      const [i3, s3] = ["flow", "custom"].sort(() => c3 ? -1 : 1);
      this.loggerWrapper.debug(`Switching from ${s3} screen to ${i3} screen`), __classPrivateFieldSet(this, pe, c3, "f"), c3 ? this.stepState.unsubscribeAll() : __classPrivateFieldGet(this, Z, "m", de).call(this);
    }
    c3 && (this.loggerWrapper.debug("Showing a custom screen"), __classPrivateFieldGet(this, Z, "m", Ie3).call(this, { isFirstScreen: h3, isCustomScreen: c3, stepName: o4.stepName })), this.stepState.forceUpdate = c3;
  });
}, ve = function(e6) {
  this.contentRootElement.addEventListener("transitionend", () => {
    this.loggerWrapper.debug("page switch transition end"), this.contentRootElement.classList.remove("fade-out"), e6();
  }, { once: true }), this.loggerWrapper.debug("page switch transition start"), this.contentRootElement.classList.add("fade-out");
}, Se2 = function(e6) {
  const t6 = e6.getAttribute("name");
  if (!["email"].includes(t6)) {
    const i2 = `user-${t6}`;
    e6.setAttribute("name", i2), e6.addEventListener("input", () => {
      e6.setAttribute("name", e6.value ? t6 : i2);
    });
  }
}, ye2 = function(s3, o4) {
  return __awaiter(this, void 0, void 0, function* () {
    var n8;
    null === (n8 = __classPrivateFieldGet(this, te, "f")) || void 0 === n8 || n8.abort();
    const r3 = s3.querySelector('*[autocomplete="webauthn"]');
    if (r3 && (yield n4())) {
      const { options: s4, transactionId: n9 } = (yield __classPrivateFieldGet(this, we2, "f").call(this)) || {};
      s4 && n9 && (__classPrivateFieldGet(this, Z, "m", Se2).call(this, r3), __classPrivateFieldSet(this, te, new AbortController(), "f"), this.sdk.webauthn.helpers.conditional(s4, __classPrivateFieldGet(this, te, "f")).then((e6) => __awaiter(this, void 0, void 0, function* () {
        o4(r3.id, { transactionId: n9, response: e6 });
      })).catch((e6) => {
        "AbortError" !== e6.name && this.loggerWrapper.error("Conditional login failed", e6.message);
      }));
    }
  });
}, Ie3 = function({ isFirstScreen: t6, isCustomScreen: i2, stepName: s3 }) {
  t6 && __classPrivateFieldGet(this, Z, "m", Le).call(this, "ready", {}), i2 || __classPrivateFieldGet(this, Z, "m", re).call(this, s3), __classPrivateFieldGet(this, Z, "m", Le).call(this, "page-updated", { screenName: s3 }), __classPrivateFieldGet(this, Z, "m", Le).call(this, "screen-updated", { screenName: s3 });
}, Ce2 = function() {
  let e6 = true;
  return Array.from(this.shadowRoot.querySelectorAll("*[name]")).reverse().forEach((t6) => {
    var i2, s3;
    "slot" !== t6.localName && (null === (i2 = t6.reportValidity) || void 0 === i2 || i2.call(t6), e6 && (e6 = null === (s3 = t6.checkValidity) || void 0 === s3 ? void 0 : s3.call(t6)));
  }), e6;
}, ke2 = function() {
  return __awaiter(this, void 0, void 0, function* () {
    const e6 = this.getInputs();
    return (yield Promise.all(e6.map((e7) => __awaiter(this, void 0, void 0, function* () {
      return { name: e7.getAttribute("name"), value: e7.value };
    })))).reduce((e7, t6) => Object.assign(Object.assign({}, e7), { [t6.name]: t6.value }), {});
  });
}, We = function(s3) {
  const o4 = Array.from(this.contentRootElement.querySelectorAll(':not([disabled]), [disabled="false"]')).filter((e6) => e6 !== s3), n8 = () => __awaiter(this, void 0, void 0, function* () {
    this.loggerWrapper.debug("Restoring components state"), this.removeEventListener("popupclosed", n8), s3.removeAttribute("loading"), o4.forEach((e7) => {
      e7.removeAttribute("disabled");
    });
    const e6 = yield this.getFlowConfig(), t6 = [...e6.clientScripts || [], ...e6.sdkScripts || []];
    this.loadSdkScripts(t6);
  }), r3 = () => {
    var i2;
    window.removeEventListener("pageshow", __classPrivateFieldGet(this, Re2, "f")), __classPrivateFieldSet(this, Re2, (e6) => {
      e6.persisted && (this.logger.debug("Page was loaded from cache, restoring components state"), n8());
    }, "f"), window.addEventListener("pageshow", __classPrivateFieldGet(this, Re2, "f"), { once: true });
    const s4 = null === (i2 = this.stepState) || void 0 === i2 ? void 0 : i2.subscribe((e6, t6) => {
      e6 === t6 && n8(), this.removeEventListener("popupclosed", n8), this.stepState.unsubscribe(s4);
    }, (e6) => e6.screenId, { forceUpdate: true });
  }, a4 = this.nextRequestStatus.subscribe(({ isLoading: e6 }) => {
    e6 ? (this.addEventListener("popupclosed", n8, { once: true }), s3.setAttribute("loading", "true"), o4.forEach((e7) => e7.setAttribute("disabled", "true"))) : (this.nextRequestStatus.unsubscribe(a4), r3());
  });
}, Oe2 = function(e6 = {}) {
  var t6, i2;
  const s3 = Ue(e6, ["externalId", "email", "phone"]), o4 = Ue(e6, ["newPassword", "password"]);
  if (s3 && o4) try {
    if (!globalThis.PasswordCredential) return;
    const e7 = new globalThis.PasswordCredential({ id: s3, password: o4 });
    null === (i2 = null === (t6 = null === navigator || void 0 === navigator ? void 0 : navigator.credentials) || void 0 === t6 ? void 0 : t6.store) || void 0 === i2 || i2.call(t6, e7);
  } catch (e7) {
    this.loggerWrapper.error("Could not store credentials", e7.message);
  }
}, Ee2 = function() {
  $e();
  this.contentRootElement.querySelectorAll('[external-input="true"]').forEach((t6) => __classPrivateFieldGet(this, Z, "m", xe2).call(this, t6));
}, xe2 = function(e6) {
  if (!e6) return;
  e6.querySelectorAll("input").forEach((t6) => {
    const i2 = t6.getAttribute("slot"), s3 = `input-${e6.id}-${i2}`, o4 = document.createElement("slot");
    o4.setAttribute("name", s3), o4.setAttribute("slot", i2), e6.appendChild(o4), t6.setAttribute("slot", s3), this.appendChild(t6);
  });
}, je2 = function(t6) {
  this.contentRootElement.querySelectorAll('descope-passcode[data-auto-submit="true"]').forEach((i2) => {
    i2.addEventListener("input", () => {
      var s3;
      (null === (s3 = i2.checkValidity) || void 0 === s3 ? void 0 : s3.call(i2)) && __classPrivateFieldGet(this, Ae2, "f").call(this, i2, t6);
    });
  });
}, Te2 = function(t6) {
  this.contentRootElement.querySelectorAll(`descope-button:not([${s2}]), [data-type="button"]:not([${s2}]`).forEach((i2) => {
    i2.onclick = () => {
      __classPrivateFieldGet(this, Ae2, "f").call(this, i2, t6);
    };
  }), __classPrivateFieldGet(this, Z, "m", je2).call(this, t6), this.isDismissScreenErrorOnInput && this.contentRootElement.querySelectorAll(`*[name]:not([${l}])`).forEach((e6) => {
    e6.addEventListener("input", () => {
      this.stepState.update((e7) => Object.assign(Object.assign({}, e7), { screenState: Object.assign(Object.assign({}, e7.screenState), { errorText: "", errorType: "" }) }));
    });
  });
}, Le = function(e6, t6) {
  this.dispatchEvent(new CustomEvent(e6, { detail: t6 }));
};

// node_modules/@descope/web-component/dist/esm/descope-wc/index.js
customElements.get("descope-wc") ? console.log("descope-wc is already defined") : customElements.define("descope-wc", Ue2);

export {
  Ue2 as Ue
};
//# sourceMappingURL=chunk-GQLGK6ZR.js.map
