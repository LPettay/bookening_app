!function(){"use strict";var e=function(){return e=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},e.apply(this,arguments)};function t(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]])}return n}function n(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{l(o.next(e))}catch(e){r(e)}}function a(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))}function o(e,t,n,o){if("a"===n&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?o:"a"===n?o.call(e):o?o.value:t.get(e)}function i(e,t,n,o,i){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?i.call(e,n):i?i.value=n:t.set(e,n),n}"function"==typeof SuppressedError&&SuppressedError;class r extends Error{}function s(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return function(e){return decodeURIComponent(atob(e).replace(/(.)/g,((e,t)=>{let n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n})))}(t)}catch(e){return atob(t)}}function a(e,t){if("string"!=typeof e)throw new r("Invalid token specified: must be a string");t||(t={});const n=!0===t.header?0:1,o=e.split(".")[n];if("string"!=typeof o)throw new r(`Invalid token specified: missing part #${n+1}`);let i;try{i=s(o)}catch(e){throw new r(`Invalid token specified: invalid base64 for part #${n+1} (${e.message})`)}try{return JSON.parse(i)}catch(e){throw new r(`Invalid token specified: invalid json for part #${n+1} (${e.message})`)}}r.prototype.name="InvalidTokenError";var l={accessKey:{exchange:"/v1/auth/accesskey/exchange"},otp:{verify:"/v1/auth/otp/verify",signIn:"/v1/auth/otp/signin",signUp:"/v1/auth/otp/signup",update:{email:"/v1/auth/otp/update/email",phone:"/v1/auth/otp/update/phone"},signUpOrIn:"/v1/auth/otp/signup-in"},magicLink:{verify:"/v1/auth/magiclink/verify",signIn:"/v1/auth/magiclink/signin",signUp:"/v1/auth/magiclink/signup",update:{email:"/v1/auth/magiclink/update/email",phone:"/v1/auth/magiclink/update/phone"},signUpOrIn:"/v1/auth/magiclink/signup-in"},enchantedLink:{verify:"/v1/auth/enchantedlink/verify",signIn:"/v1/auth/enchantedlink/signin",signUp:"/v1/auth/enchantedlink/signup",session:"/v1/auth/enchantedlink/pending-session",update:{email:"/v1/auth/enchantedlink/update/email"},signUpOrIn:"/v1/auth/enchantedlink/signup-in"},oauth:{start:"/v1/auth/oauth/authorize",exchange:"/v1/auth/oauth/exchange",startNative:"v1/auth/oauth/native/start",finishNative:"v1/auth/oauth/native/finish",oneTap:{getOneTapClientId:"/v1/auth/onetap/clientid/{provider}",exchangeOneTapIDToken:"/v1/auth/onetap/idtoken/exchange",verifyOneTapIDToken:"/v1/auth/onetap/idtoken/verify"}},outbound:{connect:"/v1/outbound/oauth/connect"},saml:{start:"/v1/auth/saml/authorize",exchange:"/v1/auth/saml/exchange"},totp:{verify:"/v1/auth/totp/verify",signUp:"/v1/auth/totp/signup",update:"/v1/auth/totp/update"},notp:{signIn:"/v1/auth/notp/whatsapp/signin",signUp:"/v1/auth/notp/whatsapp/signup",signUpOrIn:"/v1/auth/notp/whatsapp/signup-in",session:"/v1/auth/notp/pending-session"},webauthn:{signUp:{start:"/v1/auth/webauthn/signup/start",finish:"/v1/auth/webauthn/signup/finish"},signIn:{start:"/v1/auth/webauthn/signin/start",finish:"/v1/auth/webauthn/signin/finish"},signUpOrIn:{start:"/v1/auth/webauthn/signup-in/start"},update:{start:"v1/auth/webauthn/update/start",finish:"/v1/auth/webauthn/update/finish"}},password:{signUp:"/v1/auth/password/signup",signIn:"/v1/auth/password/signin",sendReset:"/v1/auth/password/reset",update:"/v1/auth/password/update",replace:"/v1/auth/password/replace",policy:"/v1/auth/password/policy"},refresh:"/v1/auth/refresh",tryRefresh:"/v1/auth/try-refresh",selectTenant:"/v1/auth/tenant/select",logout:"/v1/auth/logout",logoutAll:"/v1/auth/logoutall",me:"/v1/auth/me",myTenants:"/v1/auth/me/tenants",history:"/v1/auth/me/history",flow:{start:"/v1/flow/start",next:"/v1/flow/next"}};const c="<region>",d=`https://api.${c}descope.com`,u=6e5,h="dct",p=()=>{const e={};return{headers(t){const n="function"==typeof t.entries?Object.fromEntries(t.entries()):t;return e.Headers=JSON.stringify(n),this},body(t){return e.Body=t,this},url(t){return e.Url=t.toString(),this},method(t){return e.Method=t,this},title(t){return e.Title=t,this},status(t){return e.Status=t,this},retries(t){return e.Retries=t,this},build:()=>Object.keys(e).flatMap((t=>e[t]?[`${"Title"!==t?`${t}: `:""}${e[t]}`]:[])).join("\n")}},g=[521,524],f=e=>async(...t)=>{let n=await e(...t);g.includes(n.status)&&(n=await e(...t),n.retries=1);const o=await n.text();return n.text=()=>Promise.resolve(o),n.json=()=>Promise.resolve(JSON.parse(o)),n.clone=()=>n,n};let v;const m=()=>{if(v)return v;const e=new Date,t=`${e.getUTCFullYear().toString()}-${(e.getUTCMonth()+1).toString().padStart(2,"0")}-${e.getUTCDate().toString().padStart(2,"0")}-${e.getUTCHours().toString().padStart(2,"0")}:${e.getUTCMinutes().toString().padStart(2,"0")}:${e.getUTCSeconds().toString().padStart(2,"0")}:${e.getUTCMilliseconds().toString()}`,n=Math.floor(1e3+9e3*Math.random());return v=`${t}-${n}`,v};var b;!function(e){e.get="GET",e.delete="DELETE",e.post="POST",e.put="PUT",e.patch="PATCH"}(b||(b={}));const w=({path:e,baseUrl:t,queryParams:n,projectId:o})=>{const i=o.slice(1,-27);t=t.replace(c,i?i+".":"");let r=e?`${t.replace(/\/$/,"")}/${null==e?void 0:e.replace(/^\//,"")}`:t;if(n){const e=Object.keys(n);e.forEach(((t,o)=>{r=`${r}${0===o?"?":""}${t}=${encodeURIComponent(n[t])}${o===e.length-1?"":"&"}`}))}return r},y=(...e)=>new Headers(e.reduce(((e,t)=>((e=>Array.isArray(e)?e:e instanceof Headers?Array.from(e.entries()):e?Object.entries(e):[])(t).forEach((([t,n])=>{e[t]="function"==typeof n?n():n})),e)),{})),k={"Content-Type":"application/json"},I=(e,t="")=>{let n=e;return t&&(n=n+":"+t),{Authorization:`Bearer ${n}`}},S=(e,t)=>{const n={"x-descope-sdk-session-id":m(),"x-descope-sdk-name":"core-js","x-descope-sdk-version":"2.49.0","x-descope-project-id":e};return t&&(n["x-descope-refresh-cookie-name"]=t),n},O=e=>{try{e=JSON.parse(e)}catch(e){return!1}return"object"==typeof e&&null!==e};var C=e=>{var t;return(({baseUrl:e,projectId:t,baseConfig:n,refreshCookieName:o,logger:i,hooks:r,cookiePolicy:s,fetch:a})=>{const l=e||d,c=((e,t)=>{const n=t||fetch;return n||null==e||e.warn("Fetch is not defined, you will not be able to send http requests, if you are running in a test, make sure fetch is defined globally"),e?async(...t)=>{if(!n)throw Error("Cannot send http request, fetch is not defined, if you are running in a test, make sure fetch is defined globally");e.log((e=>p().title("Request").url(e[0]).method(e[1].method).headers(e[1].headers).body(e[1].body).build())(t));const o=await f(n)(...t);return e[o.ok?"log":"error"](await(async e=>{const t=await e.text();return p().title("Response").url(e.url.toString()).status(`${e.status} ${e.statusText}`).headers(e.headers).body(t).retries(e.retries).build()})(o)),o}:f(n)})(i,a),u=async e=>{var i;const a=(null==r?void 0:r.beforeRequest)?r.beforeRequest(e):e,{path:d,body:u,headers:h,queryParams:p,method:g,token:f}=a,v=(e=>void 0===e?void 0:JSON.stringify(e))(u),m={headers:y(I(t,f),S(t,o),(null==n?void 0:n.baseHeaders)||{},O(v)?k:{},h),method:g,body:v};null!==s&&(m.credentials=s||"include");const b=await c(w({path:d,baseUrl:l,queryParams:p,projectId:t}),m);if((null==r?void 0:r.afterRequest)&&await r.afterRequest(e,null==b?void 0:b.clone()),null==r?void 0:r.transformResponse){const e=await b.json(),t=((null===(i=b.headers)||void 0===i?void 0:i.get("set-cookie"))||"").split(";").reduce(((e,t)=>{const[n,o]=t.split("=");return Object.assign(Object.assign({},e),{[n.trim()]:o})}),{}),n=Object.assign(Object.assign({},b),{json:()=>Promise.resolve(e),cookies:t});return n.clone=()=>n,r.transformResponse(n)}return b};return{get:(e,{headers:t,queryParams:n,token:o}={})=>u({path:e,headers:t,queryParams:n,body:void 0,method:b.get,token:o}),post:(e,t,{headers:n,queryParams:o,token:i}={})=>u({path:e,headers:n,queryParams:o,body:t,method:b.post,token:i}),patch:(e,t,{headers:n,queryParams:o,token:i}={})=>u({path:e,headers:n,queryParams:o,body:t,method:b.patch,token:i}),put:(e,t,{headers:n,queryParams:o,token:i}={})=>u({path:e,headers:n,queryParams:o,body:t,method:b.put,token:i}),delete:(e,{headers:t,queryParams:n,token:o}={})=>u({path:e,headers:t,queryParams:n,body:void 0,method:b.delete,token:o}),hooks:r,buildUrl:(e,n)=>w({projectId:t,baseUrl:l,path:e,queryParams:n})}})(Object.assign(Object.assign({},e),{hooks:{beforeRequest:t=>{var n;const o=[].concat((null===(n=e.hooks)||void 0===n?void 0:n.beforeRequest)||[]);return null==o?void 0:o.reduce(((e,t)=>t(e)),t)},afterRequest:async(t,n)=>{var o;const i=[].concat((null===(o=e.hooks)||void 0===o?void 0:o.afterRequest)||[]);0!=i.length&&(await Promise.allSettled(null==i?void 0:i.map((e=>e(t,null==n?void 0:n.clone()))))).forEach((t=>{var n;return"rejected"===t.status&&(null===(n=e.logger)||void 0===n?void 0:n.error(t.reason))}))},transformResponse:null===(t=e.hooks)||void 0===t?void 0:t.transformResponse}}))},x=429;function A(e,t,n){var o;let i=j(e);if(t){if(!(null==i?void 0:i.tenants)&&(null==i?void 0:i[h])===t)return(null==i?void 0:i[n])||[];i=null===(o=null==i?void 0:i.tenants)||void 0===o?void 0:o[t]}const r=null==i?void 0:i[n];return Array.isArray(r)?r:[]}function j(e){if("string"!=typeof e||!e)throw new Error("Invalid token provided");return a(e)}function E(e){const{exp:t}=j(e);return(new Date).getTime()/1e3>t}function U(e){let t=j(e);const n=Object.keys(null==t?void 0:t.tenants);return Array.isArray(n)?n:[]}function R(e,t){return A(e,t,"permissions")}function T(e,t){return A(e,t,"roles")}const L=(...e)=>e.join("/").replace(/\/{2,}/g,"/");async function $(e,t){var n;const o=await e,i={code:o.status,ok:o.ok,response:o},r=await o.clone().json();return o.ok?i.data=r:(i.error=r,o.status===x&&Object.assign(i.error,{retryAfter:Number.parseInt(null===(n=o.headers)||void 0===n?void 0:n.get("retry-after"))||0})),i}function P(e){var t;return(null===(t=j(e))||void 0===t?void 0:t[h])||""}const W=(e,t)=>(n=t)=>t=>!e(t)&&n.replace("{val}",t),N=(e,t)=>(n=t)=>t=>{const o=e.filter((e=>e(t)));return!(o.length<e.length)&&(n?n.replace("{val}",t):o.join(" OR "))},M=(...e)=>({validate:t=>(e.forEach((e=>{const n=e(t);if(n)throw new Error(n)})),!0)}),_=e=>t=>e.test(t),D=_(/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/),q=_(/^\+[1-9]{1}[0-9]{3,14}$/),F=W(D,'"{val}" is not a valid email'),K=W(q,'"{val}" is not a valid phone number'),J=W((e=>e.length>=1),"Minimum length is 1");const V=W((e=>"string"==typeof e),"Input is not a string"),H=W((e=>Array.isArray(e)),"Input is not an array"),B=W((e=>"boolean"==typeof e),"Input is not a boolean"),z=W((e=>void 0===e),"Input is defined"),G=N([V(),z()],"Input is not a string or undefined"),Z=N([H(),B()],"Input is not an array or boolean"),X=(...e)=>t=>(...n)=>(e.forEach(((e,t)=>M(...e).validate(n[t]))),t(...n)),Y=e=>[V(`"${e}" must be a string`)],Q=e=>[G(`"${e}" must be string or undefined`)],ee=e=>[V(`"${e}" must be a string`),J(`"${e}" must not be empty`)],te=e=>[V(`"${e}" must be a string`),F()],ne=e=>[V(`"${e}" must be a string`),K()],oe=X(ee("accessKey")),ie=e=>({exchange:oe(((t,n)=>$(e.post(l.accessKey.exchange,{loginOptions:n},{token:t}))))}),re=(e,t,n)=>(t.forEach((t=>{const o=t.split(".");let i=o.shift(),r=e;for(;o.length>0;){if(r=r[i],!i||!r)throw Error(`Invalid path "${t}", "${i}" is missing or has no value`);i=o.shift()}if("function"!=typeof r[i])throw Error(`"${t}" is not a function`);const s=r[i];r[i]=n(s)})),e),se=({pollingIntervalMs:e=1e3,timeoutMs:t=6e5}={})=>({pollingIntervalMs:Math.max(e||1e3,1e3),timeoutMs:Math.min(t||u,u)});var ae,le;!function(e){e.sms="sms",e.voice="voice",e.whatsapp="whatsapp"}(ae||(ae={})),function(e){e.email="email"}(le||(le={}));const ce=Object.assign(Object.assign({},ae),le);var de;!function(e){e.waiting="waiting",e.running="running",e.completed="completed",e.failed="failed"}(de||(de={}));const ue=ee("loginId"),he=X(ee("token")),pe=X(ue),ge=X(ee("pendingRef")),fe=X(ue,te("email")),ve=e=>({verify:he((t=>$(e.post(l.enchantedLink.verify,{token:t})))),signIn:pe(((t,n,o,i)=>$(e.post(L(l.enchantedLink.signIn,ce.email),{loginId:t,URI:n,loginOptions:o},{token:i})))),signUpOrIn:pe(((t,n,o)=>$(e.post(L(l.enchantedLink.signUpOrIn,ce.email),{loginId:t,URI:n,loginOptions:o})))),signUp:pe(((t,n,o,i)=>$(e.post(L(l.enchantedLink.signUp,ce.email),{loginId:t,URI:n,user:o,loginOptions:i})))),waitForSession:ge(((t,n)=>new Promise((o=>{const{pollingIntervalMs:i,timeoutMs:r}=se(n);let s;const a=setInterval((async()=>{const n=await e.post(l.enchantedLink.session,{pendingRef:t});n.ok&&(clearInterval(a),s&&clearTimeout(s),o($(Promise.resolve(n))))}),i);s=setTimeout((()=>{o({error:{errorDescription:`Session polling timeout exceeded: ${r}ms`,errorCode:"0"},ok:!1}),clearInterval(a)}),r)})))),update:{email:fe(((t,n,o,i,r)=>$(e.post(l.enchantedLink.update.email,Object.assign({loginId:t,email:n,URI:o},r),{token:i}))))}}),me=X(ee("flowId")),be=X(ee("executionId"),ee("stepId"),ee("interactionId")),we=e=>({start:me(((t,n,o,i,r,s,a)=>$(e.post(l.flow.start,{flowId:t,options:n,conditionInteractionId:o,interactionId:i,componentsVersion:r,flowVersions:s,input:a})))),next:be(((t,n,o,i,r,s)=>$(e.post(l.flow.next,{executionId:t,stepId:n,interactionId:o,version:i,componentsVersion:r,input:s}))))}),ye=ee("loginId"),ke=X(ee("token")),Ie=X(ye),Se=X(ye,ne("phone")),Oe=X(ye,te("email")),Ce=Object.keys(ce).filter((e=>e!==ae.voice)),xe=e=>({verify:ke((t=>$(e.post(l.magicLink.verify,{token:t})))),signIn:Ce.reduce(((t,n)=>Object.assign(Object.assign({},t),{[n]:Ie(((t,o,i,r)=>$(e.post(L(l.magicLink.signIn,n),{loginId:t,URI:o,loginOptions:i},{token:r}))))})),{}),signUp:Ce.reduce(((t,n)=>Object.assign(Object.assign({},t),{[n]:Ie(((t,o,i,r)=>$(e.post(L(l.magicLink.signUp,n),{loginId:t,URI:o,user:i,loginOptions:r}))))})),{}),signUpOrIn:Ce.reduce(((t,n)=>Object.assign(Object.assign({},t),{[n]:Ie(((t,o,i)=>$(e.post(L(l.magicLink.signUpOrIn,n),{loginId:t,URI:o,loginOptions:i}))))})),{}),update:{email:Oe(((t,n,o,i,r)=>$(e.post(l.magicLink.update.email,Object.assign({loginId:t,email:n,URI:o},r),{token:i})))),phone:Object.keys(ae).filter((e=>e!==ae.voice)).reduce(((t,n)=>Object.assign(Object.assign({},t),{[n]:Se(((t,o,i,r,s)=>$(e.post(L(l.magicLink.update.phone,n),Object.assign({loginId:t,phone:o,URI:i},s),{token:r}))))})),{})}});var Ae;!function(e){e.facebook="facebook",e.github="github",e.google="google",e.microsoft="microsoft",e.gitlab="gitlab",e.apple="apple",e.discord="discord",e.linkedin="linkedin",e.slack="slack"}(Ae||(Ae={}));const je=X(ee("code")),Ee=e=>({start:Object.assign(((t,n,o,i,r)=>$(e.post(l.oauth.start,o||{},{queryParams:Object.assign(Object.assign({provider:t},n&&{redirectURL:n}),r&&{loginHint:r}),token:i}))),Object.keys(Ae).reduce(((t,n)=>Object.assign(Object.assign({},t),{[n]:(t,o,i,r)=>$(e.post(l.oauth.start,o||{},{queryParams:Object.assign(Object.assign({provider:n},t&&{redirectURL:t}),r&&{loginHint:r}),token:i}))})),{})),exchange:je((t=>$(e.post(l.oauth.exchange,{code:t})))),startNative:(t,n,o)=>$(e.post(l.oauth.startNative,{provider:t,loginOptions:n,implicit:o})),finishNative:(t,n,o,i,r)=>$(e.post(l.oauth.finishNative,{provider:t,stateId:n,user:o,code:i,idToken:r})),getOneTapClientId:t=>$(e.get(l.oauth.oneTap.getOneTapClientId.replace("{provider}",t))),verifyOneTapIDToken:(t,n,o,i)=>$(e.post(l.oauth.oneTap.verifyOneTapIDToken,{provider:t,idToken:n,nonce:o,loginOptions:i})),exchangeOneTapIDToken:(t,n,o,i)=>$(e.post(l.oauth.oneTap.exchangeOneTapIDToken,{provider:t,idToken:n,nonce:o,loginOptions:i}))}),Ue=ee("appId"),Re=X(Ue),Te=e=>({connect:Re(((t,n,o)=>{const i=null==n?void 0:n.tenantId,r=null==n?void 0:n.tenantLevel;return null==n||delete n.tenantId,null==n||delete n.tenantLevel,$(e.post(l.outbound.connect,{appId:t,tenantId:i,tenantLevel:r,options:n},{token:o}))}))}),Le=ee("loginId"),$e=X(Le,ee("code")),Pe=X(Le),We=X(Le,ne("phone")),Ne=X(Le,te("email")),Me=e=>({verify:Object.keys(ce).reduce(((t,n)=>Object.assign(Object.assign({},t),{[n]:$e(((t,o)=>$(e.post(L(l.otp.verify,n),{code:o,loginId:t}))))})),{}),signIn:Object.keys(ce).reduce(((t,n)=>Object.assign(Object.assign({},t),{[n]:Pe(((t,o,i)=>$(e.post(L(l.otp.signIn,n),{loginId:t,loginOptions:o},{token:i}))))})),{}),signUp:Object.keys(ce).reduce(((t,n)=>Object.assign(Object.assign({},t),{[n]:Pe(((t,o,i)=>$(e.post(L(l.otp.signUp,n),{loginId:t,user:o,loginOptions:i}))))})),{}),signUpOrIn:Object.keys(ce).reduce(((t,n)=>Object.assign(Object.assign({},t),{[n]:Pe(((t,o)=>$(e.post(L(l.otp.signUpOrIn,n),{loginId:t,loginOptions:o}))))})),{}),update:{email:Ne(((t,n,o,i)=>$(e.post(l.otp.update.email,Object.assign({loginId:t,email:n},i),{token:o})))),phone:Object.keys(ae).reduce(((t,n)=>Object.assign(Object.assign({},t),{[n]:We(((t,o,i,r)=>$(e.post(L(l.otp.update.phone,n),Object.assign({loginId:t,phone:o},r),{token:i}))))})),{})}}),_e=X(ee("tenant")),De=X(ee("code")),qe=e=>({start:_e(((t,n,o,i,r,s,a)=>$(e.post(l.saml.start,o||{},Object.assign({queryParams:Object.assign(Object.assign(Object.assign(Object.assign({tenant:t},n&&{redirectURL:n}),r&&{ssoId:r}),s&&{forceAuthn:"true"}),a&&{loginHint:a})},i&&{token:i}))))),exchange:De((t=>$(e.post(l.saml.exchange,{code:t}))))}),Fe=ee("loginId"),Ke=X(Fe,ee("code")),Je=X(Fe),Ve=X(Fe),He=e=>({signUp:Je(((t,n)=>$(e.post(l.totp.signUp,{loginId:t,user:n})))),verify:Ke(((t,n,o,i)=>$(e.post(l.totp.verify,{loginId:t,code:n,loginOptions:o},{token:i})))),update:Ve(((t,n)=>$(e.post(l.totp.update,{loginId:t},{token:n}))))}),Be=ee("loginId"),ze=ee("newPassword"),Ge=X(Be,ee("password")),Ze=X(Be),Xe=X(Be,ze),Ye=X(Be,ee("oldPassword"),ze),Qe=e=>({signUp:Ge(((t,n,o,i)=>$(e.post(l.password.signUp,{loginId:t,password:n,user:o,loginOptions:i})))),signIn:Ge(((t,n,o)=>$(e.post(l.password.signIn,{loginId:t,password:n,loginOptions:o})))),sendReset:Ze(((t,n,o)=>$(e.post(l.password.sendReset,{loginId:t,redirectUrl:n,templateOptions:o})))),update:Xe(((t,n,o)=>$(e.post(l.password.update,{loginId:t,newPassword:n},{token:o})))),replace:Ye(((t,n,o)=>$(e.post(l.password.replace,{loginId:t,oldPassword:n,newPassword:o})))),policy:()=>$(e.get(l.password.policy))}),et=Y("loginId"),tt=ee("loginId"),nt=ee("origin"),ot=X(tt,nt,ee("name")),it=X(tt,nt),rt=X(et,nt),st=X(tt,nt,Q("token")),at=X(ee("transactionId"),ee("response")),lt=e=>({signUp:{start:ot(((t,n,o,i)=>$(e.post(l.webauthn.signUp.start,{user:{loginId:t,name:o},origin:n,passkeyOptions:i})))),finish:at(((t,n)=>$(e.post(l.webauthn.signUp.finish,{transactionId:t,response:n}))))},signIn:{start:rt(((t,n,o,i,r)=>$(e.post(l.webauthn.signIn.start,{loginId:t,origin:n,loginOptions:o,passkeyOptions:r},{token:i})))),finish:at(((t,n)=>$(e.post(l.webauthn.signIn.finish,{transactionId:t,response:n}))))},signUpOrIn:{start:it(((t,n,o)=>$(e.post(l.webauthn.signUpOrIn.start,{loginId:t,origin:n,passkeyOptions:o}))))},update:{start:st(((t,n,o,i)=>$(e.post(l.webauthn.update.start,{loginId:t,origin:n,passkeyOptions:i},{token:o})))),finish:at(((t,n)=>$(e.post(l.webauthn.update.finish,{transactionId:t,response:n}))))}}),ct=Y("loginId"),dt=X(ct),ut=X(ee("pendingRef")),ht=e=>({signUpOrIn:dt(((t,n)=>$(e.post(l.notp.signUpOrIn,{loginId:t,loginOptions:n})))),signUp:dt(((t,n,o)=>$(e.post(l.notp.signUp,{loginId:t,user:n,loginOptions:o})))),signIn:dt(((t,n,o)=>$(e.post(l.notp.signIn,{loginId:t,loginOptions:n},{token:o})))),waitForSession:ut(((t,n)=>new Promise((o=>{const{pollingIntervalMs:i,timeoutMs:r}=se(n);let s;const a=setInterval((async()=>{const n=await e.post(l.notp.session,{pendingRef:t});n.ok&&(clearInterval(a),s&&clearTimeout(s),o($(Promise.resolve(n))))}),i);s=setTimeout((()=>{o({error:{errorDescription:`Session polling timeout exceeded: ${r}ms`,errorCode:"0"},ok:!1}),clearInterval(a)}),r)}))))}),pt=X(ee("token")),gt=X(Q("token"));var ft,vt=X([(ft=ee("projectId"),W(((e,t)=>n=>M(...t).validate(((e,t)=>{const n=(Array.isArray(t)?t.join("."):String(t)).replace(/\[\\?("|')?(\w|d)+\\?("|')?\]/g,((e,t,n)=>"."+n)).split("."),o=n.length;let i=0,r=e===Object(e)?e:void 0;for(;null!=r&&i<o;)r=r[n[i++]];return i&&i===o&&void 0!==r?r:void 0})(n,e)))("projectId",ft))())])((e=>{const{projectId:t,logger:n,baseUrl:o,cookiePolicy:i,baseHeaders:r={},refreshCookieName:s,fetch:a}=e;return c=C({baseUrl:o,projectId:t,logger:n,hooks:{get beforeRequest(){var t;return null===(t=e.hooks)||void 0===t?void 0:t.beforeRequest},get afterRequest(){var t;return null===(t=e.hooks)||void 0===t?void 0:t.afterRequest},get transformResponse(){var t;return null===(t=e.hooks)||void 0===t?void 0:t.transformResponse}},cookiePolicy:i,baseConfig:{baseHeaders:r},refreshCookieName:s,fetch:a}),{accessKey:ie(c),otp:Me(c),magicLink:xe(c),enchantedLink:ve(c),oauth:Ee(c),outbound:Te(c),saml:qe(c),totp:He(c),notp:ht(c),webauthn:lt(c),password:Qe(c),flow:we(c),refresh:gt(((e,t,n,o)=>{const i={};n&&(i.externalToken=n);const r=o?l.tryRefresh:l.refresh;return $(c.post(r,i,{token:e,queryParams:t}))})),selectTenant:X([V("tenantId")],[G('"token" must be string or undefined')])(((e,t)=>$(c.post(l.selectTenant,{tenant:e},{token:t})))),logout:gt((e=>$(c.post(l.logout,{},{token:e})))),logoutAll:gt((e=>$(c.post(l.logoutAll,{},{token:e})))),me:gt((e=>$(c.get(l.me,{token:e})))),myTenants:X([Z('"tenants" must a string array or a boolean')],[G('"token" must be string or undefined')])(((e,t)=>{const n={};return"boolean"==typeof e?n.dct=e:n.ids=e,$(c.post(l.myTenants,n,{token:t}))})),history:gt((e=>$(c.get(l.history,{token:e})))),isJwtExpired:pt(E),getTenants:pt(U),getJwtPermissions:pt(R),getJwtRoles:pt(T),getCurrentTenant:pt(P),httpClient:c};var c})),mt=Object.assign(vt,{DeliveryMethods:ce});
/*! js-cookie v3.0.5 | MIT */function bt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)e[o]=n[o]}return e}var wt=function e(t,n){function o(e,o,i){if("undefined"!=typeof document){"number"==typeof(i=bt({},n,i)).expires&&(i.expires=new Date(Date.now()+864e5*i.expires)),i.expires&&(i.expires=i.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var r="";for(var s in i)i[s]&&(r+="; "+s,!0!==i[s]&&(r+="="+i[s].split(";")[0]));return document.cookie=e+"="+t.write(o,e)+r}}return Object.create({set:o,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var n=document.cookie?document.cookie.split("; "):[],o={},i=0;i<n.length;i++){var r=n[i].split("="),s=r.slice(1).join("=");try{var a=decodeURIComponent(r[0]);if(o[a]=t.read(s,a),e===a)break}catch(e){}}return e?o[e]:o}},remove:function(e,t){o(e,"",bt({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,bt({},this.attributes,t))},withConverter:function(t){return e(bt({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});var yt={default:"endpoint"},kt="Blocked by CSP",It="The endpoint parameter is not a valid URL",St="Failed to load the JS script of the agent",Ot="9319";function Ct(e,t){var n,o,i,r,s,a=[],l=(n=function(e){var t=function(e,t,n){if(n||2===arguments.length)for(var o,i=0,r=t.length;i<r;i++)!o&&i in t||(o||(o=Array.prototype.slice.call(t,0,i)),o[i]=t[i]);return e.concat(o||Array.prototype.slice.call(t))}([],e,!0);return{current:function(){return t[0]},postpone:function(){var e=t.shift();void 0!==e&&t.push(e)},exclude:function(){t.shift()}}}(e),r=0,o=function(){return Math.random()*Math.min(3e3,100*Math.pow(2,r++))},i=new Set,[n.current(),function(e,t){var r,s=t instanceof Error?t.message:"";if(s===kt||s===It)n.exclude(),r=0;else if(s===Ot)n.exclude();else if(s===St){var a=Date.now()-e.getTime()<50,l=n.current();l&&a&&!i.has(l)&&(i.add(l),r=0),n.postpone()}else n.postpone();var c=n.current();return void 0===c?void 0:[c,null!=r?r:e.getTime()+o()-Date.now()]}]),c=l[0],d=l[1];if(void 0===c)return Promise.reject(new TypeError("The list of script URL patterns is empty"));var u=function(e){var n=new Date,o=function(t){return a.push({url:e,startedAt:n,finishedAt:new Date,error:t})},i=t(e);return i.then((function(){return o()}),o),i.catch((function(e){if(null!=s||(s=e),a.length>=5)throw s;var t=d(n,e);if(!t)throw s;var o,i=t[0],r=t[1];return(o=r,new Promise((function(e){return setTimeout(e,o)}))).then((function(){return u(i)}))}))};return u(c).then((function(e){return[e,a]}))}var xt="https://fpnpmcdn.net/v<version>/<apiKey>/loader_v<loaderVersion>.js",At=xt;function jt(n){var o;n.scriptUrlPattern;var i=n.token,r=n.apiKey,s=void 0===r?i:r,a=t(n,["scriptUrlPattern","token","apiKey"]),l=null!==(o=function(e,t){return function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(e,t)?e[t]:void 0}(n,"scriptUrlPattern"))&&void 0!==o?o:xt,c=function(){var e=[],t=function(){e.push({time:new Date,state:document.visibilityState})},n=function(e,t,n,o){return e.addEventListener(t,n,o),function(){return e.removeEventListener(t,n,o)}}(document,"visibilitychange",t);return t(),[e,n]}(),d=c[0],u=c[1];return Promise.resolve().then((function(){if(!s||"string"!=typeof s)throw new Error("API key required");var e=function(e,t){return(Array.isArray(e)?e:[e]).map((function(e){return function(e,t){var n=encodeURIComponent;return e.replace(/<[^<>]+>/g,(function(e){return"<version>"===e?"3":"<apiKey>"===e?n(t):"<loaderVersion>"===e?n("3.11.6"):e}))}(String(e),t)}))}(l,s);return Ct(e,Et)})).catch((function(e){throw u(),function(e){return e instanceof Error&&e.message===Ot?new Error(St):e}(e)})).then((function(t){var n=t[0],o=t[1];return u(),n.load(e(e({},a),{ldi:{attempts:o,visibilityStates:d}}))}))}function Et(e){return function(e,t,n){var o,i=document,r="securitypolicyviolation",s=function(t){var n=new URL(e,location.href),i=t.blockedURI;i!==n.href&&i!==n.protocol.slice(0,-1)&&i!==n.origin||(o=t,a())};i.addEventListener(r,s);var a=function(){return i.removeEventListener(r,s)};return Promise.resolve().then(t).then((function(e){return a(),e}),(function(e){return new Promise((function(e){var t=new MessageChannel;t.port1.onmessage=function(){return e()},t.port2.postMessage(null)})).then((function(){if(a(),o)return n(o);throw e}))}))}(e,(function(){return function(e){return new Promise((function(t,n){if(function(e){if(URL.prototype)try{return new URL(e,location.href),!1}catch(e){if(e instanceof Error&&"TypeError"===e.name)return!0;throw e}}(e))throw new Error(It);var o=document.createElement("script"),i=function(){var e;return null===(e=o.parentNode)||void 0===e?void 0:e.removeChild(o)},r=document.head||document.getElementsByTagName("head")[0];o.onload=function(){i(),t()},o.onerror=function(){i(),n(new Error(St))},o.async=!0,o.src=e,r.appendChild(o)}))}(e)}),(function(){throw new Error(kt)})).then(Ut)}function Ut(){var e=window,t="__fpjs_p_l_b",n=e[t];if(function(e,t){var n,o=null===(n=Object.getOwnPropertyDescriptor)||void 0===n?void 0:n.call(Object,e,t);(null==o?void 0:o.configurable)?delete e[t]:o&&!o.writable||(e[t]=void 0)}(e,t),"function"!=typeof(null==n?void 0:n.load))throw new Error(Ot);return n}const Rt=e=>{try{return a(e).exp}catch(e){return null}},Tt=e=>{const{refresh_expire_in:t,refresh_token:n}=e;return t?Math.floor(Date.now()/1e3)+t:Rt(n)},Lt=e=>{const{expires_in:t,expires_at:n,access_token:o}=e;return n||(t?Math.floor(Date.now()/1e3)+t:o?Rt(o):void 0)},$t=(e,t)=>{var n;return["beforeRequest","afterRequest"].reduce(((n,o)=>{var i;return n[o]=[].concat((null===(i=e.hooks)||void 0===i?void 0:i[o])||[]).concat((null==t?void 0:t[o])||[]),n}),null!==(n=e.hooks)&&void 0!==n?n:e.hooks={}),e},Pt=async e=>{if(!(null==e?void 0:e.ok))return{};const n=await(null==e?void 0:e.clone().json());return(e=>{const{access_token:n,id_token:o,refresh_token:i,refresh_expire_in:r}=e,s=t(e,["access_token","id_token","refresh_token","refresh_expire_in"]);return Object.assign({sessionJwt:e.sessionJwt||n,idToken:o,refreshJwt:e.refreshJwt||i,sessionExpiration:e.sessionExpiration||Lt(e),cookieExpiration:e.cookieExpiration||Tt(e)},s)})((null==n?void 0:n.authInfo)||n||{})},Wt=async e=>{const t=await Pt(e);return(null==t?void 0:t.user)||((null==t?void 0:t.hasOwnProperty("userId"))?t:void 0)},Nt="undefined"!=typeof localStorage,Mt=(e,t)=>Nt&&(null===localStorage||void 0===localStorage?void 0:localStorage.setItem(e,t)),_t=e=>Nt&&(null===localStorage||void 0===localStorage?void 0:localStorage.getItem(e)),Dt=e=>Nt&&(null===localStorage||void 0===localStorage?void 0:localStorage.removeItem(e)),qt=(...e)=>{console.debug(...e)},Ft="3.2.0",Kt="undefined"!=typeof window,Jt=Math.pow(2,31)-1,Vt=`https://descopecdn.com/npm/oidc-client-ts@${Ft}/dist/browser/oidc-client-ts.min.js`,Ht=`https://cdn.jsdelivr.net/npm/oidc-client-ts@${Ft}/dist/browser/oidc-client-ts.min.js`,Bt="DS",zt="DSR",Gt="DSI";function Zt(e=""){return _t(`${e}${zt}`)||""}function Xt(e=""){return wt.get(Bt)||_t(`${e}${Bt}`)||""}function Yt(e=""){return _t(`${e}${Gt}`)||""}function Qt(e=""){Dt(`${e}${zt}`),Dt(`${e}${Bt}`),Dt(`${e}${Gt}`),wt.remove(Bt)}const en=Kt&&(null===localStorage||void 0===localStorage?void 0:localStorage.getItem("fingerprint.endpoint.url"))||"https://api.descope.com",tn="vsid",nn="vrid",on="fp",rn=(e=!1)=>{const t=localStorage.getItem(on);if(!t)return null;const n=JSON.parse(t);return(new Date).getTime()>n.expiry&&!e?null:n.value},sn=async(e,t=en)=>{try{if(rn())return;const n=(Date.now().toString(36)+Math.random().toString(36).substring(2)+Math.random().toString(36).substring(2)).substring(0,27),o=new URL(t);o.pathname="/fXj8gt3x8VulJBna/x96Emn69oZwcd7I6";const i=new URL(t);i.pathname="/fXj8gt3x8VulJBna/w78aRZnnDZ3Aqw0I";const r=i.toString()+"?apiKey=<apiKey>&version=<version>&loaderVersion=<loaderVersion>",s=jt({apiKey:e,endpoint:[o.toString(),yt],scriptUrlPattern:[r,At]}),a=await s,{requestId:l}=await a.get({linkedId:n}),c=((e,t)=>({[tn]:e,[nn]:t}))(n,l);(e=>{const t={value:e,expiry:(new Date).getTime()+864e5};localStorage.setItem(on,JSON.stringify(t))})(c)}catch(e){console.warn("Could not load fingerprint",e)}},an=e=>{const t=rn(!0);return t&&e.body&&(e.body.fpData=t),e},ln="descopeFlowNonce",cn="X-Descope-Flow-Nonce",dn="/v1/flow/start",un="/v1/flow/next",hn=(e,t=ln)=>`${t}${e}`,pn=e=>{var t;return(null===(t=/.*\|#\|(.*)/.exec(e))||void 0===t?void 0:t[1])||null},gn=e=>{var t;return e.path===un&&(null===(t=e.body)||void 0===t?void 0:t.executionId)?pn(e.body.executionId):null},fn="dls_last_user_login_id",vn="dls_last_user_display_name",mn=()=>_t(fn),bn=()=>_t(vn),wn=e=>async(...t)=>{var n;t[1]=t[1]||{};const[,o={}]=t,i=mn(),r=bn();return i&&(null!==(n=o.lastAuth)&&void 0!==n||(o.lastAuth={}),o.lastAuth.loginId=i,o.lastAuth.name=r),await e(...t)};function yn(){const e=[];return{pub:t=>{e.forEach((e=>e(t)))},sub:t=>{const n=e.push(t)-1;return()=>e.splice(n,1)}}}async function kn(e){const t=function(e){var t;const n=JSON.parse(e);return n.publicKey.challenge=An(n.publicKey.challenge),n.publicKey.user.id=An(n.publicKey.user.id),null===(t=n.publicKey.excludeCredentials)||void 0===t||t.forEach((e=>{e.id=An(e.id)})),n}(e);return n=await navigator.credentials.create(t),JSON.stringify({id:n.id,rawId:jn(n.rawId),type:n.type,response:{attestationObject:jn(n.response.attestationObject),clientDataJSON:jn(n.response.clientDataJSON)}});var n}async function In(e){const t=Cn(e);return xn(await navigator.credentials.get(t))}async function Sn(e,t){const n=Cn(e);return n.signal=t.signal,n.mediation="conditional",xn(await navigator.credentials.get(n))}async function On(e=!1){if(!Kt)return Promise.resolve(!1);const t=!!(window.PublicKeyCredential&&navigator.credentials&&navigator.credentials.create&&navigator.credentials.get);return t&&e&&PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable?PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable():t}function Cn(e){var t;const n=JSON.parse(e);return n.publicKey.challenge=An(n.publicKey.challenge),null===(t=n.publicKey.allowCredentials)||void 0===t||t.forEach((e=>{e.id=An(e.id)})),n}function xn(e){return JSON.stringify({id:e.id,rawId:jn(e.rawId),type:e.type,response:{authenticatorData:jn(e.response.authenticatorData),clientDataJSON:jn(e.response.clientDataJSON),signature:jn(e.response.signature),userHandle:e.response.userHandle?jn(e.response.userHandle):void 0}})}function An(e){const t=e.replace(/_/g,"/").replace(/-/g,"+");return Uint8Array.from(atob(t),(e=>e.charCodeAt(0))).buffer}function jn(e){return btoa(String.fromCharCode.apply(null,new Uint8Array(e))).replace(/\//g,"_").replace(/\+/g,"-").replace(/=/g,"")}var En,Un=(En=e=>({async signUp(t,n,o){const i=await e.webauthn.signUp.start(t,window.location.origin,n,o);if(!i.ok)return i;const r=await kn(i.data.options);return await e.webauthn.signUp.finish(i.data.transactionId,r)},async signIn(t,n){const o=await e.webauthn.signIn.start(t,window.location.origin,void 0,void 0,n);if(!o.ok)return o;const i=await In(o.data.options);return await e.webauthn.signIn.finish(o.data.transactionId,i)},async signUpOrIn(t,n){var o;const i=await e.webauthn.signUpOrIn.start(t,window.location.origin,n);if(!i.ok)return i;if(null===(o=i.data)||void 0===o?void 0:o.create){const t=await kn(i.data.options);return await e.webauthn.signUp.finish(i.data.transactionId,t)}{const t=await In(i.data.options);return await e.webauthn.signIn.finish(i.data.transactionId,t)}},async update(t,n,o){const i=await e.webauthn.update.start(t,window.location.origin,n,o);if(!i.ok)return i;const r=await kn(i.data.options);return await e.webauthn.update.finish(i.data.transactionId,r)},helpers:{create:kn,get:In,isSupported:On,conditional:Sn}}),(...e)=>{const t=En(...e);return Object.assign(t.signUp,e[0].webauthn.signUp),Object.assign(t.signIn,e[0].webauthn.signIn),Object.assign(t.signUpOrIn,e[0].webauthn.signUpOrIn),Object.assign(t.update,e[0].webauthn.update),t});const Rn="/fedcm/config",Tn=()=>{if(window.crypto&&window.crypto.getRandomValues){const e=new Uint8Array(16);return window.crypto.getRandomValues(e),Array.from(e,(e=>e.toString(16).padStart(2,"0"))).join("")}return Math.random().toString(36).substring(2)};async function Ln(e,t){var n;try{await $n(e,t)}catch(e){null===(n=null==t?void 0:t.onFailed)||void 0===n||n.call(t,e)}}async function $n(e,t){var n,o;const i=await async function(e,t="google",n,o,i){const r=Tn(),s=await async function(){return new Promise(((e,t)=>{if(window.google)return void e(window.google.accounts.id);let n=document.getElementById("google-gsi-client-script");n||(n=document.createElement("script"),document.head.appendChild(n),n.async=!0,n.defer=!0,n.id="google-gsi-client-script",n.src="https://accounts.google.com/gsi/client"),n.onload=function(){window.google?e(window.google.accounts.id):t("Failed to load Google GSI client script - not loaded properly")},n.onerror=function(){t("Failed to load Google GSI client script - failed to load")}}))}(),a=await e.oauth.getOneTapClientId(t);if(!a.ok)throw new Error("Failed to get OneTap client ID for provider "+t);const l=a.data.clientId;return new Promise((e=>{var a,c;const d=n=>{e({provider:t,nonce:r,credential:null==n?void 0:n.credential})};s.initialize(Object.assign(Object.assign({},n),{itp_support:null===(a=null==n?void 0:n.itp_support)||void 0===a||a,use_fedcm_for_prompt:null===(c=null==n?void 0:n.use_fedcm_for_prompt)||void 0===c||c,client_id:l,callback:d,nonce:r})),s.prompt((e=>{var t,n;if(i&&(null==e?void 0:e.isDismissedMoment())){const n=null===(t=e.getDismissedReason)||void 0===t?void 0:t.call(e);return null==i||i(n),void d()}if(o&&(null==e?void 0:e.isSkippedMoment())){const t=null===(n=e.getSkippedReason)||void 0===n?void 0:n.call(e);return null==o||o(t),void d()}}))}))}(e,t.provider,t.oneTapConfig,t.onSkipped,t.onDismissed);if(!i.credential)return null;if(null==t?void 0:t.onCodeReceived){const o=await e.oauth.verifyOneTapIDToken(i.provider,i.credential,i.nonce,null==t?void 0:t.loginOptions);if(!o.ok||!o.data)throw new Error("Failed to verify OneTap client ID for provider "+i.provider);null===(n=null==t?void 0:t.onCodeReceived)||void 0===n||n.call(t,o.data.code)}else{const n=await e.oauth.exchangeOneTapIDToken(i.provider,i.credential,i.nonce,null==t?void 0:t.loginOptions);if(!n.ok||!n.data)throw new Error("Failed to exchange OneTap client ID for provider "+i.provider);null===(o=null==t?void 0:t.onAuthenticated)||void 0===o||o.call(t,n.data)}}var Pn=e=>Object.assign(Object.assign({},e.flow),{start:async(...t)=>{const n=await On(),o=Object.assign(Object.assign({location:window.location.href},t[1]),{deviceInfo:{webAuthnSupport:n},startOptionsVersion:1});return t[1]=o,e.flow.start(...t)}});let Wn;const Nn=(e,t)=>new Promise(((n,o)=>{if(!e.length)return o(new Error("No URLs provided to loadScriptWithFallback"));const i=t();if(i)return n(i);const r=e.shift(),s=document.createElement("script");s.src=r,s.id=(e=>{let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return Math.abs(t).toString(16)})(r),s.onload=()=>{const e=t();if(e)return n(e);throw new Error("Could not get entry after loading script from URL")},s.addEventListener("error",(()=>{Nn(e,t),s.setAttribute("data-error","true")})),document.body.appendChild(s)})),Mn=(e,t,n)=>{const o=async()=>{let o,i;return o&&i||({client:o,stateUserKey:i}=await(async(e,t,n)=>{Wn||(Wn=(async()=>{try{return require("oidc-client-ts")}catch(e){return Nn([Vt,Ht],(()=>window.oidc))}})());const{OidcClient:o,WebStorageStateStore:i}=await Wn;if(!o)throw new Error("oidc-client-ts is not installed. Please install it by running `npm install oidc-client-ts`");const r=t,s=(null==n?void 0:n.redirectUri)||window.location.href,a=(null==n?void 0:n.scope)||"openid email roles descope.custom_claims offline_access",l=`${r}_user`;let c=e.httpClient.buildUrl(t);(null==n?void 0:n.applicationId)&&(c=`${c}/${n.applicationId}`);const d={authority:c,client_id:t,redirect_uri:s,response_type:"code",scope:a,stateStore:new i({store:window.localStorage,prefix:r}),loadUserInfo:!0,fetchRequestCredentials:"same-origin"};return(null==n?void 0:n.redirectUri)&&(d.redirect_uri=n.redirectUri),(null==n?void 0:n.scope)&&(d.scope=n.scope),{client:new o(d),stateUserKey:l}})(e,t,n)),{client:o,stateUserKey:i}},i=async(t="")=>{var n;const{client:i,stateUserKey:r}=await o(),s=await i.processSigninResponse(t||window.location.href);var a;return await(null===(n=e.httpClient.hooks)||void 0===n?void 0:n.afterRequest({},new Response(JSON.stringify(s)))),window.localStorage.setItem(r,JSON.stringify({id_token:(a=s).id_token,session_state:a.session_state,profile:a.profile})),(()=>{const e=new URL(window.location.href);e.searchParams.delete("code"),e.searchParams.delete("state"),window.history.replaceState({},document.title,e.toString())})(),s};return{loginWithRedirect:async(e={},t=!1)=>{const{client:n}=await o(),i=await n.createSigninRequest(e),{url:r}=i;return t||(window.location.href=r),{ok:!0,data:i}},finishLogin:i,finishLoginIfNeed:async(e="")=>{if(window.location.search.includes("code")&&window.location.search.includes("state"))return await i(e)},refreshToken:async t=>{var n;const{client:i,stateUserKey:r}=await o(),s=(e=>{const t=window.localStorage.getItem(e);return t?JSON.parse(t):null})(r);if(!s)throw new Error("User not found in storage to refresh token");let a=t;if(!a){const t={};e.httpClient.hooks.beforeRequest(t),a=t.token}const l=await i.useRefreshToken({state:{refresh_token:a,session_state:s.session_state,profile:s.profile}});return await(null===(n=e.httpClient.hooks)||void 0===n?void 0:n.afterRequest({},new Response(JSON.stringify(l)))),l},logout:async(e,t=!1)=>{const{client:n,stateUserKey:i}=await o();e||(e={}),e.id_token_hint=e.id_token_hint||Yt(),e.post_logout_redirect_uri=e.post_logout_redirect_uri||window.location.href;const r=await n.createSignoutRequest(e),{url:s}=r;return window.localStorage.removeItem(i),t||window.location.replace(s),r}}},_n=function(...e){return t=>e.reduce(((e,t)=>t(e)),t)}((e=>n=>{var{fpKey:o,fpLoad:i}=n,r=t(n,["fpKey","fpLoad"]);return Kt?(o&&i&&sn(o).catch((()=>null)),e($t(r,{beforeRequest:an}))):e(r)}),(e=>n=>{var{autoRefresh:o}=n,i=t(n,["autoRefresh"]);if(!o||"undefined"!=typeof window&&window.descopeBridge)return e(i);const{clearAllTimers:r,setTimer:s}=(()=>{const e=[];return{clearAllTimers:()=>{for(;e.length;)clearTimeout(e.pop())},setTimer:(t,n)=>{e.push(setTimeout(t,n))}}})();let l,c;Kt&&document.addEventListener("visibilitychange",(()=>{"visible"===document.visibilityState&&l&&new Date>l&&(qt("Expiration time passed, refreshing session"),d.refresh(Zt()||c))}));const d=e($t(i,{afterRequest:async(e,t)=>{const{sessionJwt:n,refreshJwt:o,sessionExpiration:i}=await Pt(t);if(401===(null==t?void 0:t.status))qt("Received 401, canceling all timers"),r();else if(n||i){if(l=((e,t)=>{if(t)return new Date(1e3*t);qt("Could not extract expiration time from session token, trying to decode the token");try{const t=a(e);if(t.exp)return new Date(1e3*t.exp)}catch(e){return null}})(n,i),!l)return void qt("Could not extract expiration time from session token");c=o;const e=(e=>{let t=((n=e)?n.getTime()-(new Date).getTime():0)-2e4;var n;return t>Jt&&(qt(`Timeout is too large (${t}ms), setting it to ${Jt}ms`),t=Jt),t})(l);if(r(),e<=2e4)return void qt("Session is too close to expiration, not setting refresh timer");const t=new Date(Date.now()+e).toLocaleTimeString("en-US",{hour12:!1});qt(`Setting refresh timer for ${t}. (${e}ms)`),s((()=>{qt("Refreshing session due to timer"),d.refresh(Zt()||o)}),e)}}}));return re(d,["logout","logoutAll","oidc.logout"],(e=>async(...t)=>{const n=await e(...t);return qt("Clearing all timers"),r(),n}))}),(e=>t=>e(Object.assign(Object.assign({},t),{baseHeaders:Object.assign({"x-descope-sdk-name":"web-js","x-descope-sdk-version":"1.35.1"},t.baseHeaders)}))),(e=>t=>{const n=yn(),o=yn(),i=yn(),r=e($t(t,{afterRequest:async(e,t)=>{if(401===(null==t?void 0:t.status))o.pub(null),i.pub(null),n.pub(null);else{const e=await Wt(t);e&&i.pub(e);const{sessionJwt:r,sessionExpiration:s}=await Pt(t);r&&o.pub(r),(s||r)&&n.pub(s||42)}}})),s=re(r,["logout","logoutAll","oidc.logout"],(e=>async(...t)=>{const r=await e(...t);return o.pub(null),i.pub(null),n.pub(null),r}));return Object.assign(s,{onSessionTokenChange:o.sub,onUserChange:i.sub,onIsAuthenticatedChange:e=>n.sub((t=>{e(!!t)}))})}),(e=>n=>{const{enableFlowNonce:o=!0,nonceStoragePrefix:i=ln}=n,r=t(n,["enableFlowNonce","nonceStoragePrefix"]);return o?(((e=ln)=>{try{if(!Nt)return;for(let t=0;t<localStorage.length;t++){const n=localStorage.key(t);if(n&&n.startsWith(e)){const t=_t(n);if(t)try{JSON.parse(t).expiry<Date.now()&&Dt(n)}catch(e){Dt(n)}}}}catch(e){console.error("Error cleaning up expired nonces:",e)}})(i),e($t(r,{afterRequest:async(e,t)=>{if(e.path!==dn&&e.path!==un)return;const{nonce:n,executionId:o}=await(async(e,t)=>{try{const n=t.headers.get(cn);let o=await t.clone().json().then((e=>(null==e?void 0:e.executionId)||null)).catch((()=>null));return o||(o=gn(e)),{nonce:n,executionId:pn(o)}}catch(e){return{nonce:null,executionId:null}}})(e,t);n&&o&&((e,t,n,o=ln)=>{try{const i=hn(e,o),r=n?172800:10800,s={value:t,expiry:Date.now()+1e3*r,isStart:n};Mt(i,JSON.stringify(s))}catch(e){console.error("Error setting flow nonce:",e)}})(o,n,e.path===dn,i)},beforeRequest:e=>{if(e.path===un){const t=gn(e);if(t){const n=((e,t=ln)=>{try{const n=hn(e,t),o=_t(n);if(!o)return null;const i=JSON.parse(o);return i.expiry<Date.now()?(((e,t=ln)=>{try{const n=hn(e,t);Dt(n)}catch(e){console.error("Error removing flow nonce:",e)}})(e,t),null):i.value}catch(e){return console.error("Error getting flow nonce:",e),null}})(t,i);n&&(e.headers=e.headers||{},e.headers[cn]=n)}}return e}}))):e(r)}),(e=>n=>{var{storeLastAuthenticatedUser:o=!0,keepLastAuthenticatedUserAfterLogout:i=!1}=n,r=t(n,["storeLastAuthenticatedUser","keepLastAuthenticatedUserAfterLogout"]);if(!o)return Object.assign(e(r),{getLastUserLoginId:mn,getLastUserDisplayName:bn});const s=e($t(r,{afterRequest:async(e,t)=>{var n;const o=await Wt(t),i=null===(n=null==o?void 0:o.loginIds)||void 0===n?void 0:n[0],r=null==o?void 0:o.name;i&&((e=>{Mt(fn,e)})(i),(e=>{Mt(vn,e)})(r))}}));let a=re(s,["flow.start"],wn);return a=re(a,["logout","logoutAll"],(e=>t=>async(...n)=>{const o=await t(...n);return e||(Dt(fn),Dt(vn)),o})(i)),Object.assign(a,{getLastUserLoginId:mn,getLastUserDisplayName:bn})}),(e=>n=>{var{persistTokens:o,sessionTokenViaCookie:i,storagePrefix:r}=n,s=t(n,["persistTokens","sessionTokenViaCookie","storagePrefix"]);if(!o||!Kt)return e(s);const a=e($t(s,{beforeRequest:(l=r,e=>Object.assign(e,{token:e.token||Zt(l)})),afterRequest:async(e,t)=>{const n=/^\/v\d+\/mgmt\//.test(e.path);401===(null==t?void 0:t.status)?n||Qt(r):((e={},t=!1,n="")=>{var o;const{sessionJwt:i,refreshJwt:r}=e;if(r&&Mt(`${n}${zt}`,r),i)if(t){const n=t.sameSite||"Strict",r=null===(o=t.secure)||void 0===o||o;!function(e,t,n){if(t){const{cookieDomain:o,cookiePath:i,cookieSameSite:r,cookieExpiration:s,cookieSecure:a}=n,l=new Date(1e3*s),c=function(e){const t=window.location.hostname.split("."),n=e.split(".");return t.slice(-n.length).join(".")===e}(o);wt.set(e,t,{path:i,domain:c?o:void 0,expires:l,sameSite:r,secure:a})}}(Bt,i,Object.assign(Object.assign({},e),{cookieSameSite:n,cookieSecure:r}))}else Mt(`${n}${Bt}`,i);e.idToken&&Mt(`${n}${Gt}`,e.idToken)})(await Pt(t),i,r)}}));var l;const c=re(a,["logout","logoutAll","oidc.logout"],(e=>t=>async(...n)=>{const o=await t(...n);return Qt(e),o})(r));return Object.assign(c,{getRefreshToken:()=>Zt(r),getSessionToken:()=>Xt(r),getIdToken:()=>Yt(r)})}))((e=>{const t=mt(e),n=Mn(t,e.projectId,e.oidcConfig);return Object.assign(Object.assign({},t),{refresh:async(o,i)=>{var r;if(e.oidcConfig)try{return await n.refreshToken(o),Promise.resolve({ok:!0})}catch(e){return Promise.resolve({ok:!1,error:{errorCode:"J161001",errorDescription:e.toString()}})}const s=Xt(),a=Zt();let l="";if(e.getExternalToken)try{l=await(null===(r=e.getExternalToken)||void 0===r?void 0:r.call(e))}catch(e){qt("Error getting external token while refreshing",e)}return t.refresh(o,{dcs:s?"t":"f",dcr:a?"t":"f"},l,i)},logout:async o=>{if(e.oidcConfig)try{return await n.logout({id_token_hint:o}),Promise.resolve({ok:!0})}catch(e){return Promise.resolve({ok:!1,error:{errorCode:"J161000",errorDescription:e.toString()}})}return t.logout(o)},flow:Pn(t),webauthn:Un(t),fedcm:(o=t,i=e.projectId,{onetap:{requestExchangeCode(e){Ln(o,e)},requestAuthentication(e){Ln(o,e)}},async oneTap(e,t,n,i,r){await $n(o,{provider:e,oneTapConfig:t,loginOptions:n,onSkipped:i,onDismissed:r})},async launch(e){var t;const n={identity:{context:e||"signin",providers:[{configURL:o.httpClient.buildUrl(i+Rn),clientId:i}]}},r=await(null===(t=navigator.credentials)||void 0===t?void 0:t.get(n));return o.refresh(r.token)},isSupported:()=>Kt&&"IdentityCredential"in window,async isLoggedIn(e){var t;const n=o.httpClient.buildUrl(i+Rn);try{const o={identity:{context:e||"signin",providers:[{configURL:n,clientId:i}]}},r=await(null===(t=navigator.credentials)||void 0===t?void 0:t.get(o));return!!r&&!!r.token}catch(e){return!1}}}),oidc:n});var o,i})),Dn="undefined"!=typeof localStorage,qn="J151000",Fn="E103205",Kn=Dn&&localStorage.getItem("base.content.url")||"",Jn="base.ui.components.url";Dn&&localStorage.getItem(Jn),Dn&&localStorage.getItem(Jn);const Vn="descope-login-flow",Hn="code",Bn="redirect_mode",zn="data-exclude-field",Gn="data-exclude-next",Zn="dls_last_auth",Xn="state_id",Yn="saml_idp_state_id",Qn="saml_idp_username",eo="descope_idp_initiated",to="sso_app_id",no="third_party_app_id",oo="third_party_app_state_id",io="oidc_login_hint",ro="oidc_prompt",so="oidc_resource",ao="oidc_error_redirect_uri",lo="application_scopes",co="data-type",uo="redirect",ho="poll",po="webauthnCreate",go="webauthnGet",fo="nativeBridge",vo="loadForm",mo="submit",bo="polling",wo=["descope-multi-select-combo-box","descope-text-area"],yo=["cssVars","componentsConfig","inputs","errorText","errorType","clientScripts"];var ko;!function(e){e.backward="backward",e.forward="forward"}(ko||(ko={}));const Io=["descope-enriched-text"];function So(e){return new URLSearchParams(window.location.search).get(e)}function Oo(e){if(window.history.replaceState&&So(e)){const t=new URL(window.location.href),n=new URLSearchParams(t.search);n.delete(e),t.search=n.toString(),window.history.replaceState({},"",t.toString())}}function Co(e,t){if(!t)return;const n=+e,o=+t;return Number.isNaN(n)||Number.isNaN(o)?void 0:n>o?ko.forward:n<o?ko.backward:void 0}const xo=e=>{let[t="",n=""]=(So(Vn)||"").split("_");const o=(e=>{var t;return(null===(t=/(.*)\|#\|.*/.exec(e))||void 0===t?void 0:t[1])||""})(t);return(!e||o&&o!==e)&&(t="",n=""),{executionId:t,stepId:n,executionFlowId:o}};function Ao(){Oo(Vn)}const jo=e=>e.replace(/-./g,(e=>e[1].toUpperCase())),Eo=(e,t)=>{const{executionId:n,stepId:o,executionFlowId:i}=xo(e);if(i&&e!==i)return t.debug("Flow id does not match the execution flow id, skipping url params handling"),{ssoQueryParams:{}};(n||o)&&Ao();const r=So("t")||void 0;r&&Oo("t");const s=So(Hn)||void 0;s&&Oo(Hn);const a="popup"===So(Bn);a&&Oo(Bn);const l=So("err")||void 0;l&&Oo("err");const{redirectAuthCodeChallenge:c,redirectAuthCallbackUrl:d,redirectAuthBackupCallbackUri:u,redirectAuthInitiator:h}={redirectAuthCodeChallenge:So("ra-challenge"),redirectAuthCallbackUrl:So("ra-callback"),redirectAuthBackupCallbackUri:So("ra-backup-callback"),redirectAuthInitiator:So("ra-initiator")},p=So(Xn);p&&Oo(Xn);const g=So(Yn);g&&Oo(Yn);const f=So(Qn);g&&Oo(Qn);const v=So(eo);v&&Oo(eo);const m=So(to);m&&Oo(to);const b=So(no);b&&Oo(no);const w=So(oo);w&&Oo(oo);const y=So(lo);y&&Oo(lo);const k=So(io);k&&Oo(io);const I=So(ro);I&&Oo(ro);const S=So(ao);S&&Oo(ao);const O=So(so);O&&Oo(so);return{executionId:n,stepId:o,token:r,code:s,isPopup:a,exchangeError:l,redirectAuthCodeChallenge:c,redirectAuthCallbackUrl:d,redirectAuthBackupCallbackUri:u,redirectAuthInitiator:h,ssoQueryParams:{oidcIdpStateId:p,samlIdpStateId:g,samlIdpUsername:f,descopeIdpInitiated:"true"===v,ssoAppId:m,oidcLoginHint:k,oidcPrompt:I,oidcErrorRedirectUri:S,oidcResource:O,thirdPartyAppId:b,thirdPartyAppStateId:w,applicationScopes:y}}},Uo=e=>{let t,n;return Object.assign(((...o)=>{return t&&(r=o,(i=t).length===r.length&&i.every(((e,t)=>e===r[t])))||(t=o,n=e(...o)),n;var i,r}),{reset:()=>{t=void 0,n=void 0}})},Ro=(e,t,n)=>{if(!0===t||"skipFirstScreen"===t&&!n){const t=e.querySelector("*[name]");setTimeout((()=>{null==t||t.focus()}))}};function To(e,t,n){return new Promise(((o,i)=>{let r=!1;const s=setTimeout((()=>{r=!0,void 0!==n?o(n):i(new Error(`Promise timed out after ${e} ms`))}),e);t.then((e=>{r||(clearTimeout(s),o(e))})).catch((e=>{r||(clearTimeout(s),i(e))}))}))}const Lo=(e,{oidcIdpStateId:t,samlIdpStateId:n,samlIdpUsername:o,ssoAppId:i,oidcLoginHint:r,oidcPrompt:s,oidcErrorRedirectUri:a,oidcResource:l,thirdPartyAppId:c,thirdPartyAppStateId:d,applicationScopes:u})=>!(!e||t||n||o||i||r||s||a||l||c||d||u),$o=e=>null==e?void 0:e.submit(),Po=(e,t)=>{const n=t.find((t=>e[t]));return n?e[n]:null},Wo=(e,t=100)=>{let n;return function(...o){n||e.apply(this,o),clearTimeout(n),n=setTimeout((()=>{n=null}),t)}};function No(e){if(e)return{locale:e.toLowerCase(),fallback:e.toLowerCase()};const t=navigator.language;return t?t.includes("-")?{locale:t.toLowerCase(),fallback:t.split("-")[0].toLowerCase()}:{locale:t.toLowerCase(),fallback:t.toLowerCase()}:{locale:"",fallback:""}}const Mo=e=>{var t,n,o;const i=(r=e.screenState,s=(e,t)=>yo.includes(t)||t.startsWith("_"),Object.fromEntries(Object.entries(r).filter((([e,t])=>!s(t,e)))));var r,s;const{screenState:{errorText:a,errorType:l}}=e;return(a||l)&&(i.error={text:a,type:l}),e.action&&(i.action=e.action),(null===(o=null===(n=null===(t=e.screenState)||void 0===t?void 0:t.componentsConfig)||void 0===n?void 0:n.thirdPartyAppApproveScopes)||void 0===o?void 0:o.data)&&(i.inboundAppApproveScopes=e.screenState.componentsConfig.thirdPartyAppApproveScopes.data),i},_o=e=>{const t=Object.assign({},e);return e.inboundAppApproveScopes&&(t.thirdPartyAppApproveScopes=e.inboundAppApproveScopes),t};function Do(e,t){return`sdkScriptsResults.${t?`${e}_${t}`:e}`}var qo,Fo,Ko,Jo;function Vo(e,t){const n=Object.getOwnPropertyNames(e),o=Object.getOwnPropertyNames(t);if(n.length!==o.length)return!1;for(let o=0;o<n.length;o+=1){const i=n[o],r=e[i],s=t[i];if(null===r||null===s){if(r!==s)return!1}else if("object"==typeof r&&"object"==typeof s){if(!Vo(r,s))return!1}else if(r!==s)return!1}return!0}class Ho{constructor(e={},{forceUpdate:t=!1}={}){qo.set(this,void 0),Fo.set(this,{}),Ko.set(this,0),Jo.set(this,!0),this.update=e=>{const t="function"==typeof e?e(o(this,qo,"f")):e,n=Object.assign(Object.assign({},o(this,qo,"f")),t),r=o(this,qo,"f");i(this,qo,n,"f"),Object.freeze(o(this,qo,"f")),setTimeout((()=>{Object.values(o(this,Fo,"f")).forEach((({cb:e,selector:t,forceUpdate:i})=>{const s=t(r),a=t(n);(o(this,Jo,"f")||i||(function(e){if("object"!=typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return t===Object.prototype||null===t}(a)?!Vo(s,a):s!==a))&&e(a,s,((e,t)=>n=>e[n]!==t[n])(a,s))}))}),0)},i(this,qo,e,"f"),i(this,Jo,t,"f")}get current(){return Object.assign({},o(this,qo,"f"))}set forceUpdate(e){i(this,Jo,e,"f")}subscribe(e,t=e=>e,{forceUpdate:n=!1}={}){return i(this,Ko,o(this,Ko,"f")+1,"f"),o(this,Fo,"f")[o(this,Ko,"f")]={cb:e,selector:t,forceUpdate:n},o(this,Ko,"f").toString()}unsubscribe(e){const t=!!o(this,Fo,"f")[e];return t&&delete o(this,Fo,"f")[e],t}unsubscribeAll(){return i(this,Fo,{},"f"),!0}}qo=new WeakMap,Fo=new WeakMap,Ko=new WeakMap,Jo=new WeakMap;const Bo=["*","#","/","(",")","[","]","_","<",">","`"],zo=e=>{const t=Bo.map((t=>`${e}${t}`)).join("|");return new RegExp(`(${t})`,"g")},Go=["disabled"],Zo=(e,t)=>{Object.entries(t||{}).forEach((([t,n])=>{Array.from(e.querySelectorAll(`*[name="${t}"]:not([${zn}])`)).forEach((e=>{e.value=n}))}))},Xo=(e,t)=>t.split(".").reduce(((e,t)=>(null==e?void 0:e[t])||""),e),Yo=(e,t,n)=>e.replace(/{{(.+?)}}/g,((e,o)=>n?(e=>"string"!=typeof e?e:e.replace(zo("\\"),"\\$1"))(Xo(t,o)):Xo(t,o))),Qo=(e,t)=>{e.querySelectorAll("descope-text,descope-link,descope-enriched-text,descope-code-snippet").forEach((e=>{const n=(o=e.localName,Io.includes(o));var o;e.textContent=Yo(e.textContent,t,n);const i=e.getAttribute("href");i&&e.setAttribute("href",Yo(i,t))}))},ei=(e,t,n)=>{e.querySelectorAll(`[${co}="${t}"]`).forEach((e=>{e.setAttribute("href",n)}))},ti=(e,t,n)=>{var o,i;const r=null===(o=customElements.get(t))||void 0===o?void 0:o.cssVarList.url;n&&r&&(null===(i=null==e?void 0:e.style)||void 0===i||i.setProperty(r,`url(data:image/jpg;base64,${n})`))},ni=(e,n,o,i,r)=>{var s,a;ei(e,"totp-link",null===(s=null==n?void 0:n.totp)||void 0===s?void 0:s.provisionUrl),ei(e,"notp-link",null===(a=null==n?void 0:n.notp)||void 0===a?void 0:a.redirectUrl),Qo(e,n),((e,n,o)=>{if(!n)return;const{componentsDynamicAttrs:i}=n,r=t(n,["componentsDynamicAttrs"]),s=Object.keys(r).reduce(((e,t)=>(e[`[name=${t}]`]=r[t],e)),{});i&&Object.keys(i).forEach((e=>{const t=i[e];if(t){const{attributes:n}=t;n&&Object.keys(n).length&&(s[e]=n)}})),Object.keys(s).forEach((t=>{e.querySelectorAll(t).forEach((e=>{const n=s[t];Object.keys(n).forEach((t=>{let i=n[t];if("string"!=typeof i)try{i=JSON.stringify(i)}catch(e){o.error(`Could not stringify value "${i}" for "${t}"`,e.message),i=""}e.setAttribute(t,i)}))}))}))})(e,o,r),((e,t)=>{e.querySelectorAll("[data-has-dynamic-attr-values]").forEach((e=>{Array.from(e.attributes).forEach((e=>{e.value=Yo(e.value,t)}))}))})(e,n),((e,t)=>{Object.entries(t).forEach((([t,n])=>{e.querySelectorAll(`[name="${t}"]`).forEach((e=>{Object.entries(n).forEach((([t,n])=>{Go.includes(t)&&e.setAttribute(t,n)}))}))}))})(e,i)},oi=Uo((()=>n(void 0,void 0,void 0,(function*(){var e,t;if(!window.PublicKeyCredential||!PublicKeyCredential.isConditionalMediationAvailable||!PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable)return!1;try{const n=Promise.all([null===(e=window.PublicKeyCredential)||void 0===e?void 0:e.isConditionalMediationAvailable(),null===(t=window.PublicKeyCredential)||void 0===t?void 0:t.isUserVerifyingPlatformAuthenticatorAvailable()]).then((e=>e.every((e=>!!e)))),o=(()=>{var e;const t=null===(e=null===navigator||void 0===navigator?void 0:navigator.userAgentData)||void 0===e?void 0:e.brands,n=null==t?void 0:t.find((({brand:e,version:t})=>"Chromium"===e&&parseFloat(t)));return n?n.version:0})()>=108;return yield To(100,n,o)}catch(e){return console.error("Conditional login check failed",e),!1}})))),ii=(e,t,n,o={})=>{var i,r,s,a;return[Math.min(Math.max(t,("all"===o.left?e.offsetWidth:null!==(i=o.left)&&void 0!==i?i:0)-e.offsetWidth),window.innerWidth-("all"===o.right?e.offsetWidth:null!==(r=o.right)&&void 0!==r?r:0)),Math.min(Math.max(n,("all"===o.top?e.offsetHeight:null!==(s=o.top)&&void 0!==s?s:0)-e.offsetHeight),window.innerHeight-("all"===o.bottom?e.offsetHeight:null!==(a=o.bottom)&&void 0!==a?a:0))]},ri="dls_ab_testing_id",si={"lastAuth.loginId":{"not-empty":e=>{var t;return!!e.loginId||!!(null===(t=e.lastAuth)||void 0===t?void 0:t.loginId)},empty:e=>{var t;return!e.loginId&&!(null===(t=e.lastAuth)||void 0===t?void 0:t.loginId)}},idpInitiated:{"is-true":e=>!!e.code,"is-false":e=>!e.code},externalToken:{"is-true":e=>!!e.token,"is-false":e=>!e.token},abTestingKey:{"greater-than":(e,t)=>(e.abTestingKey||0)>t,"less-than":(e,t)=>(e.abTestingKey||0)<t,"greater-than-or-equal":(e,t)=>(e.abTestingKey||0)>=t,"less-than-or-equal":(e,t)=>(e.abTestingKey||0)<=t,"in-range":(e,t)=>{const[n,o]=t?t.split(",").map(Number):[void 0,void 0];return(e.abTestingKey||0)>=(null!=n?n:0)&&(e.abTestingKey||0)<=(null!=o?o:0)},"not-in-range":(e,t)=>{const[n,o]=t?t.split(",").map(Number):[void 0,void 0];return!(void 0!==n&&void 0!==o&&!Number.isNaN(n)&&!Number.isNaN(o))||((e.abTestingKey||0)<n||(e.abTestingKey||0)>o)},"devised-by":(e,t)=>{const n=Number(t);return!Number.isNaN(n)&&(e.abTestingKey||0)%n==0}}};function ai(e){const t={};try{Object.assign(t,JSON.parse(localStorage.getItem(Zn)))}catch(e){}return(null==t?void 0:t.loginId)||e?t:{}}function li(e,t){(null==e?void 0:e.authMethod)&&(t&&!(null==e?void 0:e.loginId)||Dn&&localStorage.setItem(Zn,JSON.stringify(e)))}function ci(...e){return t=>e.reduce(((e,t)=>t(e)),t)}const di=e=>{const t=Symbol((e=>{const t=e.toString();let n=0;for(let e=0;e<t.length;e++)n=(n<<5)-n+t.charCodeAt(e),n&=n;return n.toString(16)})(e));return n=>{if(n[t])return n;const o=e(n);return o[t]=!0,o}},ui=["error","warn","info","debug"],hi=di((e=>{var t,n,r,s;return s=class extends e{constructor(){super(...arguments),t.add(this),n.set(this,o(this,t,"m",r).call(this,console))}set logger(e){i(this,n,o(this,t,"m",r).call(this,e||console),"f")}get logger(){return o(this,n,"f")}onLogEvent(e,t){}},n=new WeakMap,t=new WeakSet,r=function(e){return ui.reduce(((t,n)=>(t[n]=(...t)=>{var o;this.onLogEvent(n,t),null===(o=e[n])||void 0===o||o.call(e,...t)},t)),{})},s})),pi="undefined"!=typeof localStorage,gi=pi&&localStorage.getItem("base.content.url")||"",fi=(e,t)=>!t&&`${e} cannot be empty, please make sure to set this attribute`,vi=di((e=>{var t,n;return n=class extends e{constructor(){super(...arguments),t.set(this,!0)}connectedCallback(){var e,n;null===(e=super.connectedCallback)||void 0===e||e.call(this),(null===(n=this.shadowRoot)||void 0===n?void 0:n.isConnected)&&o(this,t,"f")&&(i(this,t,!1,"f"),this.init())}async init(){}},t=new WeakMap,n})),mi=di((e=>{var t,n;const i=ci(hi,vi)(e);return n=class extends i{constructor(){super(...arguments),t.set(this,{})}async init(){var e,n,i;await(null===(e=super.init)||void 0===e?void 0:e.call(this)),n=this,i=e=>{var n;null===(n=o(this,t,"f")[e])||void 0===n||n.forEach((t=>{t(e,this.getAttribute(e))}))},Array.from(n.attributes).forEach((e=>i(e.name))),new MutationObserver((e=>{e.forEach((e=>{"attributes"===e.type&&i(e.attributeName)}))})).observe(n,{attributes:!0})}observeAttribute(e,n){o(this,t,"f")[e]||(o(this,t,"f")[e]=[]);const i=o(this,t,"f")[e].push(n);return()=>o(this,t,"f")[e].splice(i,1)}observeAttributes(e,t){const n=e.reduce(((e,n)=>(e.push(this.observeAttribute(n,t)),e)),[]);return()=>n.forEach((e=>e()))}},t=new WeakMap,n})),bi=e=>t=>{var n,i,r;const s=ci(hi,vi,mi)(t),a=Object.keys(e);return r=class extends s{constructor(...e){super(...e),n.add(this),this.observeAttributes(a,o(this,n,"m",i).bind(this))}async init(){var e;a.forEach((e=>o(this,n,"m",i).call(this,e,this.getAttribute(e)))),await(null===(e=super.init)||void 0===e?void 0:e.call(this))}},n=new WeakSet,i=function(t,n){const o=e[t],i="function"==typeof o?o(t,n):o;i&&this.logger.error(i)},r};bi.missingAttrValidator=fi;const wi=di((e=>{const t=ci(bi({"project-id":fi}))(e);return class extends t{get projectId(){return this.getAttribute("project-id")}}})),yi=di((e=>class extends e{get baseUrl(){return this.getAttribute("base-url")||""}})),ki="Trying the next fallback URL...",Ii=async(e,t,{logger:n}={})=>{try{return await fetch(e,t)}catch(o){return null==n||n.debug(`Network error fetching URL ${e} [${o.message}], retrying...`),fetch(e,t)}};function Si({projectId:e,filename:t,assetsFolder:n="v2-beta",baseUrl:o="https://static.descope.com/pages"}){const i=new URL(o);return i.pathname=((...e)=>e.join("/").replace(/\/+/g,"/"))(i.pathname,e,n,t),i.baseUrl=o,i}const Oi=di((e=>{var t,n,r,s,a;const l=ci(hi,wi,yi)(e);return a=class extends l{constructor(){super(...arguments),t.add(this),n.set(this,void 0),r.set(this,void 0)}async fetchStaticResource(e,n){const a=o(this,t,"m",s).call(this,e),l=Array.isArray(a)?e=>{if(e!==a.length-1){const{baseUrl:t}=a[e];i(this,r,t,"f")}}:null;try{const e=await(async(e,t,{logger:n,onSuccess:o}={})=>{const i=Array.isArray(e)?e:[e];for(let e=0;e<i.length;e++){const r=i[e],s=e===i.length-1;try{const i=await Ii(r.toString(),t,{logger:n});if(i.ok)return null==o||o(e),null==n||n.debug(`Successfully fetched URL ${r}`),i;const a=`Error fetching URL ${r} [${i.status}]`;if(s)throw new Error(a);null==n||n.debug(`${a}. ${ki}`)}catch(e){const t=`Error fetching URL ${r} [${e.message}]`;if(s)throw new Error(t);null==n||n.debug(`${t}. ${ki}`)}}})(a,{cache:"default"},{logger:this.logger,onSuccess:l});return{body:await e[n](),headers:Object.fromEntries(e.headers.entries())}}catch(e){this.logger.error(e.message)}}get baseStaticUrl(){return this.getAttribute("base-static-url")||""}},n=new WeakMap,r=new WeakMap,t=new WeakSet,s=function(e){const t=gi||this.baseStaticUrl;if(t)return Si({projectId:this.projectId,filename:e,baseUrl:t});const s=o(this,n,"f")!==this.baseUrl,a=s&&!!this.baseUrl;s&&(i(this,n,this.baseUrl,"f"),i(this,r,void 0,"f"));const l=Si({projectId:this.projectId,filename:e,baseUrl:o(this,r,"f")});if(!a)return l;return[Si({projectId:this.projectId,filename:e,baseUrl:this.baseUrl+"/pages"}),l]},a})),Ci=di((e=>{var t,n;const i=ci(bi({"project-id":fi}))(e);return n=class extends i{constructor(){super(...arguments),t.set(this,new Map)}onReset(e,n){if(o(this,t,"f").has(e))throw new Error(`Callback for sectionId ${e} already exists`);return o(this,t,"f").set(e,n),()=>{o(this,t,"f").delete(e)}}async reset(...e){0===e.length?await Promise.all(Array.from(o(this,t,"f").values()).map((e=>e()))):await Promise.all(e.map((e=>{var n;if(!o(this,t,"f").has(e))throw new Error(`Callback for sectionId ${e} does not exist`);return null===(n=o(this,t,"f").get(e))||void 0===n?void 0:n()})))}},t=new WeakMap,n})),xi=di((e=>{var t,n,r,s,a;const l=ci(Oi,Ci,vi)(e);return a=class extends l{constructor(){super(...arguments),t.add(this),r.set(this,void 0),s.set(this,(async()=>{try{const{body:e,headers:t}=await this.fetchStaticResource("config.json","json");return{projectConfig:e,executionContext:{geo:t["x-geo"]}}}catch(e){this.logger.error("Cannot fetch config file","make sure that your projectId & flowId are correct")}}))}async init(){await super.init(),this.onReset("config",o(this,t,"m",n).bind(this))}get config(){return o(this,r,"f")||i(this,r,o(this,s,"f").call(this),"f"),o(this,r,"f")}},r=new WeakMap,s=new WeakMap,t=new WeakSet,n=function(){i(this,r,void 0,"f")},a})),Ai=["https://descopecdn.com","https://static.descope.com","https://cdn.jsdelivr.net"],ji=e=>{let t=0;const n=e.toString();for(let e=0;e<n.length;e++){t=(t<<5)-t+n.charCodeAt(e),t|=0}return`${Math.abs(t).toString()}`},Ei=(e,t)=>new Promise(((n,o)=>{const i=(e=>{const t=document.createElement("script");return t.id=e,t})(e);i.onerror=e=>{i.setAttribute("status","error"),o(e)},i.onload=()=>{i.setAttribute("status","loaded"),n(i)},i.src=t.toString(),document.body.appendChild(i)})),Ui=e=>"loaded"===e.getAttribute("status")?Promise.resolve(e):(e=>"error"===e.getAttribute("status"))(e)?Promise.reject():new Promise(((t,n)=>{e.addEventListener("load",(()=>{t(e)})),e.addEventListener("error",(e=>{n(e)}))})),Ri=di((e=>{const t=ci(hi)(e);return class extends t{get baseCdnUrl(){return this.getAttribute("base-cdn-url")||""}injectNpmLib(e,t,n="",o=[]){return this.logger.debug(`Injecting npm lib: "${e}" with version: "${t}"`),(async(e,t)=>{for(const o of e){const{id:e,url:i}=o,r=(n=e,document.querySelector(`script#${n}`));if(r)try{return await Ui(r),o}catch(e){t(o,!0)}else try{return await Ei(e,i),o}catch(e){t(o,!1)}}var n;throw new Error("All scripts failed to load")})(((e,t,n,o="")=>e.reduce(((e,i)=>{const r=i;if(!r)return e;let s;try{s=new URL(r)}catch(e){throw new Error(`Invalid URL: ${r}`)}return"/"!==s.pathname||(s.pathname=`/npm/${t}@${n}/${o}`),[...e,{url:s,id:`npmlib-${t.replaceAll("@","").replaceAll("/","_")}-${ji(s)}`}]}),[]))([...o,this.baseCdnUrl,...Ai],e,t,n),((e,t)=>{t?this.logger.error(`Existing script cannot be loaded: "${e.url}"`):this.logger.error(`Cannot load script from URL, Make sure this URL is valid and return the correct script: "${e.url}"`)}))}}})),Ti="base.ui.components.url",Li=pi&&localStorage.getItem(Ti),$i=di((e=>{var t,n,r,s,a,l;const c=ci(hi,xi,Ri)(e);return l=class extends c{constructor(){super(...arguments),t.add(this),r.set(this,void 0)}get descopeUi(){return o(this,r,"f")||i(this,r,o(this,t,"m",a).call(this),"f"),o(this,r,"f")}async loadDescopeUiComponents(e){const n=Array.isArray(e)?e:(e=>[...Array.from(e.content.querySelectorAll("*")).reduce(((e,t)=>t.localName.startsWith("descope-")?e.add(t.localName):e),new Set)])(e);return Promise.all(n.map((e=>o(this,t,"m",s).call(this,e))))}},r=new WeakMap,t=new WeakSet,n=async function(){var e;const t=await this.config,n=null===(e=null==t?void 0:t.projectConfig)||void 0===e?void 0:e.componentsVersion;return n?this.logger.debug(`Got component version "${n}"`):this.logger.error("Could not get components version"),n},s=async function(e){if(!!customElements.get(e))return void this.logger.debug(`Loading component "${e}" is skipped as it is already defined`);const t=await this.descopeUi;if(t[e])try{return await t[e]()}catch(t){if("NotSupportedError"!==t.name)throw t;console.debug(`Encountered an error while attempting to define the "${e}" component, it is likely that this component is already defined`)}else this.logger.error(`Cannot load UI component "${e}"`,`Descope UI does not have a component named "${e}", available components are: "${Object.keys(t).join(", ")}"`)},a=async function(){if(globalThis.DescopeUI)return globalThis.DescopeUI;try{return await this.injectNpmLib("@descope/web-components-ui",await o(this,t,"m",n).call(this),"dist/umd/index.js",[Li]),this.logger.debug("DescopeUI was loaded"),globalThis.DescopeUI}catch(e){throw this.logger.error(e),new Error("DescopeUI was not loaded")}},l})),Pi=di((e=>{var t,n,i;const r=ci(vi,mi)(e);return i=class extends r{constructor(){super(...arguments),t.add(this)}get nonce(){return this.getAttribute("nonce")||""}async init(){var e;await(null===(e=super.init)||void 0===e?void 0:e.call(this)),this.observeAttribute("nonce",o(this,t,"m",n).bind(this)),o(this,t,"m",n).call(this)}},t=new WeakSet,n=function(){window.DESCOPE_NONCE=this.nonce},i}));class Wi{constructor(e,t,{prepend:n=!1}={}){this.styleEle=document.createElement("style"),this.styleEle.setAttribute("nonce",t),this.ref=e,this.ref&&(n?this.ref.prepend(this.styleEle):this.ref.append(this.styleEle))}replaceSync(e){this.styleEle.textContent=e}get cssRules(){var e;return null===(e=this.styleEle.sheet)||void 0===e?void 0:e.cssRules}}const Ni=di((e=>{const t=ci(Pi)(e);return class extends t{injectStyle(e,{prepend:t=!1}={}){let n;try{n=new CSSStyleSheet}catch(e){n=new Wi(this.shadowRoot,this.nonce,{prepend:t})}if(e&&n.replaceSync(e),n instanceof CSSStyleSheet){const e=this.shadowRoot;if(e&&"adoptedStyleSheets"in e){const o=[...e.adoptedStyleSheets||[]];o[t?"unshift":"push"](n),e.adoptedStyleSheets=o}}return n}}})),Mi="content-root",_i="root",Di=di((e=>{const t=ci(Ni)(e);return class extends t{constructor(...e){var t,n;super(...e),this.attachShadow({mode:"open"}).innerHTML=`\n          <div id="${_i}">\n            <div id="${Mi}"></div>\n          </div>\n          `,this.injectStyle(`\n            #${_i}, #${Mi} {\n              height: 100%;\n            }\n            #${_i} {\n              position: relative;\n              height: fit-content;\n            }\n          `),this.contentRootElement=null===(t=this.shadowRoot)||void 0===t?void 0:t.getElementById(Mi),this.rootElement=null===(n=this.shadowRoot)||void 0===n?void 0:n.getElementById(_i)}}})),qi=(e,t)=>!!t&&"light"!==t&&"dark"!==t&&'Supported theme values are "light", "dark", or leave empty for using the OS theme',Fi=di((e=>{var t,n,r,s,a,l,c,d,u,h,p,g,f,v;const m=ci(bi({theme:qi}),Oi,vi,$i,xi,Di,mi,Ni)(e);return v=class extends m{constructor(){super(...arguments),t.add(this),n.set(this,void 0),r.set(this,void 0),p.set(this,(()=>{o(this,t,"m",g).call(this),o(this,f,"f").call(this,"os"===this.getAttribute("theme"))})),f.set(this,(e=>{var n,i,r;const s=e?"addEventListener":"removeEventListener";null===(r=null===(i=null===(n=window.matchMedia)||void 0===n?void 0:n.call(window,"(prefers-color-scheme: dark)"))||void 0===i?void 0:i[s])||void 0===r||r.call(i,"change",(()=>o(this,t,"m",g).call(this)))}))}get theme(){var e,t;const n=this.getAttribute("theme");if("os"===n){return window.matchMedia&&(null===(t=null===(e=window.matchMedia)||void 0===e?void 0:e.call(window,"(prefers-color-scheme: dark)"))||void 0===t?void 0:t.matches)?"dark":"light"}return n||"light"}get styleId(){return this.getAttribute("style-id")||"theme"}async init(){var e;await(null===(e=super.init)||void 0===e?void 0:e.call(this)),o(this,p,"f").call(this),await Promise.all([o(this,t,"m",l).call(this),o(this,t,"m",c).call(this)]),this.observeAttributes(["theme"],o(this,p,"f")),this.observeAttributes(["style-id"],(()=>{i(this,r,null,"f"),o(this,t,"m",u).call(this),o(this,t,"m",l).call(this),o(this,t,"m",c).call(this)}))}},n=new WeakMap,r=new WeakMap,p=new WeakMap,f=new WeakMap,t=new WeakSet,s=async function(){try{const{body:e}=await this.fetchStaticResource(`${this.styleId}.json`,"json");return e}catch(e){this.logger.error("Cannot fetch theme file","make sure that your projectId & flowId are correct")}},a=function(){return o(this,r,"f")||(i(this,r,o(this,t,"m",s).call(this),"f"),o(this,r,"f").then((e=>this.logger.debug("Fetched theme",e)))),o(this,r,"f")},l=async function(){var e,r;const s=await o(this,t,"a",a);s&&(o(this,n,"f")||i(this,n,this.injectStyle(""),"f"),o(this,n,"f").replaceSync(((null===(e=null==s?void 0:s.light)||void 0===e?void 0:e.globals)||"")+((null===(r=null==s?void 0:s.dark)||void 0===r?void 0:r.globals)||"")))},c=async function(){var e,n;const i=await o(this,t,"a",a);if(!i)return;const r=await this.descopeUi;(null==r?void 0:r.componentsThemeManager)&&(r.componentsThemeManager.themes={light:null===(e=null==i?void 0:i.light)||void 0===e?void 0:e.components,dark:null===(n=null==i?void 0:i.dark)||void 0===n?void 0:n.components})},d=async function(){var e,t;const{projectConfig:n}=await this.config||{},o=null===(e=null==n?void 0:n.styles)||void 0===e?void 0:e[this.styleId],i=null==n?void 0:n.cssTemplate,r=o||i;return null===(t=null==r?void 0:r[this.theme])||void 0===t?void 0:t.fonts},u=async function(){const e=await o(this,t,"m",d).call(this);e?Object.values(e).forEach((e=>{e.url&&(this.logger.debug(`Loading font from URL "${e.url}"`),(e=>{const t=document.createElement("link");t.href=e,t.rel="stylesheet",document.head.appendChild(t)})(e.url))})):this.logger.debug("No fonts to load")},h=async function(){this.rootElement.setAttribute("data-theme",this.theme);const e=await this.descopeUi;(null==e?void 0:e.componentsThemeManager)&&(e.componentsThemeManager.currentThemeName=this.theme)},g=function(){o(this,t,"m",u).call(this),o(this,t,"m",h).call(this)},v})),Ki=(e,t="")=>Object.keys(e).reduce(((n,o)=>{var i;if(Array.isArray(e[o]))return Object.assign(Object.assign({},n),{[o]:{value:e[o].map((e=>"object"==typeof e&&null!==e?Ki(e):e))}});if("object"==typeof e[o]&&null!==e[o]&&!(null===(i=e[o])||void 0===i?void 0:i.value))return Object.assign(Object.assign({},n),Ki(e[o],`${t+o}.`));const r="object"==typeof e[o]?e[o]:{value:e[o]},s=Object.assign(Object.assign({},n),{[t+o]:r,[`form.${t}${o}`]:r});return"displayName"===o?Object.assign(Object.assign({},s),{[`${t}fullName`]:r,[`form.${t}fullName`]:r}):s}),[]),Ji=di((e=>{var t,n,i,r;return r=class extends e{constructor(){super(...arguments),t.add(this)}connectedCallback(){var e;o(this,t,"m",n).call(this)&&o(this,t,"m",i).call(this),null===(e=super.connectedCallback)||void 0===e||e.call(this)}},t=new WeakSet,n=function(){return!this.shadowRoot.host.closest("form")&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)},i=function(){const e=this.shadowRoot.host,t=document.createElement("form");t.style.width="100%",t.style.height="100%",e.parentElement.appendChild(t),t.appendChild(e)},r}));var Vi,Hi,Bi,zi,Gi,Zi,Xi,Yi,Qi,er,tr,nr,or,ir,rr,sr,ar,lr,cr,dr,ur,hr;const pr=ci(Fi,Oi,Ji,Ni)(HTMLElement);class gr extends pr{static get observedAttributes(){return["project-id","flow-id","base-url","tenant","locale","debug","storage-prefix","preview","redirect-url","auto-focus","store-last-authenticated-user","refresh-cookie-name","keep-last-authenticated-user-after-logout","validate-on-blur","style-id"]}constructor(e){super(),Vi.add(this),Bi.set(this,!1),this.flowStatus="initial",this.loggerWrapper={error:(e,t="")=>{this.logger.error(e,t,new Error),o(this,Vi,"m",ur).call(this,e,t)},warn:(e,t="")=>{this.logger.warn(e,t)},info:(e,t="",n={})=>{this.logger.info(e,t,n)},debug:(e,t="")=>{this.logger.debug(e,t)}},zi.set(this,new Ho),Gi.set(this,new Ho),Zi.set(this,{}),this.getComponentsContext=()=>o(this,Zi,"f"),this.nextRequestStatus=new Ho({isLoading:!1}),Xi.set(this,void 0),Yi.set(this,{popstate:o(this,Vi,"m",or).bind(this),componentsContext:o(this,Vi,"m",lr).bind(this)}),Qi.set(this,void 0),this.getConfig=()=>n(this,void 0,void 0,(function*(){return(yield this.config)||{isMissingConfig:!0}})),i(this,Qi,e,"f"),o(this,Vi,"m",tr).call(this)}get flowId(){return this.getAttribute("flow-id")}get client(){try{return JSON.parse(this.getAttribute("client"))||{}}catch(e){return{}}}get tenantId(){return this.getAttribute("tenant")||void 0}get redirectUrl(){return this.getAttribute("redirect-url")||void 0}get debug(){return"true"===this.getAttribute("debug")}get locale(){return this.getAttribute("locale")||void 0}get autoFocus(){var e;const t=null!==(e=this.getAttribute("auto-focus"))&&void 0!==e?e:"true";return"skipFirstScreen"===t?t:"true"===t}get validateOnBlur(){return"true"===this.getAttribute("validate-on-blur")}get storeLastAuthenticatedUser(){var e;return"true"===(null!==(e=this.getAttribute("store-last-authenticated-user"))&&void 0!==e?e:"true")}get refreshCookieName(){return this.getAttribute("refresh-cookie-name")||""}get keepLastAuthenticatedUserAfterLogout(){return"true"===this.getAttribute("keep-last-authenticated-user-after-logout")}get storagePrefix(){return this.getAttribute("storage-prefix")||""}get preview(){return!!this.getAttribute("preview")}get formConfig(){return(e=>{try{return Ki(JSON.parse(e))}catch(e){return{}}})(this.form)}get form(){return this.getAttribute("form")}get formConfigValues(){return e=this.formConfig,t="value",Object.fromEntries(Object.entries(e).map((([e,n])=>[e,n[t]])));var e,t}get outboundAppId(){return this.getAttribute("outbound-app-id")}get outboundAppScopes(){try{const e=JSON.parse(this.getAttribute("outbound-app-scopes"));return e||null}catch(e){return null}}get isRestartOnError(){return"true"===this.getAttribute("restart-on-error")}getExecutionContext(){return n(this,void 0,void 0,(function*(){const e=yield this.getConfig();return"executionContext"in e?e.executionContext:void 0}))}getProjectConfig(){return n(this,void 0,void 0,(function*(){const e=yield this.getConfig();return"projectConfig"in e?e.projectConfig:void 0}))}getFlowConfig(){return n(this,void 0,void 0,(function*(){var e,t;const n=yield this.getProjectConfig(),o=(null===(e=null==n?void 0:n.flows)||void 0===e?void 0:e[this.flowId])||{};return null!==(t=o.version)&&void 0!==t||(o.version=0),o}))}getTargetLocales(){return n(this,void 0,void 0,(function*(){const e=yield this.getFlowConfig();return((null==e?void 0:e.targetLocales)||[]).map((e=>e.toLowerCase()))}))}getComponentsVersion(){return n(this,void 0,void 0,(function*(){var e;const t=yield this.getConfig(),n="projectConfig"in t?null===(e=t.projectConfig)||void 0===e?void 0:e.componentsVersion:{};return n||(this.logger.error("Did not get components version, using latest version"),"latest")}))}init(){const e=Object.create(null,{init:{get:()=>super.init}});return n(this,void 0,void 0,(function*(){var t;if(this.flowStatus="loading",["ready","error","success"].forEach((e=>this.addEventListener(e,(()=>{this.flowStatus=e})))),yield null===(t=e.init)||void 0===t?void 0:t.call(this),o(this,Gi,"f").subscribe(o(this,Vi,"m",dr).bind(this)),o(this,Gi,"f").update({isDebug:this.debug}),o(this,Vi,"m",nr).call(this),yield o(this,Vi,"m",sr).call(this))return void this.loggerWrapper.error("This SDK version does not support your flows version","Make sure to upgrade your flows to the latest version or use an older SDK version");const n=yield this.getConfig();if("isMissingConfig"in n&&n.isMissingConfig)return void this.loggerWrapper.error("Cannot get config file","Make sure that your projectId & flowId are correct");o(this,Vi,"m",hr).call(this);const{executionId:r,stepId:s,token:a,code:l,isPopup:c,exchangeError:d,redirectAuthCallbackUrl:u,redirectAuthBackupCallbackUri:h,redirectAuthCodeChallenge:p,redirectAuthInitiator:g,ssoQueryParams:f}=Eo(this.flowId,this.loggerWrapper);window.addEventListener("popstate",o(this,Yi,"f").popstate),window.addEventListener("components-context",o(this,Yi,"f").componentsContext),o(this,zi,"f").subscribe(o(this,Vi,"m",rr).bind(this)),o(this,zi,"f").update(Object.assign({projectId:this.projectId,flowId:this.flowId,baseUrl:this.baseUrl,tenant:this.tenantId,redirectUrl:this.redirectUrl,locale:this.locale,stepId:s,executionId:r,token:a,code:l,isPopup:c,exchangeError:d,redirectAuthCallbackUrl:u,redirectAuthBackupCallbackUri:h,redirectAuthCodeChallenge:p,redirectAuthInitiator:g},f)),i(this,Bi,!0,"f")}))}disconnectedCallback(){o(this,zi,"f").unsubscribeAll(),o(this,Gi,"f").unsubscribeAll(),o(this,Vi,"m",cr).call(this),window.removeEventListener("popstate",o(this,Yi,"f").popstate),window.removeEventListener("components-context",o(this,Yi,"f").componentsContext)}attributeChangedCallback(e,t,n){if(this.shadowRoot.isConnected&&o(this,Bi,"f")&&t!==n&&Hi.observedAttributes.includes(e)){o(this,Vi,"m",nr).call(this);const i=null===t;o(this,zi,"f").update((({stepId:t,executionId:o})=>{let r=t,s=o;return i||(s=null,r=null,Ao()),{[jo(e)]:n,stepId:r,executionId:s}})),o(this,Gi,"f").update({isDebug:this.debug})}}}var fr,vr,mr,br,wr,yr,kr,Ir,Sr,Or,Cr,xr,Ar,jr,Er,Ur,Rr,Tr,Lr,$r,Pr,Wr,Nr,Mr,_r,Dr,qr,Fr,Kr,Jr,Vr,Hr,Br,zr,Gr,Zr,Xr,Yr,Qr,es,ts,ns,os,is,rs,ss;Hi=gr,Bi=new WeakMap,zi=new WeakMap,Gi=new WeakMap,Zi=new WeakMap,Xi=new WeakMap,Yi=new WeakMap,Qi=new WeakMap,Vi=new WeakSet,er=function(){this.injectStyle("\n    :host {\n\t\t\twidth: 100%;\n      display: block;\n\t\t}\n\n\t\t#root {\n\t\t\theight: 100%;\n      display: flex;\n      flex-direction: column;\n\t\t}\n\n    #content-root {\n      all: initial;\n      transition: opacity 200ms ease-in-out;\n    }\n\n\t\t#root[data-theme] {\n\t\t\tbackground-color: transparent;\n\t\t}\n\n\t\t.fade-out {\n\t\t\topacity: 0.1!important;\n\t\t}\n\n    .hidden {\n      display: none;\n    }\n    ")},tr=function(){o(this,Vi,"m",er).call(this),this.slotElement=document.createElement("slot"),this.slotElement.classList.add("hidden"),this.rootElement.appendChild(this.slotElement)},nr=function(){const e=["base-url","tenant","locale","debug","redirect-url","auto-focus","store-last-authenticated-user","refresh-cookie-name","keep-last-authenticated-user-after-logout","preview","storage-prefix","form","client","validate-on-blur","style-id","outbound-app-id","outbound-app-scopes"];Hi.observedAttributes.forEach((t=>{if(!e.includes(t)&&!this[jo(t)])throw Error(`${t} cannot be empty`)}))},or=function(){const{stepId:e,executionId:t}=xo(this.flowId);o(this,zi,"f").update({stepId:e,executionId:t})},ir=function(e,t){this.sdk=_n(Object.assign(Object.assign({persistTokens:!0,preview:this.preview,storagePrefix:this.storagePrefix,storeLastAuthenticatedUser:this.storeLastAuthenticatedUser,keepLastAuthenticatedUserAfterLogout:this.keepLastAuthenticatedUserAfterLogout,refreshCookieName:this.refreshCookieName},Hi.sdkConfigOverrides),{projectId:e,baseUrl:t})),["start","next"].forEach((e=>{const t=this.sdk.flow[e];this.sdk.flow[e]=(...e)=>n(this,void 0,void 0,(function*(){try{return yield t(...e)}catch(e){return{error:{errorCode:qn,errorDescription:e.toString()}}}}))}))},rr=function(e,t,i){return n(this,void 0,void 0,(function*(){const{projectId:t,baseUrl:n}=e;if(i("projectId")||i("baseUrl")){if(!t)return;o(this,Vi,"m",ir).call(this,t,n)}o(this,Qi,"f").call(this,e)}))},sr=function(){return n(this,void 0,void 0,(function*(){const e=yield this.getConfig();return"isMissingConfig"in e&&e.isMissingConfig&&(yield o(this,Vi,"m",ar).call(this))}))},ar=function(){return n(this,void 0,void 0,(function*(){const e=function({projectId:e,filename:t,assetsFolder:n="v2-beta",baseUrl:o}){const i=new URL(Kn||o||"https://static.descope.com/pages");return i.pathname=((...e)=>e.join("/").replace(/\/+/g,"/"))(i.pathname,e,n,t),i.toString()}({projectId:this.projectId,filename:"config.json",assetsFolder:"v2-alpha",baseUrl:this.baseStaticUrl});try{return yield function(e,t){return n(this,void 0,void 0,(function*(){const n=yield fetch(e,{cache:"default"});if(!n.ok)throw Error(`Error fetching URL ${e} [${n.status}]`);return{body:yield n[t](),headers:Object.fromEntries(n.headers.entries())}}))}(e,"json"),!0}catch(e){return!1}}))},lr=function(e){i(this,Zi,Object.assign(Object.assign({},o(this,Zi,"f")),e.detail),"f")},cr=function(){var e;null===(e=o(this,Xi,"f"))||void 0===e||e.remove(),i(this,Xi,null,"f")},dr=function(e){return n(this,arguments,void 0,(function*({isDebug:e}){e?(i(this,Xi,document.createElement("descope-debugger"),"f"),Object.assign(o(this,Xi,"f").style,{position:"fixed",top:"0",right:"0",height:"100vh",width:"100vw",pointerEvents:"none",zIndex:99999}),yield Promise.resolve().then((function(){return us})),document.body.appendChild(o(this,Xi,"f"))):o(this,Vi,"m",cr).call(this)}))},ur=function(e,t){var n;e&&this.debug&&(null===(n=o(this,Xi,"f"))||void 0===n||n.updateData({title:e,description:t}))},hr=function(){this.rootElement.onkeydown=e=>{var t,n,o;const i=!!(null===(t=this.shadowRoot.activeElement)||void 0===t?void 0:t.getAttribute("href")),r=wo.includes(null!==(o=null===(n=this.shadowRoot.activeElement)||void 0===n?void 0:n.localName)&&void 0!==o?o:"");if("Enter"!==e.key||i||r)return;e.preventDefault();const s=this.rootElement.querySelectorAll("descope-button");if(1===s.length&&"false"!==s[0].getAttribute("auto-submit"))return void s[0].click();const a=Array.from(s).filter((e=>"true"===e.getAttribute("auto-submit")));if(1===a.length)return void a[0].click();const l=Array.from(s).filter((e=>"button"===e.getAttribute("data-type")));if(1===l.length)"false"!==l[0].getAttribute("auto-submit")&&l[0].click();else if(0===l.length){const e=Array.from(s).filter((e=>"sso"===e.getAttribute("data-type")));1===e.length&&"false"!==e[0].getAttribute("auto-submit")&&e[0].click()}}},gr.sdkConfigOverrides={baseHeaders:{"x-descope-sdk-name":"web-component","x-descope-sdk-version":"3.47.1"}};class as extends gr{static set sdkConfigOverrides(e){gr.sdkConfigOverrides=e}static get sdkConfigOverrides(){return gr.sdkConfigOverrides}constructor(){const e=new Ho({deferredRedirect:!1});super(e.update.bind(e)),fr.add(this),this.stepState=new Ho({}),vr.set(this,void 0),mr.set(this,null),br.set(this,null),wr.set(this,{visibilitychange:o(this,fr,"m",yr).bind(this)}),this.bridgeVersion=2,this.nativeCallbacks={},jr.set(this,!1),this.handleRedirect=e=>{window.location.assign(e)},Ur.set(this,(e=>{const t=()=>{this.contentRootElement.classList.toggle("hidden",e),this.slotElement.classList.toggle("hidden",!e),e&&(this.contentRootElement.innerHTML="")};e&&this.contentRootElement.hasChildNodes()?o(this,fr,"m",Rr).call(this,t):t()})),Tr.set(this,((e,t,r,s,a=!1)=>{const l=[Fn,"E103202"];if(this.flowState.current.action===ho){this.logger.debug("polling - Scheduling polling request");const c=Date.now(),d=a?500:2e3;i(this,vr,setTimeout((()=>n(this,void 0,void 0,(function*(){var n,i;this.logger.debug("polling - Calling next");const u=this.sdk.flow.next(e,t,bo,r,s,{}),h=document.hidden&&!a&&Date.now()-c>d+500;let p;h&&this.logger.debug("polling - The polling seems to be throttled");try{const e=h?1e3:6e3;p=yield To(e,u)}catch(n){return this.logger.warn(`polling - The ${h?"throttled fetch":"fetch"} call timed out or was aborted`),void o(this,Tr,"f").call(this,e,t,r,s,h)}if((null===(n=null==p?void 0:p.error)||void 0===n?void 0:n.errorCode)===qn)return this.logger.debug("polling - Got a generic error due to exception in fetch call"),void o(this,Tr,"f").call(this,e,t,r,s);this.logger.debug("polling - Got a response"),(null==p?void 0:p.error)&&this.logger.debug("polling - Response has an error",JSON.stringify(p.error,null,4)),(null===(i=null==p?void 0:p.error)||void 0===i?void 0:i.errorCode)&&l.includes(p.error.errorCode)?this.logger.debug("polling - Stopping polling due to error"):o(this,Tr,"f").call(this,e,t,r,s),o(this,$r,"f").call(this,p)}))),d),"f")}})),Lr.set(this,(()=>{clearTimeout(o(this,vr,"f")),i(this,vr,null,"f")})),$r.set(this,(e=>{var t,n,r,s,a,l,c,d,u,h,p,g,f;if(!(null==e?void 0:e.ok)){const i=null===(t=null==e?void 0:e.response)||void 0===t?void 0:t.url,c=`${null===(n=null==e?void 0:e.response)||void 0===n?void 0:n.status} - ${null===(r=null==e?void 0:e.response)||void 0===r?void 0:r.statusText}`;o(this,fr,"m",Gr).call(this,"error",(null==e?void 0:e.error)||{errorCode:"J151001",errorDescription:c,errorMessage:i}),this.loggerWrapper.error((null===(s=null==e?void 0:e.error)||void 0===s?void 0:s.errorDescription)||i,(null===(a=null==e?void 0:e.error)||void 0===a?void 0:a.errorMessage)||c);const d=null===(l=null==e?void 0:e.error)||void 0===l?void 0:l.errorCode;return void("E102004"!==d&&d!==Fn||!this.isRestartOnError||o(this,fr,"m",Ar).call(this))}null===(d=null===(c=e.data)||void 0===c?void 0:c.runnerLogs)||void 0===d||d.forEach((e=>{const{level:t,title:n,log:o}=e;t&&this.loggerWrapper[t]?this.loggerWrapper[t](n,o):this.loggerWrapper.info(n,o)}));const v=null===(p=null===(h=null===(u=e.data)||void 0===u?void 0:u.screen)||void 0===h?void 0:h.state)||void 0===p?void 0:p.errorText;(null===(g=e.data)||void 0===g?void 0:g.error)?this.loggerWrapper.error(`[${e.data.error.code}]: ${e.data.error.description}`,`${v?`${v} - `:""}${e.data.error.message}`):v&&this.loggerWrapper.error(v);const{status:m,authInfo:b,lastAuth:w,action:y,openInNewTabUrl:k}=e.data;if(y!==ho&&o(this,Lr,"f").call(this),"completed"===m)return this.storeLastAuthenticatedUser&&li(w),void o(this,fr,"m",Gr).call(this,"success",b);this.storeLastAuthenticatedUser&&li(w,!0),k&&window.open(k,"_blank");const{executionId:I,stepId:S,stepName:O,screen:C,redirect:x,webauthn:A,error:j,samlIdpResponse:E,nativeResponse:U}=e.data,R=Date.now();y!==ho?(this.loggerWrapper.info(`Step "${O||`#${S}`}" is ${m}`,"",{screen:C,status:m,stepId:S,stepName:O,action:y,error:j}),(null===(f=C.state)||void 0===f?void 0:f.clientScripts)&&i(this,br,this.loadSdkScripts(C.state.clientScripts),"f"),this.flowState.update({stepId:S,stepName:O,executionId:I,action:y,redirectTo:null==x?void 0:x.url,redirectIsPopup:null==x?void 0:x.isPopup,screenId:null==C?void 0:C.id,screenState:null==C?void 0:C.state,webauthnTransactionId:null==A?void 0:A.transactionId,webauthnOptions:null==A?void 0:A.options,samlIdpResponseUrl:null==E?void 0:E.url,samlIdpResponseSamlResponse:null==E?void 0:E.samlResponse,samlIdpResponseRelayState:null==E?void 0:E.relayState,nativeResponseType:null==U?void 0:U.type,nativePayload:null==U?void 0:U.payload,reqTimestamp:R})):this.flowState.update({action:y,reqTimestamp:R})})),Pr.set(this,Uo((()=>n(this,void 0,void 0,(function*(){var e;try{const t=yield this.sdk.webauthn.signIn.start("",window.location.origin);return t.ok||this.loggerWrapper.warn("Webauthn start failed",null===(e=null==t?void 0:t.error)||void 0===e?void 0:e.errorMessage),t.data}catch(e){this.loggerWrapper.warn("Webauthn start failed",e.message)}}))))),qr.set(this,null),Hr.set(this,Wo(((e,t)=>n(this,void 0,void 0,(function*(){var n,i;if("true"===e.getAttribute("formnovalidate")||o(this,fr,"m",_r).call(this)){const r=null==e?void 0:e.getAttribute("id");o(this,fr,"m",Fr).call(this,e);const s=yield o(this,fr,"m",Dr).call(this),a=(i=e,Array.from((null==i?void 0:i.attributes)||[]).reduce(((e,t)=>{var n;const o=null===(n=new RegExp("^data-descope-(\\S+)$").exec(t.name))||void 0===n?void 0:n[1];return o?Object.assign(e,{[o]:t.value}):e}),{}));if(this.nextRequestStatus.update({isLoading:!0}),o(this,br,"f")){this.loggerWrapper.debug("Waiting for sdk scripts to load");const e=Date.now();yield o(this,br,"f"),this.loggerWrapper.debug("Sdk scripts loaded for",(Date.now()-e).toString())}const l=this.loadSdkScriptsModules();if(l.length>0){const e=l.filter((e=>"function"==typeof e.refresh)).map((e=>e.refresh()));e.length>0&&(yield To(5e3,Promise.all(e),null))}const c=this.getComponentsContext(),d=Object.assign(Object.assign(Object.assign(Object.assign({},c),a),s),{origin:(null===(n=this.nativeOptions)||void 0===n?void 0:n.origin)||window.location.origin});yield t(r,d),this.nextRequestStatus.update({isLoading:!1}),o(this,fr,"m",Kr).call(this,s)}}))))),this.flowState=e}nativeResume(e,t){var n,i,r,s,a;const l=JSON.parse(t);if("oauthWeb"===e||"sso"===e){let{exchangeCode:e}=l;if(!e){e=null===(n=new URL(l.url).searchParams)||void 0===n?void 0:n.get(Hn)}null===(r=(i=this.nativeCallbacks).complete)||void 0===r||r.call(i,{exchangeCode:e,idpInitiated:!0})}else if("magicLink"===e){const e=new URL(l.url),t=e.searchParams.get("t"),n=e.searchParams.get(Vn).split("_").pop();o(this,Lr,"f").call(this),this.flowState.update({token:t,stepId:n,action:void 0})}else if("beforeScreen"===e){const{screenResolve:e}=this.nativeCallbacks;this.nativeCallbacks.screenResolve=null;const{override:t}=l;t||(this.nativeCallbacks.screenNext=null),null==e||e(t)}else if("resumeScreen"===e){const{interactionId:e,form:t}=l,{screenNext:n}=this.nativeCallbacks;this.nativeCallbacks.screenNext=null,null==n||n(e,t)}else null===(a=(s=this.nativeCallbacks).complete)||void 0===a||a.call(s,l)}loadSdkScriptsModules(){const e=this.shadowRoot.querySelectorAll("div[data-script-id]");return Array.from(e).map((e=>e.moduleRes)).filter((e=>!!e))}loadSdkScripts(e){if(!(null==e?void 0:e.length))return null;const t=(e,t)=>n=>{this.dispatchEvent(new CustomEvent("components-context",{detail:{[Do(e.id,e.resultKey)]:n},bubbles:!0,composed:!0})),t(e.id)};this.loggerWrapper.debug(`Preparing to load scripts: ${e.map((e=>e.id)).join(", ")}`);const o=Promise.all(null==e?void 0:e.map((e=>n(this,void 0,void 0,(function*(){var n,o;const i=this.shadowRoot.querySelector(`[data-script-id="${e.id}"]`);if(i){this.loggerWrapper.debug("Script already loaded",e.id);const{moduleRes:t}=i;return null===(n=null==t?void 0:t.start)||void 0===n||n.call(t),t}yield this.injectNpmLib("@descope/flow-scripts","1.0.11",`dist/${e.id}.js`);const r=null===(o=globalThis.descope)||void 0===o?void 0:o[e.id];return new Promise(((n,o)=>{try{const o=r(e.initArgs,{baseUrl:this.baseUrl,ref:this},t(e,n));if(o){const t=document.createElement("div");t.setAttribute("data-script-id",e.id),t.moduleRes=o,this.shadowRoot.appendChild(t),this.nextRequestStatus.subscribe((()=>{var t;this.loggerWrapper.debug("Unloading script",e.id),null===(t=o.stop)||void 0===t||t.call(o)}))}}catch(e){o(e)}}))}))))),i=new Promise((e=>{setTimeout((()=>{this.loggerWrapper.warn("SDK scripts loading timeout"),e(!0)}),5e3)}));return Promise.race([o,i])}get isDismissScreenErrorOnInput(){return"true"===this.getAttribute("dismiss-screen-error-on-input")}init(){if(!window.descopeBridge)return this._init();this.lazyInit=this._init}_init(){const e=Object.create(null,{init:{get:()=>super.init}});return n(this,void 0,void 0,(function*(){var t,n;this.shadowRoot.isConnected&&(null===(t=this.flowState)||void 0===t||t.subscribe(this.onFlowChange.bind(this)),o(this,fr,"m",Cr).call(this),window.addEventListener("visibilitychange",o(this,wr,"f").visibilitychange)),yield null===(n=e.init)||void 0===n?void 0:n.call(this)}))}disconnectedCallback(){var e;super.disconnectedCallback(),this.flowState.unsubscribeAll(),this.stepState.unsubscribeAll(),null===(e=o(this,mr,"f"))||void 0===e||e.abort(),i(this,mr,null,"f"),window.removeEventListener("visibilitychange",o(this,wr,"f").visibilitychange)}getHtmlFilenameWithLocale(e,t){return n(this,void 0,void 0,(function*(){let n;const o=No(e),i=yield this.getTargetLocales();return i.includes(o.locale)?n=`${t}-${o.locale}.html`:i.includes(o.fallback)&&(n=`${t}-${o.fallback}.html`),n}))}getPageContent(e,t){return n(this,void 0,void 0,(function*(){if(t)try{const{body:e}=yield this.fetchStaticResource(t,"text");return e}catch(n){this.loggerWrapper.error(`Failed to fetch flow page from ${t}. Fallback to url ${e}`,n)}try{const{body:t}=yield this.fetchStaticResource(e,"text");return t}catch(e){this.loggerWrapper.error("Failed to fetch flow page",e.message)}return null}))}onFlowChange(e,r,s){return n(this,void 0,void 0,(function*(){var a,l;const{projectId:c,flowId:d,tenant:u,stepId:h,executionId:p,action:g,screenId:f,screenState:v,redirectTo:m,redirectIsPopup:b,redirectUrl:w,token:y,code:k,isPopup:I,exchangeError:S,webauthnTransactionId:O,webauthnOptions:C,redirectAuthCodeChallenge:x,redirectAuthCallbackUrl:A,redirectAuthBackupCallbackUri:j,redirectAuthInitiator:E,locale:U,samlIdpResponseUrl:R,samlIdpResponseSamlResponse:T,samlIdpResponseRelayState:L,nativeResponseType:$,nativePayload:P,reqTimestamp:W}=e,N=t(e,["projectId","flowId","tenant","stepId","executionId","action","screenId","screenState","redirectTo","redirectIsPopup","redirectUrl","token","code","isPopup","exchangeError","webauthnTransactionId","webauthnOptions","redirectAuthCodeChallenge","redirectAuthCallbackUrl","redirectAuthBackupCallbackUri","redirectAuthInitiator","locale","samlIdpResponseUrl","samlIdpResponseSamlResponse","samlIdpResponseRelayState","nativeResponseType","nativePayload","reqTimestamp"]);let M,_,D;const q=(()=>{const e=localStorage.getItem(ri);if(!e){const e=Math.floor(100*Math.random()+1);return localStorage.setItem(ri,e.toString()),e}return Number(e)})(),{outboundAppId:F}=this,{outboundAppScopes:K}=this,J=this.sdk.getLastUserLoginId(),V=yield this.getFlowConfig(),H=yield this.getProjectConfig(),B=Object.entries(H.flows||{}).reduce(((e,[t,n])=>(e[t]=n.version,e)),{}),z=A&&x?{callbackUrl:A,codeChallenge:x,backupCallbackUri:j}:void 0,G=this.nativeOptions?{platform:this.nativeOptions.platform,bridgeVersion:this.nativeOptions.bridgeVersion,oauthProvider:this.nativeOptions.oauthProvider,oauthRedirect:this.nativeOptions.oauthRedirect,magicLinkRedirect:this.nativeOptions.magicLinkRedirect,ssoRedirect:this.nativeOptions.ssoRedirect}:void 0;let Z={};if(!p){const e=[...V.clientScripts||[],...V.sdkScripts||[]];if(V.conditions){let t=[];({startScreenId:M,conditionInteractionId:D,startScreenName:_,clientScripts:t,componentsConfig:Z}=((e,t)=>{const n=null==t?void 0:t.find((({key:t,operator:n,predicate:o})=>{var i;if("ELSE"===t)return!0;const r=null===(i=si[t])||void 0===i?void 0:i[n];return!!(null==r?void 0:r(e,o))}));return n?{startScreenId:n.met.screenId,startScreenName:n.met.screenName,conditionInteractionId:n.met.interactionId,clientScripts:n.met.clientScripts,componentsConfig:n.met.componentsConfig}:{}})({loginId:J,code:k,token:y,abTestingKey:q,lastAuth:ai(J)},V.conditions)),e.push(...t||[])}else V.condition?({startScreenId:M,conditionInteractionId:D}=((e,t)=>{var n;const o=null===(n=si[null==e?void 0:e.key])||void 0===n?void 0:n[e.operator];if(!o)return{};const i=o(t,e.predicate)?e.met:e.unmet;return{startScreenId:null==i?void 0:i.screenId,startScreenName:null==i?void 0:i.screenName,conditionInteractionId:null==i?void 0:i.interactionId}})(V.condition,{loginId:J,code:k,token:y,abTestingKey:q,lastAuth:ai(J)})):(_=V.startScreenName,M=V.startScreenId);if(i(this,br,this.loadSdkScripts(e),"f"),V.fingerprintEnabled&&V.fingerprintKey?yield sn(V.fingerprintKey,this.baseUrl):localStorage.removeItem(on),!Lo(M,N)){const e=yield this.sdk.flow.start(d,Object.assign(Object.assign(Object.assign(Object.assign({tenant:u,redirectAuth:z},N),{client:this.client}),w&&{redirectUrl:w}),{lastAuth:ai(J),abTestingKey:q,locale:No(U).locale,nativeOptions:G,outboundAppId:F,outboundAppScopes:K}),D,"",H.componentsVersion,B,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},this.formConfigValues),k?{exchangeCode:k,idpInitiated:!0}:{}),N.descopeIdpInitiated&&{idpInitiated:!0}),y?{token:y}:{}),N.oidcLoginHint?{externalId:N.oidcLoginHint}:{}));return o(this,$r,"f").call(this,e),void("completed"!==(null===(a=null==e?void 0:e.data)||void 0===a?void 0:a.status)&&this.flowState.update({code:void 0,token:void 0}))}}if(this.loggerWrapper.debug("Before popup postmessage send",JSON.stringify({isPopup:I,code:k,exchangeError:S,isCodeChanged:s("code"),isExchangeErrorChanged:s("exchangeError")})),I&&(s("code")&&k||s("exchangeError")&&S)){this.loggerWrapper.debug("Creating popup channel",p);const e=new BroadcastChannel(p);return this.loggerWrapper.debug("Posting message to popup channel",JSON.stringify({code:k,exchangeError:S})),e.postMessage({data:{code:k,exchangeError:S},action:"code"}),this.loggerWrapper.debug("Popup channel message posted, closing channel"),e.close(),this.loggerWrapper.debug("Popup channel closed, closing window"),void window.close()}if(p&&(s("token")&&y||s("code")&&k||s("exchangeError")&&S)){const e=yield this.sdk.flow.next(p,h,mo,V.version,H.componentsVersion,{token:y,exchangeCode:k,exchangeError:S});return o(this,$r,"f").call(this,e),void this.flowState.update({token:void 0,code:void 0,exchangeError:void 0})}if(g===vo&&["samlIdpResponseUrl","samlIdpResponseSamlResponse","samlIdpResponseRelayState"].some((e=>s(e)))){if(!R||!T)return void this.loggerWrapper.error("Did not get saml idp params data to load");((e,t,n,o)=>{const i=document.createElement("form");i.method="POST",i.action=e,i.innerHTML=`\n  <input type="hidden" role="saml-response" name="SAMLResponse" value="${t}" />\n  <input type="hidden" role="saml-relay-state" name="RelayState" value="${n}" />\n  <input style="display: none;" id="SAMLSubmitButton" type="submit" value="Continue" />\n  `,document.body.appendChild(i),o(i)})(R,T,L||"",$o)}if(g===uo&&(s("redirectTo")||s("deferredRedirect"))){if(!m)return void this.loggerWrapper.error("Did not get redirect url");if("android"===E&&document.hidden)return void this.flowState.update({deferredRedirect:!0});if(this.loggerWrapper.debug(`Redirect is popup ${b}`),b){this.loggerWrapper.debug("Opening redirect in popup");const e=((e,t,n,o)=>{const i=void 0!==window.screenLeft?window.screenLeft:window.screen.left,r=void 0!==window.screenTop?window.screenTop:window.screen.top,s=((window.innerWidth||document.documentElement.clientWidth||window.screen.width)-n)/2+i,a=((window.innerHeight||document.documentElement.clientHeight||window.screen.height)-o)/2+r,l=window.open(e,t,`width=${n},height=${o},top=${a},left=${s},scrollbars=yes,resizable=yes`);return l.focus(),l})(m,"?",598,700);this.loggerWrapper.debug("Creating broadcast channel");const t=new BroadcastChannel(p);this.loggerWrapper.debug("Starting popup closed detection");const n=setInterval((()=>{e.closed&&(this.loggerWrapper.debug("Popup closed, dispatching popupclosed event and clearing interval"),clearInterval(n),o(this,fr,"m",Gr).call(this,"popupclosed",{}),this.loggerWrapper.debug("Closing channel"),t.close())}),1e3);this.loggerWrapper.debug("Listening for postMessage on channel");const i=e=>{if(this.loggerWrapper.debug("Received postMessage on channel",JSON.stringify(e)),this.loggerWrapper.debug("Comparing origins",JSON.stringify({eventOrigin:e.origin,windowLocationOrigin:window.location.origin})),e.origin!==window.location.origin)return;this.loggerWrapper.debug("PostMessage origin matches, processing message");const{action:t,data:n}=e.data;this.loggerWrapper.debug(`PostMessage action: ${t}, data: ${JSON.stringify(n)}`),"code"===t&&(this.loggerWrapper.debug("Updating flow state with code and exchangeError"),this.flowState.update({code:n.code,exchangeError:n.exchangeError}))};t.onmessage=i}else this.handleRedirect(m);return}if(g===po||g===go){if(!O||!C)return void this.loggerWrapper.error("Did not get webauthn transaction id or options");let e,t;null===(l=o(this,mr,"f"))||void 0===l||l.abort(),i(this,mr,null,"f");try{e=g===po?yield this.sdk.webauthn.helpers.create(C):yield this.sdk.webauthn.helpers.get(C)}catch(e){"InvalidStateError"===e.name?this.loggerWrapper.warn("WebAuthn operation failed",e.message):"NotAllowedError"!==e.name&&this.loggerWrapper.error(e.message),t=e.name}const n=yield this.sdk.flow.next(p,h,mo,V.version,H.componentsVersion,{transactionId:O,response:e,failure:t});o(this,$r,"f").call(this,n)}if(g===fo)return this.nativeCallbacks.complete=e=>n(this,void 0,void 0,(function*(){const t=yield this.sdk.flow.next(p,h,mo,V.version,H.componentsVersion,e);o(this,$r,"f").call(this,t)})),void o(this,fr,"m",Sr).call(this,$,P);if(s("action")&&o(this,Tr,"f").call(this,p,h,V.version,H.componentsVersion),!f&&!M)return void this.loggerWrapper.warn("No screen was found to show");const X=M||f,Y=yield this.getHtmlFilenameWithLocale(U,X),{oidcLoginHint:Q,oidcPrompt:ee,oidcErrorRedirectUri:te,oidcResource:ne,samlIdpUsername:oe}=N,ie={direction:Co(h,r.stepId),screenState:Object.assign(Object.assign({},v),{form:Object.assign(Object.assign({},this.formConfigValues),null==v?void 0:v.form),lastAuth:{loginId:J,name:this.sdk.getLastUserDisplayName()||J},componentsConfig:Object.assign(Object.assign(Object.assign({},V.componentsConfig),Z),null==v?void 0:v.componentsConfig)}),htmlFilename:`${X}.html`,htmlLocaleFilename:Y,screenId:X,stepName:e.stepName||_,samlIdpUsername:oe,oidcLoginHint:Q,oidcPrompt:ee,oidcErrorRedirectUri:te,oidcResource:ne,action:g},re=ai(J);Lo(M,N)?ie.next=(e,t)=>n(this,void 0,void 0,(function*(){const n=yield this.sdk.flow.start(d,Object.assign(Object.assign(Object.assign(Object.assign({tenant:u,redirectAuth:z},N),{lastAuth:re,preview:this.preview,abTestingKey:q,client:this.client}),w&&{redirectUrl:w}),{locale:No(U).locale,nativeOptions:G,outboundAppId:F,outboundAppScopes:K}),D,e,H.componentsVersion,B,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},this.formConfigValues),_o(t)),k&&{exchangeCode:k,idpInitiated:!0}),N.descopeIdpInitiated&&{idpInitiated:!0}),y&&{token:y}));return o(this,$r,"f").call(this,n),n})):(s("projectId")||s("baseUrl")||s("executionId")||s("stepId"))&&(ie.next=(e,t)=>n(this,void 0,void 0,(function*(){const n=yield this.sdk.flow.next(p,h,e,V.version,H.componentsVersion,_o(t));return o(this,$r,"f").call(this,n),n}))),this.loggerWrapper.debug("Got a screen with id",ie.screenId),yield o(this,fr,"m",Er).call(this,ie),this.stepState.update(ie)}))}onStepChange(e,t){return n(this,void 0,void 0,(function*(){var i,r;const{htmlFilename:s,htmlLocaleFilename:a,direction:l,next:c,screenState:d}=e;this.loggerWrapper.debug("Rendering a flow screen");const u=document.createElement("template");u.innerHTML=yield this.getPageContent(s,a);const h=u.content.cloneNode(!0),p=this.loadDescopeUiComponents(u);this.sdk.webauthn.helpers.isSupported()?yield o(this,fr,"m",Nr).call(this,h,c):h.querySelectorAll(`descope-button[${co}="biometrics"]`).forEach((e=>e.setAttribute("disabled","true"))),!e.samlIdpUsername||(null===(i=d.form)||void 0===i?void 0:i.loginId)||(null===(r=d.form)||void 0===r?void 0:r.email)||(d.form||(d.form={}),d.form.loginId=e.samlIdpUsername,d.form.email=e.samlIdpUsername),ni(h,d,d.componentsConfig,this.formConfig,this.loggerWrapper);const{geo:g}=yield this.getExecutionContext();((e,t)=>{Array.from(e.querySelectorAll('[default-code="autoDetect"]')).forEach((e=>{e.setAttribute("default-code",t)}))})(h,g);const f=()=>n(this,void 0,void 0,(function*(){var n,i;yield p;const r=this.contentRootElement;var s,a;s=r,a=null===(n=null==d?void 0:d.totp)||void 0===n?void 0:n.image,ti(s,"descope-totp-image",a),((e,t)=>{ti(e,"descope-notp-image",t)})(r,null===(i=null==d?void 0:d.notp)||void 0===i?void 0:i.image),((e,t,n,o)=>{n&&Object.keys(n).forEach((i=>{t.querySelector(i)||o.debug(`Skipping css vars for component "${i}}"`,`Got css vars for component ${i} but Could not find it on next page`);const r=customElements.get(i);r?Object.keys(n[i]).forEach((t=>{var s;const a=n[i],l=null===(s=null==r?void 0:r.cssVarList)||void 0===s?void 0:s[t];if(!l)return void o.info(`Could not find css variable name for ${t} in ${i}`,"Check if the css variable is defined in the component");const c=a[t];e.style.setProperty(l,c)})):o.info(`Could not find component class for ${i}`,"Check if the component is registered")}))})(r,h,d.cssVars,this.loggerWrapper),r.replaceChildren(h);const l=!t.htmlFilename;setTimeout((()=>{o(this,fr,"m",Jr).call(this),this.validateOnBlur&&(e=>{e.querySelectorAll("*[name]").forEach((t=>{t.addEventListener("blur",(()=>{var n;const o=()=>{var e;const n=t.focus;t.focus=()=>{},null===(e=t.reportValidity)||void 0===e||e.call(t),setTimeout((()=>{t.focus=n}))};if("true"===t.getAttribute("invalid")||(null===(n=t.value)||void 0===n?void 0:n.length))return void o();const i={timer:void 0},r=e=>{"true"===e.target.getAttribute("formnovalidate")&&(clearTimeout(i.timer),i.timer=void 0)};i.timer=setTimeout((()=>{e.removeEventListener("click",r),o(),i.timer=void 0}),150),e.addEventListener("click",r,{once:!0})}))}))})(r),((e,t)=>{Zo(e,null==t?void 0:t.inputs),Zo(e,null==t?void 0:t.form)})(r,d),o(this,fr,"m",Mr).call(this,{isFirstScreen:l,isCustomScreen:!1,stepName:e.stepName}),Ro(r,this.autoFocus,l)})),o(this,fr,"m",zr).call(this,c);r.querySelector(`[${co}="polling"]`)&&c(bo,{})}));l?o(this,fr,"m",Rr).call(this,f):f()}))}getInputs(){return Array.from(this.shadowRoot.querySelectorAll(`*:not(slot)[name]:not([${zn}])`))}}vr=new WeakMap,mr=new WeakMap,br=new WeakMap,wr=new WeakMap,jr=new WeakMap,Ur=new WeakMap,Tr=new WeakMap,Lr=new WeakMap,$r=new WeakMap,Pr=new WeakMap,qr=new WeakMap,Hr=new WeakMap,fr=new WeakSet,yr=function(){document.hidden||setTimeout((()=>{this.flowState.update({deferredRedirect:!1})}),300)},kr=function(e,t,i){return n(this,void 0,void 0,(function*(){var n;return(null===(n=this.nativeOptions)||void 0===n?void 0:n.bridgeVersion)>=2&&new Promise((n=>{this.nativeCallbacks.screenNext=i,this.nativeCallbacks.screenResolve=n,o(this,fr,"m",Sr).call(this,"beforeScreen",{screen:e,context:t})}))}))},Ir=function(e){var t;(null===(t=this.nativeOptions)||void 0===t?void 0:t.bridgeVersion)>=2&&o(this,fr,"m",Sr).call(this,"afterScreen",{screen:e})},Sr=function(e,t){o(this,fr,"m",Gr).call(this,"bridge",{type:e,payload:t})},Or=function({errorText:e,errorType:t}){const n=()=>{var n;let o=e;try{o=(null===(n=this.errorTransformer)||void 0===n?void 0:n.call(this,{text:e,type:t}))||e}catch(e){this.loggerWrapper.error("Error transforming error message",e.message)}((e,t,n="")=>{e.querySelectorAll(`[${co}="${t}"]`).forEach((e=>{e.textContent=n,e.classList[n?"remove":"add"]("hide")}))})(this.contentRootElement,"error-message",o)};this.addEventListener("screen-updated",n,{once:!0}),n()},Cr=function(){var e,n,i;null===(e=this.stepState)||void 0===e||e.subscribe(this.onStepChange.bind(this),(e=>{var n=e.screenState,o=t(void 0===n?{}:n,["errorText","errorType"]),i=t(e,["screenState"]);return Object.assign(Object.assign({},i),{screenState:o})})),null===(n=this.stepState)||void 0===n||n.subscribe(o(this,fr,"m",Or).bind(this),(e=>{var t,n;return{errorText:null===(t=null==e?void 0:e.screenState)||void 0===t?void 0:t.errorText,errorType:null===(n=null==e?void 0:e.screenState)||void 0===n?void 0:n.errorType}}),{forceUpdate:!0}),null===(i=this.stepState)||void 0===i||i.subscribe(o(this,fr,"m",xr).bind(this),(e=>{var t,n;return{errorText:null===(t=null==e?void 0:e.screenState)||void 0===t?void 0:t.errorText,errorType:null===(n=null==e?void 0:e.screenState)||void 0===n?void 0:n.errorType}}),{forceUpdate:!0})},xr=function({errorText:e,errorType:t}){(t||e)&&(this.contentRootElement.querySelectorAll('descope-passcode[data-auto-submit="true"]').forEach((e=>{e.shadowRoot.querySelectorAll("descope-text-field[data-id]").forEach((e=>{e.value=""}))})),Ro(this.contentRootElement,this.autoFocus,!1))},Ar=function(){return n(this,void 0,void 0,(function*(){this.loggerWrapper.debug("Trying to restart the flow");const e=yield this.getComponentsVersion();this.reset();e===(yield this.getComponentsVersion())?(this.loggerWrapper.debug("Components version was not changed, restarting flow"),this.flowState.update({stepId:null,executionId:null})):this.loggerWrapper.error("Components version mismatch, please reload the page")}))},Er=function(e){return n(this,void 0,void 0,(function*(){var n;const r=Object.assign(Object.assign({},this.stepState.current),e),{next:s,stepName:a}=r,l=t(r,["next","stepName"]),c=Mo(l);let d=yield o(this,fr,"m",kr).call(this,a,c,s);d||(d=Boolean(yield null===(n=this.onScreenUpdate)||void 0===n?void 0:n.call(this,a,c,s,this)));const u=!this.stepState.current.htmlFilename;if(o(this,Ur,"f").call(this,d),o(this,jr,"f")!==d){const[e,t]=["flow","custom"].sort((()=>d?-1:1));this.loggerWrapper.debug(`Switching from ${t} screen to ${e} screen`),i(this,jr,d,"f"),d?this.stepState.unsubscribeAll():o(this,fr,"m",Cr).call(this)}d&&(this.loggerWrapper.debug("Showing a custom screen"),o(this,fr,"m",Mr).call(this,{isFirstScreen:u,isCustomScreen:d,stepName:e.stepName})),this.stepState.forceUpdate=d}))},Rr=function(e){this.contentRootElement.addEventListener("transitionend",(()=>{this.loggerWrapper.debug("page switch transition end"),this.contentRootElement.classList.remove("fade-out"),e()}),{once:!0}),this.loggerWrapper.debug("page switch transition start"),this.contentRootElement.classList.add("fade-out")},Wr=function(e){const t=e.getAttribute("name");if(!["email"].includes(t)){const n=`user-${t}`;e.setAttribute("name",n),e.addEventListener("input",(()=>{e.setAttribute("name",e.value?t:n)}))}},Nr=function(e,t){return n(this,void 0,void 0,(function*(){var r;null===(r=o(this,mr,"f"))||void 0===r||r.abort();const s=e.querySelector('*[autocomplete="webauthn"]');if(s&&(yield oi())){const{options:e,transactionId:r}=(yield o(this,Pr,"f").call(this))||{};e&&r&&(o(this,fr,"m",Wr).call(this,s),i(this,mr,new AbortController,"f"),this.sdk.webauthn.helpers.conditional(e,o(this,mr,"f")).then((e=>n(this,void 0,void 0,(function*(){t(s.id,{transactionId:r,response:e})})))).catch((e=>{"AbortError"!==e.name&&this.loggerWrapper.error("Conditional login failed",e.message)})))}}))},Mr=function({isFirstScreen:e,isCustomScreen:t,stepName:n}){e&&o(this,fr,"m",Gr).call(this,"ready",{}),t||o(this,fr,"m",Ir).call(this,n),o(this,fr,"m",Gr).call(this,"page-updated",{screenName:n}),o(this,fr,"m",Gr).call(this,"screen-updated",{screenName:n})},_r=function(){let e=!0;return Array.from(this.shadowRoot.querySelectorAll("*[name]")).reverse().forEach((t=>{var n,o;"slot"!==t.localName&&(null===(n=t.reportValidity)||void 0===n||n.call(t),e&&(e=null===(o=t.checkValidity)||void 0===o?void 0:o.call(t)))})),e},Dr=function(){return n(this,void 0,void 0,(function*(){const e=this.getInputs();return(yield Promise.all(e.map((e=>n(this,void 0,void 0,(function*(){return{name:e.getAttribute("name"),value:e.value}})))))).reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.name]:t.value})),{})}))},Fr=function(e){const t=Array.from(this.contentRootElement.querySelectorAll(':not([disabled]), [disabled="false"]')).filter((t=>t!==e)),r=()=>n(this,void 0,void 0,(function*(){this.loggerWrapper.debug("Restoring components state"),this.removeEventListener("popupclosed",r),e.removeAttribute("loading"),t.forEach((e=>{e.removeAttribute("disabled")}));const n=yield this.getFlowConfig(),o=[...n.clientScripts||[],...n.sdkScripts||[]];this.loadSdkScripts(o)})),s=()=>{var e;window.removeEventListener("pageshow",o(this,qr,"f")),i(this,qr,(e=>{e.persisted&&(this.logger.debug("Page was loaded from cache, restoring components state"),r())}),"f"),window.addEventListener("pageshow",o(this,qr,"f"),{once:!0});const t=null===(e=this.stepState)||void 0===e?void 0:e.subscribe(((e,n)=>{e===n&&r(),this.removeEventListener("popupclosed",r),this.stepState.unsubscribe(t)}),(e=>e.screenId),{forceUpdate:!0})},a=this.nextRequestStatus.subscribe((({isLoading:n})=>{n?(this.addEventListener("popupclosed",r,{once:!0}),e.setAttribute("loading","true"),t.forEach((e=>e.setAttribute("disabled","true")))):(this.nextRequestStatus.unsubscribe(a),s())}))},Kr=function(e={}){var t,n;const o=Po(e,["externalId","email","phone"]),i=Po(e,["newPassword","password"]);if(o&&i)try{if(!globalThis.PasswordCredential)return;const e=new globalThis.PasswordCredential({id:o,password:i});null===(n=null===(t=null===navigator||void 0===navigator?void 0:navigator.credentials)||void 0===t?void 0:t.store)||void 0===n||n.call(t,e)}catch(e){this.loggerWrapper.error("Could not store credentials",e.message)}},Jr=function(){document.querySelectorAll('[data-hidden-input="true"]').forEach((e=>e.remove()));this.contentRootElement.querySelectorAll('[external-input="true"]').forEach((e=>o(this,fr,"m",Vr).call(this,e)))},Vr=function(e){if(!e)return;e.querySelectorAll("input").forEach((t=>{const n=t.getAttribute("slot"),o=`input-${e.id}-${n}`,i=document.createElement("slot");i.setAttribute("name",o),i.setAttribute("slot",n),e.appendChild(i),t.setAttribute("slot",o),this.appendChild(t)}))},Br=function(e){this.contentRootElement.querySelectorAll('descope-passcode[data-auto-submit="true"]').forEach((t=>{t.addEventListener("input",(()=>{var n;(null===(n=t.checkValidity)||void 0===n?void 0:n.call(t))&&o(this,Hr,"f").call(this,t,e)}))}))},zr=function(e){this.contentRootElement.querySelectorAll(`descope-button:not([${Gn}]), [data-type="button"]:not([${Gn}]`).forEach((t=>{t.onclick=()=>{o(this,Hr,"f").call(this,t,e)}})),o(this,fr,"m",Br).call(this,e),this.isDismissScreenErrorOnInput&&this.contentRootElement.querySelectorAll(`*[name]:not([${zn}])`).forEach((e=>{e.addEventListener("input",(()=>{this.stepState.update((e=>Object.assign(Object.assign({},e),{screenState:Object.assign(Object.assign({},e.screenState),{errorText:"",errorType:""})})))}))}))},Gr=function(e,t){this.dispatchEvent(new CustomEvent(e,{detail:t}))},customElements.get("descope-wc")?console.log("descope-wc is already defined"):customElements.define("descope-wc",as);const ls=document.createElement("template");ls.innerHTML='\n<div class="debugger">\n  <div class="header">\n    <span>Debugger messages</span>\n  </div>\n  <div class="content">\n    <div class="empty-state">\n      No errors detected 👀\n    </div>\n  </div>\n</div>\n';const cs=ci(Ni)(HTMLElement);class ds extends cs{constructor(){super(),Zr.add(this),Xr.set(this,new Ho({messages:[]})),Yr.set(this,void 0),Qr.set(this,void 0),es.set(this,void 0),ts.set(this,{resize:o(this,Zr,"m",ss).bind(this)}),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(ls.content.cloneNode(!0)),i(this,Yr,this.shadowRoot.querySelector(".debugger"),"f"),i(this,Qr,o(this,Yr,"f").querySelector(".content"),"f"),i(this,es,o(this,Yr,"f").querySelector(".header"),"f"),o(this,Zr,"m",ns).call(this)}updateData(e){o(this,Xr,"f").update((t=>({messages:t.messages.concat(e)})))}init(){const e=Object.create(null,{init:{get:()=>super.init}});return n(this,void 0,void 0,(function*(){var t,n;null===(t=e.init)||void 0===t||t.call(this),((e,t,n)=>{let o=0,i=0,r=0,s=0;function a(t){t.preventDefault(),o=r-t.clientX,i=s-t.clientY,r=t.clientX,s=t.clientY;const[a,l]=ii(e,e.offsetLeft-o,e.offsetTop-i,n);e.style.top=`${l}px`,e.style.left=`${a}px`}function l(){document.onmouseup=null,document.onmousemove=null}function c(e){e.preventDefault(),r=e.clientX,s=e.clientY,document.onmouseup=l,document.onmousemove=a}t?t.onmousedown=c:e.onmousedown=c})(o(this,Yr,"f"),o(this,es,"f"),{top:"all",bottom:100,left:100,right:100}),window.addEventListener("resize",o(this,ts,"f").resize),(n=o(this,Yr,"f")).onmousemove=e=>{(e.target.w&&e.target.w!==e.target.offsetWidth||e.target.h&&e.target.h!==e.target.offsetHeight)&&n.onresize(e),e.target.w=e.target.offsetWidth,e.target.h=e.target.offsetHeight},o(this,Yr,"f").onresize=o(this,Zr,"m",rs).bind(this),o(this,Xr,"f").subscribe(o(this,Zr,"m",os).bind(this))}))}disconnectedCallback(){o(this,Xr,"f").unsubscribeAll(),window.removeEventListener("resize",o(this,ts,"f").resize)}}Xr=new WeakMap,Yr=new WeakMap,Qr=new WeakMap,es=new WeakMap,ts=new WeakMap,Zr=new WeakSet,ns=function(){this.injectStyle('\n  .debugger {\n    all: initial;\n    width: 300px;\n    height: 200px;\n    background-color: #FAFAFA;\n    position: fixed;\n    font-family: "Helvetica Neue", sans-serif;\n    box-shadow: rgba(0, 0, 0, 0.1) 0px 5px 10px;\n    border-radius: 8px;\n    overflow: hidden;\n    border: 1px solid lightgrey;\n    pointer-events: initial;\n    display: flex;\n    flex-direction: column;\n    min-width: 200px;\n    max-width: 600px;\n    max-height: calc(100% - 64px);\n    min-height: 200px;\n    resize: both;\n  }\n\n  .header {\n    padding: 8px 16px;\n    display: flex;\n    align-items: center;\n    background-color: #EEEEEE;\n    cursor: move;\n    border-bottom: 1px solid #e0e0e0;\n  }\n\n  .content {\n    font-size: 14px;\n    flex-grow: 1;\n    overflow: auto;\n  }\n\n  .msg {\n    border-bottom: 1px solid lightgrey;\n    padding: 8px 16px;\n    display: flex;\n    gap: 5px;\n    background-color: #FAFAFA;\n  }\n\n  .msg.collapsible {\n    cursor: pointer;\n  }\n\n  .empty-state {\n    padding: 8px 16px;\n    background-color: #FAFAFA;\n  }\n\n\n  .msg.collapsible:not(.collapsed) {\n    background-color: #F5F5F5;\n  }\n\n  .msg_title {\n    padding-bottom: 5px;\n    display: flex;\n    gap: 8px;\n    font-weight: 500;\n  }\n\n  .msg svg {\n    padding: 1px;\n    flex-shrink: 0;\n    margin-top: -2px;\n  }\n\n  .msg_content {\n    overflow: hidden;\n    flex-grow: 1;\n    margin-right:5px;\n  }\n\n  .msg_desc {\n    color: #646464;\n    cursor: initial;\n    word-wrap: break-word;\n  }\n\n  .msg.collapsed .msg_desc {\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n  }\n\n  .msg.collapsible.collapsed .chevron {\n    transform: rotate(-45deg) translateX(-2px);\n  }\n\n  .msg.collapsible .chevron {\n    content: "";\n    width:6px;\n    height:6px;\n    border-bottom: 2px solid grey;\n    border-right: 2px solid grey;\n    transform: rotate(45deg) translateX(-1px);\n    margin: 5px;\n    flex-shrink:0;\n  }\n'),o(this,Yr,"f").style.top="32px",o(this,Yr,"f").style.left=window.innerWidth-300-32+"px"},os=function(e){o(this,Zr,"m",is).call(this,e),o(this,Zr,"m",rs).call(this)},is=function(e){o(this,Qr,"f").innerHTML=e.messages.map((e=>`\n    <div class="msg">\n      <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M5.99984 13.167L8.99984 10.167L11.9998 13.167L13.1665 12.0003L10.1665 9.00033L13.1665 6.00033L11.9998 4.83366L8.99984 7.83366L5.99984 4.83366L4.83317 6.00033L7.83317 9.00033L4.83317 12.0003L5.99984 13.167ZM8.99984 17.3337C7.84706 17.3337 6.76373 17.1148 5.74984 16.677C4.73595 16.2398 3.854 15.6462 3.104 14.8962C2.354 14.1462 1.76039 13.2642 1.32317 12.2503C0.885393 11.2364 0.666504 10.1531 0.666504 9.00033C0.666504 7.84755 0.885393 6.76421 1.32317 5.75033C1.76039 4.73644 2.354 3.85449 3.104 3.10449C3.854 2.35449 4.73595 1.7606 5.74984 1.32283C6.76373 0.885603 7.84706 0.666992 8.99984 0.666992C10.1526 0.666992 11.2359 0.885603 12.2498 1.32283C13.2637 1.7606 14.1457 2.35449 14.8957 3.10449C15.6457 3.85449 16.2393 4.73644 16.6765 5.75033C17.1143 6.76421 17.3332 7.84755 17.3332 9.00033C17.3332 10.1531 17.1143 11.2364 16.6765 12.2503C16.2393 13.2642 15.6457 14.1462 14.8957 14.8962C14.1457 15.6462 13.2637 16.2398 12.2498 16.677C11.2359 17.1148 10.1526 17.3337 8.99984 17.3337ZM8.99984 15.667C10.8609 15.667 12.4373 15.0212 13.729 13.7295C15.0207 12.4378 15.6665 10.8614 15.6665 9.00033C15.6665 7.13921 15.0207 5.56283 13.729 4.27116C12.4373 2.97949 10.8609 2.33366 8.99984 2.33366C7.13873 2.33366 5.56234 2.97949 4.27067 4.27116C2.979 5.56283 2.33317 7.13921 2.33317 9.00033C2.33317 10.8614 2.979 12.4378 4.27067 13.7295C5.56234 15.0212 7.13873 15.667 8.99984 15.667Z" fill="#ED404A"/>\n</svg>\n\n      <div class="msg_content">\n        <div class="msg_title">\n          ${e.title}\n        </div>\n        <div class="msg_desc">\n          ${e.description}\n        </div>\n      </div>\n      <div class="chevron"></div>\n    </div>\n  `)).join("")},rs=function(){o(this,Qr,"f").querySelectorAll(".msg").forEach((e=>{const t=e.querySelector(".msg_desc"),n=t.scrollWidth>t.clientWidth,o=t.clientHeight>20;n||o?(e.classList.add("collapsible"),e.onclick=t=>{t.target.classList.contains("msg_desc")||e.classList.toggle("collapsed")}):(e.classList.remove("collapsible"),e.onclick=null)}))},ss=function(){const[e,t]=ii(o(this,Yr,"f"),Number.parseInt(o(this,Yr,"f").style.left,10),Number.parseInt(o(this,Yr,"f").style.top,10),{top:"all",bottom:100,left:100,right:100});o(this,Yr,"f").style.top=`${t}px`,o(this,Yr,"f").style.left=`${e}px`},customElements.get("descope-debugger")||customElements.define("descope-debugger",ds);var us=Object.freeze({__proto__:null,default:ds})}();
