"use strict";var e=require("tslib"),t=require("@descope/escape-markdown"),o=require("../constants/index.js"),r=require("./helpers.js");const s=["disabled"],n=(e,t)=>{Object.entries(t||{}).forEach((([t,r])=>{Array.from(e.querySelectorAll(`*[name="${t}"]:not([${o.DESCOPE_ATTRIBUTE_EXCLUDE_FIELD}])`)).forEach((e=>{e.value=r}))}))},c=(e,t)=>t.split(".").reduce(((e,t)=>(null==e?void 0:e[t])||""),e),l=(e,o,r)=>e.replace(/{{(.+?)}}/g,((e,s)=>r?t.escapeMarkdown(c(o,s)):c(o,s))),i=(e,t,r)=>{e.querySelectorAll(`[${o.ELEMENT_TYPE_ATTRIBUTE}="${t}"]`).forEach((e=>{e.setAttribute("href",r)}))},a=(e,t,o)=>{var r,s;const n=null===(r=customElements.get(t))||void 0===r?void 0:r.cssVarList.url;o&&n&&(null===(s=null==e?void 0:e.style)||void 0===s||s.setProperty(n,`url(data:image/jpg;base64,${o})`))};exports.disableWebauthnButtons=e=>{e.querySelectorAll(`descope-button[${o.ELEMENT_TYPE_ATTRIBUTE}="biometrics"]`).forEach((e=>e.setAttribute("disabled","true")))},exports.replaceElementMessage=(e,t,r="")=>{e.querySelectorAll(`[${o.ELEMENT_TYPE_ATTRIBUTE}="${t}"]`).forEach((e=>{e.textContent=r,e.classList[r?"remove":"add"]("hide")}))},exports.setCssVars=(e,t,o,r)=>{o&&Object.keys(o).forEach((s=>{t.querySelector(s)||r.debug(`Skipping css vars for component "${s}}"`,`Got css vars for component ${s} but Could not find it on next page`);const n=customElements.get(s);n?Object.keys(o[s]).forEach((t=>{var c;const l=o[s],i=null===(c=null==n?void 0:n.cssVarList)||void 0===c?void 0:c[t];if(!i)return void r.info(`Could not find css variable name for ${t} in ${s}`,"Check if the css variable is defined in the component");const a=l[t];e.style.setProperty(i,a)})):r.info(`Could not find component class for ${s}`,"Check if the component is registered")}))},exports.setNOTPVariable=(e,t)=>{a(e,"descope-notp-image",t)},exports.setPhoneAutoDetectDefaultCode=(e,t)=>{Array.from(e.querySelectorAll('[default-code="autoDetect"]')).forEach((e=>{e.setAttribute("default-code",t)}))},exports.setTOTPVariable=(e,t)=>{a(e,"descope-totp-image",t)},exports.updateScreenFromScreenState=(e,t)=>{n(e,null==t?void 0:t.inputs),n(e,null==t?void 0:t.form)},exports.updateTemplateFromScreenState=(t,n,c,a,u)=>{var d,p;i(t,"totp-link",null===(d=null==n?void 0:n.totp)||void 0===d?void 0:d.provisionUrl),i(t,"notp-link",null===(p=null==n?void 0:n.notp)||void 0===p?void 0:p.redirectUrl),((e,t)=>{e.querySelectorAll("descope-text,descope-link,descope-enriched-text,descope-code-snippet").forEach((e=>{const o=r.shouldHandleMarkdown(e.localName);e.textContent=l(e.textContent,t,o);const s=e.getAttribute("href");s&&e.setAttribute("href",l(s,t))}))})(t,n),((t,o,r)=>{if(!o)return;const{componentsDynamicAttrs:s}=o,n=e.__rest(o,["componentsDynamicAttrs"]),c=Object.keys(n).reduce(((e,t)=>(e[`[name=${t}]`]=n[t],e)),{});s&&Object.keys(s).forEach((e=>{const t=s[e];if(t){const{attributes:o}=t;o&&Object.keys(o).length&&(c[e]=o)}})),Object.keys(c).forEach((e=>{t.querySelectorAll(e).forEach((t=>{const o=c[e];Object.keys(o).forEach((e=>{let s=o[e];if("string"!=typeof s)try{s=JSON.stringify(s)}catch(t){r.error(`Could not stringify value "${s}" for "${e}"`,t.message),s=""}t.setAttribute(e,s)}))}))}))})(t,c,u),((e,t)=>{e.querySelectorAll(`[${o.HAS_DYNAMIC_VALUES_ATTR_NAME}]`).forEach((e=>{Array.from(e.attributes).forEach((e=>{e.value=l(e.value,t)}))}))})(t,n),((e,t)=>{Object.entries(t).forEach((([t,o])=>{e.querySelectorAll(`[name="${t}"]`).forEach((e=>{Object.entries(o).forEach((([t,o])=>{s.includes(t)&&e.setAttribute(t,o)}))}))}))})(t,a)};
//# sourceMappingURL=templates.js.map
