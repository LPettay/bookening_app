import{__classPrivateFieldGet as t,__classPrivateFieldSet as e}from"tslib";import{createIsChanged as s}from"./helpers.js";var r,i,f,n;function o(t,e){const s=Object.getOwnPropertyNames(t),r=Object.getOwnPropertyNames(e);if(s.length!==r.length)return!1;for(let r=0;r<s.length;r+=1){const i=s[r],f=t[i],n=e[i];if(null===f||null===n){if(f!==n)return!1}else if("object"==typeof f&&"object"==typeof n){if(!o(f,n))return!1}else if(f!==n)return!1}return!0}class c{constructor(c={},{forceUpdate:h=!1}={}){r.set(this,void 0),i.set(this,{}),f.set(this,0),n.set(this,!0),this.update=f=>{const c="function"==typeof f?f(t(this,r,"f")):f,h=Object.assign(Object.assign({},t(this,r,"f")),c),u=t(this,r,"f");e(this,r,h,"f"),Object.freeze(t(this,r,"f")),setTimeout((()=>{Object.values(t(this,i,"f")).forEach((({cb:e,selector:r,forceUpdate:i})=>{const f=r(u),c=r(h);(t(this,n,"f")||i||(function(t){if("object"!=typeof t||null===t)return!1;const e=Object.getPrototypeOf(t);return e===Object.prototype||null===e}(c)?!o(f,c):f!==c))&&e(c,f,s(c,f))}))}),0)},e(this,r,c,"f"),e(this,n,h,"f")}get current(){return Object.assign({},t(this,r,"f"))}set forceUpdate(t){e(this,n,t,"f")}subscribe(s,r=t=>t,{forceUpdate:n=!1}={}){return e(this,f,t(this,f,"f")+1,"f"),t(this,i,"f")[t(this,f,"f")]={cb:s,selector:r,forceUpdate:n},t(this,f,"f").toString()}unsubscribe(e){const s=!!t(this,i,"f")[e];return s&&delete t(this,i,"f")[e],s}unsubscribeAll(){return e(this,i,{},"f"),!0}}r=new WeakMap,i=new WeakMap,f=new WeakMap,n=new WeakMap;export{c as default};
//# sourceMappingURL=state.js.map
