{"version":3,"file":"resetMixin.js","sources":["../../../src/mixins/resetMixin.ts"],"sourcesContent":["import { createSingletonMixin, compose } from '@descope/sdk-helpers';\nimport { missingAttrValidator } from './createValidateAttributesMixin/commonValidators';\nimport { createValidateAttributesMixin } from './createValidateAttributesMixin';\n\nexport const resetMixin = createSingletonMixin(\n  <T extends CustomElementConstructor>(superclass: T) => {\n    const BaseClass = compose(\n      createValidateAttributesMixin({ 'project-id': missingAttrValidator }),\n    )(superclass);\n\n    return class ResetMixinClass extends BaseClass {\n      #callbacks = new Map<string, () => void>();\n\n      onReset(sectionId: string, callback: () => void | Promise<void>) {\n        if (!this.#callbacks.has(sectionId)) {\n          this.#callbacks.set(sectionId, callback);\n          return () => {\n            this.#callbacks.delete(sectionId);\n          };\n        } else {\n          throw new Error(`Callback for sectionId ${sectionId} already exists`);\n        }\n      }\n\n      async reset(...sectionIds: string[]) {\n        if (sectionIds.length === 0) {\n          await Promise.all(\n            Array.from(this.#callbacks.values()).map((callback) => callback()),\n          );\n        } else {\n          await Promise.all(\n            sectionIds.map((sectionId) => {\n              if (!this.#callbacks.has(sectionId)) {\n                throw new Error(\n                  `Callback for sectionId ${sectionId} does not exist`,\n                );\n              }\n              return this.#callbacks.get(sectionId)?.();\n            }),\n          );\n        }\n      }\n    };\n  },\n);\n"],"names":["createSingletonMixin","compose","createValidateAttributesMixin","missingAttrValidator","__classPrivateFieldGet"],"mappings":";;;;;;;MAIa,UAAU,GAAGA,+BAAoB,CAC5C,CAAqC,UAAa,KAAI;;AACpD,IAAA,MAAM,SAAS,GAAGC,kBAAO,CACvBC,2DAA6B,CAAC,EAAE,YAAY,EAAEC,qCAAoB,EAAE,CAAC,CACtE,CAAC,UAAU,CAAC,CAAC;IAEd,OAAO,EAAA,GAAA,MAAM,eAAgB,SAAQ,SAAS,CAAA;AAAvC,YAAA,WAAA,GAAA;;gBACL,0BAAa,CAAA,GAAA,CAAA,IAAA,EAAA,IAAI,GAAG,EAAsB,CAAC,CAAA;aA+B5C;YA7BC,OAAO,CAAC,SAAiB,EAAE,QAAoC,EAAA;gBAC7D,IAAI,CAACC,4BAAA,CAAA,IAAI,EAAW,0BAAA,EAAA,GAAA,CAAA,CAAC,GAAG,CAAC,SAAS,CAAC,EAAE;oBACnCA,4BAAA,CAAA,IAAI,kCAAW,CAAC,GAAG,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAC;AACzC,oBAAA,OAAO,MAAK;AACV,wBAAAA,4BAAA,CAAA,IAAI,EAAW,0BAAA,EAAA,GAAA,CAAA,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;AACpC,qBAAC,CAAC;iBACH;qBAAM;AACL,oBAAA,MAAM,IAAI,KAAK,CAAC,0BAA0B,SAAS,CAAA,eAAA,CAAiB,CAAC,CAAC;iBACvE;aACF;AAED,YAAA,MAAM,KAAK,CAAC,GAAG,UAAoB,EAAA;AACjC,gBAAA,IAAI,UAAU,CAAC,MAAM,KAAK,CAAC,EAAE;oBAC3B,MAAM,OAAO,CAAC,GAAG,CACf,KAAK,CAAC,IAAI,CAACA,4BAAA,CAAA,IAAI,EAAA,0BAAA,EAAA,GAAA,CAAW,CAAC,MAAM,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,QAAQ,KAAK,QAAQ,EAAE,CAAC,CACnE,CAAC;iBACH;qBAAM;oBACL,MAAM,OAAO,CAAC,GAAG,CACf,UAAU,CAAC,GAAG,CAAC,CAAC,SAAS,KAAI;;wBAC3B,IAAI,CAACA,4BAAA,CAAA,IAAI,EAAW,0BAAA,EAAA,GAAA,CAAA,CAAC,GAAG,CAAC,SAAS,CAAC,EAAE;AACnC,4BAAA,MAAM,IAAI,KAAK,CACb,0BAA0B,SAAS,CAAA,eAAA,CAAiB,CACrD,CAAC;yBACH;wBACD,OAAO,CAAA,EAAA,GAAAA,4BAAA,CAAA,IAAI,EAAW,0BAAA,EAAA,GAAA,CAAA,CAAC,GAAG,CAAC,SAAS,CAAC,MAAA,IAAA,IAAA,EAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,EAAA,EAAI,CAAC;qBAC3C,CAAC,CACH,CAAC;iBACH;aACF;AACF,SAAA;;AAAC,QAAA,EAAA,CAAA;AACJ,CAAC;;;;"}