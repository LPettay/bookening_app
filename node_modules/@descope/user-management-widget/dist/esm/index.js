
      /**
       * @descope/user-management-widget v0.9.6
       */
      import{__awaiter as e,__classPrivateFieldGet as t,__classPrivateFieldSet as s,__rest as i}from"tslib";import{createTemplate as o,kebabCase as r,pluralize as a,compareArrays as n,createSingletonMixin as d,compose as l,withMemCache as c,debounce as u}from"@descope/sdk-helpers";import{projectIdMixin as h,observeAttributesMixin as v,loggerMixin as g,baseUrlMixin as m,cookieConfigMixin as f,createValidateAttributesMixin as p,createStateManagementMixin as y,initLifecycleMixin as b,staticResourcesMixin as w,descopeUiMixin as R,initElementMixin as M,modalMixin as W,formMixin as U,notificationsMixin as k,themeMixin as C,debuggerMixin as P}from"@descope/sdk-mixins";import{ButtonDriver as S,MultiSelectDriver as x,TextDriver as I,TextFieldDriver as j,GridDriver as N,FlowDriver as O,GenericFlowButtonDriver as L}from"@descope/sdk-component-drivers";import{createSelector as T}from"reselect";import{createAsyncThunk as A}from"@reduxjs/toolkit";import q from"@descope/web-js-sdk";import F from"libphonenumber-js/min";var $;!function(e){e[e.text=1]="text",e[e.numeric=2]="numeric",e[e.bool=3]="bool",e[e.singleSelect=4]="singleSelect",e[e.array=5]="array",e[e.date=6]="date"}($||($={}));const E=(e,t)=>Object.entries(e).reduce(((e,[s,i])=>{const[o,...r]=s.split(".");return t!==o?Object.assign(e,{[s]:i}):(e[o]||(e[o]={}),e[o][r.join(".")]=i,e)}),{}),B=(e,t)=>Object.fromEntries(Object.entries(e||{}).map((([e,s])=>[`${t}.${e}`,s]))),D=(e,t)=>e===$.date?(e=>new Date(Number(e)).toLocaleDateString("en-US"))(`${t}`):t,H=(e={})=>{const t=o("<descope-wc></descope-wc>");return Object.entries(e).forEach((([e,s])=>{t.content.querySelector("descope-wc").setAttribute(r(e),s)})),t};function Z(e){return new URLSearchParams(window.location.search).get(e)}const V={enabled:"active",disabled:"disabled",invited:"invited"},J=e=>e.tenantRoles.data,z=e=>e.selectedUsersLoginIds,G=e=>e.notifications,K=e=>e.customAttributes.data,Q=T(K,(e=>Object.fromEntries(e.map((e=>[e.name,e.type]))))),X=T((e=>e.usersList.data),Q,((e,t)=>e.map((e=>Object.assign(Object.assign({},e),{customAttributes:Object.fromEntries(Object.entries(e.customAttributes).map((([e,s])=>[e,D(t[e],s)])))}))))),Y=T(X,(e=>e.map((e=>Object.assign(Object.assign(Object.assign({},e),B(null==e?void 0:e.customAttributes,"customAttributes")),{createdTimeFormatted:new Date(1e3*((null==e?void 0:e.createdTime)||0)).toLocaleString(),status:V[e.status]||e.status,roles:e.roleNames}))))),_=T(z,Y,((e,t)=>t.filter((t=>e.includes(t.loginIds))))),ee=T(_,(e=>e.map((e=>e.userId)))),te=T(_,(e=>e.map((({userId:e,loginIds:t})=>({userId:e,loginIds:t}))))),se=T(_,(e=>e.map((e=>e.status)))),ie=T(_,(e=>e.every((e=>e.editable)))),oe=T(z,(e=>!!e.length)),re=T(z,(e=>1===e.length)),ae=T(z,(e=>{var t;return null===(t=null==e?void 0:e[0])||void 0===t?void 0:t[0]})),ne=T(re,se,((e,t)=>e&&t.every((e=>e===V.enabled)))),de=T(se,(e=>e.every((e=>e===V.disabled)))),le=T(_,(e=>{var t;return 1===e.length?e[0].name||e[0].email||(null===(t=e[0].loginIds)||void 0===t?void 0:t[0]):`${e.length} users`})),ce=T(re,de,ie,((e,t,s)=>e&&t&&s)),ue=T(re,ne,ie,((e,t,s)=>e&&t&&s)),he=T(re,ie,((e,t)=>e&&t)),ve=T(re,ie,((e,t)=>e&&t)),ge=T(re,ie,((e,t)=>e&&t)),me=oe,fe=e=>(...t)=>s=>{s.addCase(e.pending,((e,s)=>{t.forEach((({onPending:t})=>{null==t||t(e,s)}))})),s.addCase(e.fulfilled,((e,s)=>{t.forEach((({onFulfilled:t})=>{null==t||t(e,s)}))})),s.addCase(e.rejected,((e,s)=>{t.forEach((({onRejected:t})=>{null==t||t(e,s)}))}))},pe=e=>({onFulfilled:t=>{e(t).loading=!1},onPending:t=>{e(t).loading=!0,e(t).error=null},onRejected:(t,s)=>{e(t).loading=!1,e(t).error=s.error}}),ye=({getErrorMsg:e,getSuccessMsg:t})=>({onFulfilled:(e,s)=>{t&&e.notifications.push({type:"success",msg:t(s)})},onRejected:(t,s)=>{e&&t.notifications.push({type:"error",msg:e(s)})}}),be=A("users/create",((e,{extra:{api:t}})=>t.user.create(e))),we=fe(be)({onFulfilled:(e,t)=>{e.usersList.data.unshift(t.payload)}},pe((e=>e.createUser)),ye({getSuccessMsg:()=>"User created successfully",getErrorMsg:e=>{var t;return`\n      <div>\n        <div>Failed to create user</div>\n        ${null===(t=e.error)||void 0===t?void 0:t.message}\n      </div>`}})),Re={action:be,reducer:we},Me=A("users/delete",((e,{extra:{api:t}})=>t.user.deleteBatch(e))),We=fe(Me)({onFulfilled:(e,t)=>{e.usersList.data=e.usersList.data.filter((e=>!t.meta.arg.includes(e.userId))),e.selectedUsersLoginIds=[]}},pe((e=>e.deleteUser)),ye({getSuccessMsg:e=>a(e.meta.arg.length)`${["",e.meta.arg.length]} ${["U","u"]}ser${["","s"]} deleted successfully`,getErrorMsg:e=>a(e.meta.arg.length)`Failed to delete user${["","s"]}`})),Ue={action:Me,reducer:We},ke=A("users/setTempPassword",((e,{extra:{api:t}})=>t.user.setTempPassword(e))),Ce=fe(ke)(pe((e=>e.setTempUserPassword)),ye({getSuccessMsg:()=>"Successfully reset user password",getErrorMsg:e=>{var t;return`\n      <div>\n        <div>Failed to reset user's password</div>\n        ${null===(t=e.error)||void 0===t?void 0:t.message}\n      </div>`}})),Pe={action:ke,reducer:Ce},Se=A("users/getCustomAttributes",((e,{extra:{api:t}})=>t.user.getCustomAttributes())),xe=fe(Se)({onFulfilled:(e,t)=>{e.customAttributes.data=t.payload}},pe((e=>e.customAttributes))),Ie={action:Se,reducer:xe},je=A("users/search",((e,{extra:{api:t},getState:s})=>{const i=s().searchParams;return t.user.search(Object.assign(Object.assign({},i),e))})),Ne=fe(je)({onPending:(e,t)=>{e.searchParams=Object.assign(Object.assign({},e.searchParams),t.meta.arg)},onFulfilled:(e,t)=>{e.usersList.data=t.payload}},pe((e=>e.usersList))),Oe={action:je,reducer:Ne},Le=A("tenant/getTenantRoles",((e,{extra:{api:t}})=>t.tenant.getTenantRoles())),Te=fe(Le)({onFulfilled:(e,t)=>{e.tenantRoles.data=t.payload.roles}},pe((e=>e.tenantRoles))),Ae={action:Le,reducer:Te},qe=A("users/update",((e,{extra:{api:t}})=>t.user.update(e))),Fe=fe(qe)({onFulfilled:(e,t)=>{const s=e.usersList.data.findIndex((e=>n(e.loginIds,t.payload.loginIds)));-1!==s&&(e.usersList.data[s]=t.payload)}},pe((e=>e.updateUser)),ye({getSuccessMsg:()=>"User updated successfully",getErrorMsg:e=>{var t;return`\n      <div>\n        <div>Failed to update user</div>\n        ${null===(t=e.error)||void 0===t?void 0:t.message}\n      </div>`}})),$e={action:qe,reducer:Fe},Ee=A("users/enable",((e,{extra:{api:t}})=>t.user.enable(e))),Be=fe(Ee)({onFulfilled:(e,t)=>{var s;const i=e.usersList.data.findIndex((e=>{var s;return n(e.loginIds,null===(s=t.payload.user)||void 0===s?void 0:s.loginIds)}));-1!==i&&(e.usersList.data[i].status=null===(s=t.payload.user)||void 0===s?void 0:s.status)}},pe((e=>e.enableUser)),ye({getSuccessMsg:()=>"User enabled successfully",getErrorMsg:e=>{var t;return`\n      <div>\n        <div>Failed to enable user</div>\n        ${null===(t=e.error)||void 0===t?void 0:t.message}\n      </div>`}})),De={action:Ee,reducer:Be},He=A("users/disable",((e,{extra:{api:t}})=>t.user.disable(e))),Ze=fe(He)({onFulfilled:(e,t)=>{var s;const i=e.usersList.data.findIndex((e=>{var s;return n(e.loginIds,null===(s=t.payload.user)||void 0===s?void 0:s.loginIds)}));-1!==i&&(e.usersList.data[i].status=null===(s=t.payload.user)||void 0===s?void 0:s.status)}},pe((e=>e.disableUser)),ye({getSuccessMsg:()=>"User disabled successfully",getErrorMsg:e=>{var t;return`\n      <div>\n        <div>Failed to disable user</div>\n        ${null===(t=e.error)||void 0===t?void 0:t.message}\n      </div>`}})),Ve={action:He,reducer:Ze},Je=A("users/removePasskey",((e,{extra:{api:t}})=>t.user.removePasskey(e))),ze={action:Je,reducer:fe(Je)(pe((e=>e.removePasskey)),ye({getSuccessMsg:()=>"Successfully removed user's passkey",getErrorMsg:e=>{var t;return`\n      <div>\n        <div>Failed to remove user's passkey</div>\n        ${null===(t=e.error)||void 0===t?void 0:t.message}\n      </div>`}}))},Ge={usersList:{data:[],loading:!1,error:null},createUser:{loading:!1,error:null},updateUser:{loading:!1,error:null},deleteUser:{loading:!1,error:null},enableUser:{loading:!1,error:null},disableUser:{loading:!1,error:null},removePasskey:{loading:!1,error:null},setTempUserPassword:{loading:!1,error:null},customAttributes:{loading:!1,error:null,data:[]},tenantRoles:{loading:!1,error:null,data:[]},searchParams:{text:"",sort:[]},selectedUsersLoginIds:[],notifications:[]},Ke={search:"/v1/mgmt/user/search",deleteBatch:"/v1/mgmt/user/delete/batch",create:"/v1/mgmt/user/create",update:"/v1/mgmt/user/update",status:"/v1/mgmt/user/update/status",setTempPassword:"/v1/mgmt/user/password/set/temporary",removePasskey:"/v1/mgmt/user/passkeys/delete",customAttributes:"/v1/mgmt/user/customattributes"},Qe={roles:"/v1/mgmt/role/all"},Xe=t=>e(void 0,void 0,void 0,(function*(){const e=yield t.text(),s=JSON.parse(e);if(!t.ok){const e=`${s.errorDescription}${s.errorMessage?`: ${s.errorMessage}`:""}`;throw Error(e||`${t.status} ${t.statusText}`)}t.json=()=>Promise.resolve(s),t.text=()=>Promise.resolve(e)})),Ye=t=>e(void 0,[t],void 0,(function*({text:e,sort:t}){return new Promise((s=>{const i=[],o=(new Date).getTime();for(let e=1;e<10;e+=1)i.push({loginIds:[`user${e}@company.com`],externalIds:[`user${e}@company.com`],userId:`user-${e}`,name:`User ${e}`,email:`user${e}@company.com`,roleNames:[`Role ${e}`],phone:`+1-202-555-010${e}`,verifiedEmail:!0,verifiedPhone:!0,userTenants:[],status:"enabled",editable:!0,createdTime:o,createdTimeFormatted:new Date(1e3*(o||0)).toLocaleString(),customAttributes:{},familyName:"",givenName:"",middleName:"",picture:"",password:!0,SAML:!1,test:!1,TOTP:!1,webauthn:!1});t.forEach((e=>{i.sort(((t,s)=>{var i,o;return e.desc?null===(o=s[e.field])||void 0===o?void 0:o.localeCompare(t[e.field]):null===(i=t[e.field])||void 0===i?void 0:i.localeCompare(s[e.field])}))})),s(i.filter((t=>t.name.toLowerCase().includes(e.toLowerCase())||t.phone.toLowerCase().includes(e.toLowerCase())||t.status.toLowerCase().includes(e.toLowerCase())||"active"===e.toLowerCase()||t.familyName.toLowerCase().includes(e.toLowerCase())||t.givenName.toLowerCase().includes(e.toLowerCase())||t.middleName.toLowerCase().includes(e.toLowerCase())||t.email.toLowerCase().includes(e.toLowerCase()))))}))})),_e=t=>e(void 0,[t],void 0,(function*({loginId:e,email:t,phone:s,displayName:i,roles:o,customAttributes:r,picture:a,verifiedEmail:n,verifiedPhone:d,givenName:l,middleName:c,familyName:u}){return new Promise((h=>{const v=Math.random().toString(10).substring(15);h({loginIds:[e],externalIds:[e],userId:`user-${v}`,email:t,phone:s,name:i,roleNames:o,customAttributes:r,picture:a,verifiedEmail:n,verifiedPhone:d,givenName:l,middleName:c,familyName:u,createdTime:(new Date).getTime(),editable:!0,password:!0,SAML:!1,status:"enabled",test:!1,TOTP:!1,userTenants:[],webauthn:!1})}))})),et=t=>e(void 0,[t],void 0,(function*({loginId:e,email:t,phone:s,displayName:i,roles:o,customAttributes:r,picture:a,verifiedEmail:n,verifiedPhone:d,givenName:l,middleName:c,familyName:u}){return new Promise((h=>{h({loginIds:[e],externalIds:[e],userId:e,email:t,phone:s,name:i,roleNames:o,customAttributes:r,picture:a,verifiedEmail:n,verifiedPhone:d,givenName:l,middleName:c,familyName:u,createdTime:(new Date).getTime(),editable:!0,password:!0,SAML:!1,status:"enabled",test:!1,TOTP:!1,userTenants:[],webauthn:!1})}))})),tt=()=>e(void 0,void 0,void 0,(function*(){})),st=()=>e(void 0,void 0,void 0,(function*(){return new Promise((e=>{e({cleartext:Math.random().toString(20).substring(2)})}))})),it=()=>e(void 0,void 0,void 0,(function*(){})),ot=t=>e(void 0,void 0,void 0,(function*(){return new Promise((e=>{e({user:{loginIds:[t],status:"enabled"}})}))})),rt=t=>e(void 0,void 0,void 0,(function*(){return new Promise((e=>{e({user:{loginIds:[t],status:"disabled"}})}))})),at=()=>e(void 0,void 0,void 0,(function*(){return new Promise((e=>{e([])}))})),nt=e=>new Promise((t=>{const s=[];for(let t=1;t<5;t+=1)s.push({name:`Role ${t}`,description:`Role description ${t}`,createdTime:new Date,permissionNames:[`Permission ${t}`],tenantId:e});t({roles:s})})),dt=({httpClient:t,tenant:s,mock:i})=>({search:(...o)=>e(void 0,[...o],void 0,(function*({page:e,limit:o=1e4,customAttributes:r,statuses:a,emails:n,phones:d,text:l,sort:c}={}){if(i)return Ye({page:e,limit:o,customAttributes:r,statuses:a,emails:n,phones:d,text:l,sort:c});const u=yield t.post(Ke.search,{limit:o,page:e,withTestUser:!1,customAttributes:r,statuses:a,emails:n,phones:d,text:l,sort:c},{queryParams:{tenant:s}});yield Xe(u);return(yield u.json()).users})),deleteBatch:o=>e(void 0,void 0,void 0,(function*(){if(i)return tt();const e=yield t.post(Ke.deleteBatch,{userIds:o},{queryParams:{tenant:s}});return yield Xe(e),e.json()})),create:o=>e(void 0,[o],void 0,(function*({loginId:e,email:o,phone:r,displayName:a,roles:n,customAttributes:d,picture:l,verifiedEmail:c,verifiedPhone:u,givenName:h,middleName:v,familyName:g,additionalLoginIds:m,sendSMS:f,sendMail:p,inviteUrl:y,invite:b}){if(i)return _e({loginId:e,email:o,phone:r,displayName:a,roles:n,customAttributes:d,picture:l,verifiedEmail:c,verifiedPhone:u,givenName:h,middleName:v,familyName:g,additionalLoginIds:m,sendSMS:f,sendMail:p,inviteUrl:y,invite:b});const w=yield t.post(Ke.create,{loginId:e,email:o,phone:r,displayName:a,givenName:h,middleName:v,familyName:g,roleNames:n,userTenants:[{tenantId:s}],customAttributes:d,picture:l,verifiedEmail:c,verifiedPhone:u,additionalLoginIds:m,sendSMS:f,sendMail:p,inviteUrl:y,invite:b},{queryParams:{tenant:s}});yield Xe(w);return(yield w.json()).user})),update:o=>e(void 0,[o],void 0,(function*({loginId:e,email:o,phone:r,displayName:a,roles:n,customAttributes:d,picture:l,verifiedEmail:c,verifiedPhone:u,givenName:h,middleName:v,familyName:g,additionalLoginIds:m}){if(i)return et({loginId:e,email:o,phone:r,displayName:a,roles:n,customAttributes:d,picture:l,verifiedEmail:c,verifiedPhone:u,givenName:h,middleName:v,familyName:g,additionalLoginIds:m});const f=yield t.post(Ke.update,{loginId:e,email:o,phone:r,displayName:a,givenName:h,middleName:v,familyName:g,roleNames:n,customAttributes:d,picture:l,verifiedEmail:c,verifiedPhone:u,additionalLoginIds:m},{queryParams:{tenant:s}});yield Xe(f);return(yield f.json()).user})),enable:o=>e(void 0,void 0,void 0,(function*(){if(i)return ot(o);const e=yield t.post(Ke.status,{loginId:o,status:"enabled"},{queryParams:{tenant:s}});return yield Xe(e),e.json()})),disable:o=>e(void 0,void 0,void 0,(function*(){if(i)return rt(o);const e=yield t.post(Ke.status,{loginId:o,status:"disabled"},{queryParams:{tenant:s}});return yield Xe(e),e.json()})),removePasskey:o=>e(void 0,void 0,void 0,(function*(){if(i)return it();const e=yield t.post(Ke.removePasskey,{loginId:o},{queryParams:{tenant:s}});return yield Xe(e),e.json()})),setTempPassword:o=>e(void 0,void 0,void 0,(function*(){if(i)return st();const e=yield t.post(Ke.setTempPassword,{loginId:o},{queryParams:{tenant:s}});return yield Xe(e),e.json()})),getCustomAttributes:()=>e(void 0,void 0,void 0,(function*(){if(i)return at();const e=yield t.get(Ke.customAttributes,{queryParams:{tenant:s}});yield Xe(e);return(yield e.json()).data}))}),lt=({httpClient:t,tenant:s,mock:i})=>({getTenantRoles:()=>e(void 0,void 0,void 0,(function*(){if(i)return nt(s);const e=yield t.get(Qe.roles,{queryParams:{tenant:s}});return yield Xe(e),e.json()}))}),ct=d((i=>{var o,r,a,n;const d=l(h,v,g,m,f,p({tenant:p.missingAttrValidator}))(i);return n=class extends d{constructor(){super(...arguments),o.add(this),r.set(this,void 0)}get tenantId(){return this.getAttribute("tenant")}get widgetId(){return this.getAttribute("widget-id")}get mock(){return this.getAttribute("mock")}get api(){return t(this,r,"f")||t(this,o,"m",a).call(this),t(this,r,"f")}init(){const s=Object.create(null,{init:{get:()=>super.init}});return e(this,void 0,void 0,(function*(){var e;yield null===(e=s.init)||void 0===e?void 0:e.call(this),this.observeAttributes(["project-id","base-url","tenant"],(()=>{t(this,r,"f")&&t(this,o,"m",a).call(this)}))}))}},r=new WeakMap,o=new WeakSet,a=function(){this.logger.debug("creating an sdk instance"),s(this,r,((e,t,s,i)=>{const o=q(Object.assign(Object.assign({},e),{persistTokens:!0,baseHeaders:{"x-descope-widget-type":"user-management-widget","x-descope-widget-id":i,"x-descope-widget-version":"0.9.6"}}));return{user:dt({httpClient:o.httpClient,tenant:t,mock:s}),tenant:lt({httpClient:o.httpClient,tenant:t,mock:s})}})({projectId:this.projectId,baseUrl:this.baseUrl,refreshCookieName:this.refreshCookieName},this.tenantId,"true"===this.mock,this.widgetId),"f")},n})),ut=d((e=>{const t=l(y({name:"widget",initialState:Ge,reducers:{setSelectedUsersIds:(e,{payload:t})=>{e.selectedUsersLoginIds=t},clearNotifications:e=>{e.notifications=[]}},extraReducers:e=>{Re.reducer(e),$e.reducer(e),De.reducer(e),Ve.reducer(e),Ue.reducer(e),Oe.reducer(e),Pe.reducer(e),ze.reducer(e),Ie.reducer(e),Ae.reducer(e)},asyncActions:{searchUsers:Oe.action,createUser:Re.action,updateUser:$e.action,enableUser:De.action,disableUser:Ve.action,deleteUsers:Ue.action,removePasskey:ze.action,getCustomAttributes:Ie.action,getTenantRoles:Ae.action,setTempUserPassword:Pe.action}}),b,g,ct)(e);return class extends t{constructor(...e){super(...e),this.state=Ge,this.subscribe((e=>{this.logger.debug("State update:",e),this.state=e}))}}})),ht=d((t=>{const s=l(w,p({"widget-id":p.missingAttrValidator}))(t);return class extends s{get widgetId(){return this.getAttribute("widget-id")}fetchWidgetPage(t){return e(this,void 0,void 0,(function*(){return(yield this.fetchStaticResource(`user-management-widget/${this.widgetId}/${t}`,"text")).body}))}}})),vt=d((s=>{var i,r,a;return a=class extends(l(g,b,R,M,ht,ut)(s)){constructor(){super(...arguments),i.add(this)}onWidgetRootReady(){return e(this,void 0,void 0,(function*(){}))}init(){const s=Object.create(null,{init:{get:()=>super.init}});return e(this,void 0,void 0,(function*(){var e;yield null===(e=s.init)||void 0===e?void 0:e.call(this),yield Promise.all([t(this,i,"m",r).call(this),this.actions.searchUsers(),this.actions.getTenantRoles(),this.actions.getCustomAttributes()]),this.onWidgetRootReady()}))}},i=new WeakSet,r=function(){return e(this,void 0,void 0,(function*(){const e=o(yield this.fetchWidgetPage("root.html"));yield this.loadDescopeUiComponents(e),this.contentRootElement.append(e.content.cloneNode(!0))}))},a})),gt=d((i=>{var r,a,n,d,c,u;return u=class extends(l(ut,W,U,g,vt)(i)){constructor(){super(...arguments),r.add(this),a.set(this,void 0),c.set(this,(()=>e(this,void 0,void 0,(function*(){yield t(this,a,"f").setData(J(this.state).map((({name:e})=>({value:e,label:e}))))}))))}onWidgetRootReady(){const s=Object.create(null,{onWidgetRootReady:{get:()=>super.onWidgetRootReady}});return e(this,void 0,void 0,(function*(){var e;yield null===(e=s.onWidgetRootReady)||void 0===e?void 0:e.call(this),t(this,r,"m",n).call(this)}))}},a=new WeakMap,c=new WeakMap,r=new WeakSet,n=function(){return e(this,void 0,void 0,(function*(){this.createUserModal=this.createModal(),this.createUserModal.setContent(o(yield this.fetchWidgetPage("create-user-modal.html")));new S((()=>{var e;return null===(e=this.createUserModal.ele)||void 0===e?void 0:e.querySelector('[data-id="modal-cancel"]')}),{logger:this.logger}).onClick((()=>{this.createUserModal.close(),this.resetFormData(this.createUserModal.ele)}));new S((()=>{var e;return null===(e=this.createUserModal.ele)||void 0===e?void 0:e.querySelector('[data-id="modal-submit"]')}),{logger:this.logger}).onClick((()=>e(this,void 0,void 0,(function*(){if(this.validateForm(this.createUserModal.ele)){const e=this.getFormData(this.createUserModal.ele);this.actions.createUser(Object.assign(Object.assign({},E(e,"customAttributes")),{invite:!0,verifiedEmail:!0,verifiedPhone:!0})),this.createUserModal.close(),this.resetFormData(this.createUserModal.ele)}})))),s(this,a,new x((()=>{var e;return null===(e=this.createUserModal.ele)||void 0===e?void 0:e.querySelector('[data-id="roles-multiselect"]')}),{logger:this.logger}),"f"),t(this,c,"f").call(this),this.createUserModal.beforeOpen=()=>e(this,void 0,void 0,(function*(){yield t(this,c,"f").call(this),t(this,r,"m",d).call(this)}))}))},d=function(){const e=K(this.state);this.getFormFieldNames(this.createUserModal.ele).forEach((t=>{const[s,i]=t.split(".");if("customAttributes"!==s)return;const o=e.find((e=>e.name===i));o?o.editable||this.disableFormField(this.createUserModal.ele,t):this.removeFormField(this.createUserModal.ele,t)}))},u})),mt=d((s=>{var i,o,r;return r=class extends(l(g,gt,vt)(s)){constructor(){super(...arguments),i.add(this)}onWidgetRootReady(){const s=Object.create(null,{onWidgetRootReady:{get:()=>super.onWidgetRootReady}});return e(this,void 0,void 0,(function*(){var e;yield null===(e=s.onWidgetRootReady)||void 0===e?void 0:e.call(this),t(this,i,"m",o).call(this)}))}},i=new WeakSet,o=function(){var e;this.createButton=new S(null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector('[data-id="create-user"]'),{logger:this.logger}),this.createButton.onClick((()=>this.createUserModal.open()))},r})),ft=d((s=>{var i,r,a;return a=class extends(l(ut,W,g,vt)(s)){constructor(){super(...arguments),i.add(this)}onWidgetRootReady(){const s=Object.create(null,{onWidgetRootReady:{get:()=>super.onWidgetRootReady}});return e(this,void 0,void 0,(function*(){var e;yield null===(e=s.onWidgetRootReady)||void 0===e?void 0:e.call(this),yield t(this,i,"m",r).call(this)}))}},i=new WeakSet,r=function(){return e(this,void 0,void 0,(function*(){var e;this.deleteUsersModal=this.createModal(),this.deleteUsersModal.setContent(o(yield this.fetchWidgetPage("delete-users-modal.html")));const t=new S((()=>{var e;return null===(e=this.deleteUsersModal.ele)||void 0===e?void 0:e.querySelector('[data-id="modal-cancel"]')}),{logger:this.logger});t.onClick((()=>this.deleteUsersModal.close()));const s=new S((()=>{var e;return null===(e=this.deleteUsersModal.ele)||void 0===e?void 0:e.querySelector('[data-id="modal-submit"]')}),{logger:this.logger});s.onClick((()=>{const e=ee(this.state);this.actions.deleteUsers(e),this.deleteUsersModal.close()}));const i=new I(null===(e=this.deleteUsersModal.ele)||void 0===e?void 0:e.querySelector('[data-id="body-text"]'),{logger:this.logger});this.deleteUsersModal.beforeOpen=()=>{const e=le(this.state);i.text=`Delete ${e}?`}}))},a})),pt=d((s=>{var i,o,r,a;return a=class extends(l(g,vt,ut,ft)(s)){constructor(){super(...arguments),i.add(this),r.set(this,c((e=>{e?this.deleteButton.enable():this.deleteButton.disable()})))}onWidgetRootReady(){const s=Object.create(null,{onWidgetRootReady:{get:()=>super.onWidgetRootReady}});return e(this,void 0,void 0,(function*(){var e;t(this,i,"m",o).call(this),yield null===(e=s.onWidgetRootReady)||void 0===e?void 0:e.call(this),this.subscribe(t(this,r,"f").bind(this),me)}))}},r=new WeakMap,i=new WeakSet,o=function(){var e;this.deleteButton=new S(null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector('[data-id="delete-users"]'),{logger:this.logger}),this.deleteButton.disable(),this.deleteButton.onClick((()=>{this.deleteUsersModal.open()}))},a})),yt=d((s=>{var i,r,a,n,d;return d=class extends(l(ut,W,g,U,vt)(s)){constructor(){super(...arguments),i.add(this)}onWidgetRootReady(){const s=Object.create(null,{onWidgetRootReady:{get:()=>super.onWidgetRootReady}});return e(this,void 0,void 0,(function*(){var e;yield null===(e=s.onWidgetRootReady)||void 0===e?void 0:e.call(this),yield t(this,i,"m",n).call(this)}))}},i=new WeakSet,r=function(){new S((()=>{var e;return null===(e=this.disableUserModal.ele)||void 0===e?void 0:e.querySelector('[data-id="modal-cancel"]')}),{logger:this.logger}).onClick((()=>this.disableUserModal.close()))},a=function(){new S((()=>{var e;return null===(e=this.disableUserModal.ele)||void 0===e?void 0:e.querySelector('[data-id="modal-submit"]')}),{logger:this.logger}).onClick((()=>{const e=ae(this.state);this.actions.disableUser(e),this.disableUserModal.close()}))},n=function(){return e(this,void 0,void 0,(function*(){var s;this.disableUserModal=this.createModal(),this.disableUserModal.setContent(o(yield this.fetchWidgetPage("disable-user-modal.html"))),t(this,i,"m",r).call(this),t(this,i,"m",a).call(this);const n=new I(null===(s=this.disableUserModal.ele)||void 0===s?void 0:s.querySelector('[data-id="body-text"]'),{logger:this.logger});this.disableUserModal.beforeOpen=()=>e(this,void 0,void 0,(function*(){const e=le(this.state);n.text=`Disable ${e}?`}))}))},d})),bt=d((s=>{var i,o,r,a;return a=class extends(l(g,vt,ut,yt,U)(s)){constructor(){super(...arguments),i.add(this),r.set(this,c((e=>{e?this.disableButton.enable():this.disableButton.disable()})))}onWidgetRootReady(){const s=Object.create(null,{onWidgetRootReady:{get:()=>super.onWidgetRootReady}});return e(this,void 0,void 0,(function*(){var e;t(this,i,"m",o).call(this),yield null===(e=s.onWidgetRootReady)||void 0===e?void 0:e.call(this),this.subscribe(t(this,r,"f").bind(this),ue)}))}},r=new WeakMap,i=new WeakSet,o=function(){var e;this.disableButton=new S(null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector('[data-id="disable-user"]'),{logger:this.logger}),this.disableButton.disable(),this.disableButton.onClick((()=>{this.disableUserModal.open()}))},a})),wt=e=>{if(!e)return e;const t=F(e),s=new RegExp(`(\\+?${null==t?void 0:t.countryCallingCode})(.*)`);return t.number.replace(s,"$1-$2")},Rt=d((r=>{var a,n,d,c,u,h,v,m,f,p;return p=class extends(l(ut,W,g,U,vt)(r)){constructor(){super(...arguments),a.add(this),n.set(this,void 0),d.set(this,void 0),h.set(this,(()=>e(this,void 0,void 0,(function*(){yield t(this,d,"f").setData(J(this.state).map((({name:e})=>({value:e,label:e}))))})))),m.set(this,(()=>{var e,t;const s=null===(e=_(this.state))||void 0===e?void 0:e[0],i=Object.assign({loginId:null===(t=null==s?void 0:s.loginIds)||void 0===t?void 0:t.join(", "),displayName:null==s?void 0:s.name,email:null==s?void 0:s.email,phone:wt(null==s?void 0:s.phone),roles:null==s?void 0:s.roles,givenName:null==s?void 0:s.givenName,familyName:null==s?void 0:s.familyName,middleName:null==s?void 0:s.middleName},B(s.customAttributes,"customAttributes"));this.setFormData(this.editUserModal.ele,i)}))}onWidgetRootReady(){const s=Object.create(null,{onWidgetRootReady:{get:()=>super.onWidgetRootReady}});return e(this,void 0,void 0,(function*(){var e;yield null===(e=s.onWidgetRootReady)||void 0===e?void 0:e.call(this),yield t(this,a,"m",f).call(this)}))}},n=new WeakMap,d=new WeakMap,h=new WeakMap,m=new WeakMap,a=new WeakSet,c=function(){new S((()=>{var e;return null===(e=this.editUserModal.ele)||void 0===e?void 0:e.querySelector('[data-id="modal-cancel"]')}),{logger:this.logger}).onClick((()=>this.editUserModal.close()))},u=function(){new S((()=>{var e;return null===(e=this.editUserModal.ele)||void 0===e?void 0:e.querySelector('[data-id="modal-submit"]')}),{logger:this.logger}).onClick((()=>{if(this.validateForm(this.editUserModal.ele)){const e=this.getFormData(this.editUserModal.ele),{loginId:t}=e,s=i(e,["loginId"]);this.actions.updateUser(Object.assign({loginId:t.split(", ")[0]},E(s,"customAttributes"))),this.editUserModal.close(),this.resetFormData(this.editUserModal.ele)}}))},v=function(){const e=K(this.state);this.getFormFieldNames(this.editUserModal.ele).forEach((t=>{const[s,i]=t.split(".");if("customAttributes"!==s)return;const o=e.find((e=>e.name===i));o?o.editable||this.disableFormField(this.editUserModal.ele,t):this.removeFormField(this.editUserModal.ele,t)}))},f=function(){return e(this,void 0,void 0,(function*(){var i;this.editUserModal=this.createModal(),this.editUserModal.setContent(o(yield this.fetchWidgetPage("edit-user-modal.html"))),t(this,a,"m",c).call(this),t(this,a,"m",u).call(this),s(this,n,new j(null===(i=this.editUserModal.ele)||void 0===i?void 0:i.querySelector('[name="loginId"]'),{logger:this.logger}),"f"),s(this,d,new x((()=>{var e;return null===(e=this.editUserModal.ele)||void 0===e?void 0:e.querySelector('[data-id="roles-multiselect"]')}),{logger:this.logger}),"f"),this.editUserModal.beforeOpen=()=>e(this,void 0,void 0,(function*(){yield t(this,h,"f").call(this),t(this,n,"f").disable(),t(this,m,"f").call(this),t(this,a,"m",v).call(this)}))}))},p})),Mt=d((s=>{var i,o,r,a;return a=class extends(l(g,vt,ut,Rt,U)(s)){constructor(){super(...arguments),i.add(this),r.set(this,c((e=>{e?this.editButton.enable():this.editButton.disable()})))}onWidgetRootReady(){const s=Object.create(null,{onWidgetRootReady:{get:()=>super.onWidgetRootReady}});return e(this,void 0,void 0,(function*(){var e;t(this,i,"m",o).call(this),yield null===(e=s.onWidgetRootReady)||void 0===e?void 0:e.call(this),this.subscribe(t(this,r,"f").bind(this),he)}))}},r=new WeakMap,i=new WeakSet,o=function(){var e;this.editButton=new S(null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector('[data-id="edit-user"]'),{logger:this.logger}),this.editButton.disable(),this.editButton.onClick((()=>{this.editUserModal.open()}))},a})),Wt=d((s=>{var i,r,a,n,d;return d=class extends(l(ut,W,g,U,vt)(s)){constructor(){super(...arguments),i.add(this)}onWidgetRootReady(){const s=Object.create(null,{onWidgetRootReady:{get:()=>super.onWidgetRootReady}});return e(this,void 0,void 0,(function*(){var e;yield null===(e=s.onWidgetRootReady)||void 0===e?void 0:e.call(this),yield t(this,i,"m",n).call(this)}))}},i=new WeakSet,r=function(){new S((()=>{var e;return null===(e=this.enableUserModal.ele)||void 0===e?void 0:e.querySelector('[data-id="modal-cancel"]')}),{logger:this.logger}).onClick((()=>this.enableUserModal.close()))},a=function(){new S((()=>{var e;return null===(e=this.enableUserModal.ele)||void 0===e?void 0:e.querySelector('[data-id="modal-submit"]')}),{logger:this.logger}).onClick((()=>{const e=ae(this.state);this.actions.enableUser(e),this.enableUserModal.close()}))},n=function(){return e(this,void 0,void 0,(function*(){var s;this.enableUserModal=this.createModal(),this.enableUserModal.setContent(o(yield this.fetchWidgetPage("enable-user-modal.html"))),t(this,i,"m",r).call(this),t(this,i,"m",a).call(this);const n=new I(null===(s=this.enableUserModal.ele)||void 0===s?void 0:s.querySelector('[data-id="body-text"]'),{logger:this.logger});this.enableUserModal.beforeOpen=()=>e(this,void 0,void 0,(function*(){const e=le(this.state);n.text=`Activate ${e}?`}))}))},d})),Ut=d((s=>{var i,o,r,a;return a=class extends(l(g,vt,ut,Wt,U)(s)){constructor(){super(...arguments),i.add(this),r.set(this,c((e=>{e?this.enableButton.enable():this.enableButton.disable()})))}onWidgetRootReady(){const s=Object.create(null,{onWidgetRootReady:{get:()=>super.onWidgetRootReady}});return e(this,void 0,void 0,(function*(){var e;t(this,i,"m",o).call(this),yield null===(e=s.onWidgetRootReady)||void 0===e?void 0:e.call(this),this.subscribe(t(this,r,"f").bind(this),ce)}))}},r=new WeakMap,i=new WeakSet,o=function(){var e;this.enableButton=new S(null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector('[data-id="enable-user"]'),{logger:this.logger}),this.enableButton.disable(),this.enableButton.onClick((()=>{this.enableUserModal.open()}))},a})),kt=d((s=>{var i,o,r,a;return a=class extends(l(g,vt,ut)(s)){constructor(){super(...arguments),i.add(this),o.set(this,u((()=>{this.actions.searchUsers({text:this.searchInput.value})})))}onWidgetRootReady(){const s=Object.create(null,{onWidgetRootReady:{get:()=>super.onWidgetRootReady}});return e(this,void 0,void 0,(function*(){var e;yield null===(e=s.onWidgetRootReady)||void 0===e?void 0:e.call(this),t(this,i,"m",r).call(this)}))}},o=new WeakMap,i=new WeakSet,r=function(){var e;this.searchInput=new j(null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector('[data-id="search-input"]'),{logger:this.logger}),this.searchInput.onInput(t(this,o,"f"))},a}));const Ct={success:(new DOMParser).parseFromString('<svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">\n<g id="Checkmark">\n<path id="Shape" d="M10.0485 15.6396C9.5799 15.171 8.8201 15.171 8.35147 15.6396C7.88284 16.1082 7.88284 16.868 8.35147 17.3367L12.7072 21.6924C13.1759 22.1611 13.9357 22.1611 14.4043 21.6924L24.7152 11.3815C25.1838 10.9129 25.1838 10.1531 24.7152 9.68448C24.2466 9.21585 23.4868 9.21585 23.0181 9.68448L13.5558 19.1469L10.0485 15.6396Z" fill="currentcolor"/>\n</g>\n</svg>\n',"image/svg+xml").firstChild,error:(new DOMParser).parseFromString('<svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">\n<g id="Icon">\n<path id="Vector" d="M15.9998 26.6558C10.1118 26.6558 5.34375 21.8878 5.34375 15.9998C5.34375 10.1118 10.1118 5.34375 15.9998 5.34375C21.8878 5.34375 26.6558 10.1118 26.6558 15.9998C26.6558 21.8878 21.8878 26.6558 15.9998 26.6558ZM15.9998 24.4798C20.6718 24.4798 24.4798 20.7038 24.4798 15.9998C24.4798 11.3278 20.7038 7.51975 15.9998 7.51975C11.3278 7.51975 7.51975 11.2958 7.51975 15.9998C7.51975 20.6718 11.2958 24.4798 15.9998 24.4798ZM15.3278 9.34375H16.6718C17.0558 9.34375 17.3438 9.63175 17.3118 9.98375L16.9598 16.9278C16.9598 17.1838 16.7678 17.3438 16.5438 17.3438H15.4558C15.2318 17.3438 15.0398 17.1518 15.0398 16.9278L14.6878 9.98375C14.6878 9.63175 14.9758 9.34375 15.3278 9.34375ZM15.4558 19.4558H16.5438C16.9278 19.4558 17.2158 19.7438 17.1838 20.1278V21.1838C17.1838 21.5678 16.8958 21.8558 16.5438 21.8558H15.4558C15.0718 21.8558 14.7838 21.5678 14.7838 21.1838V20.1278C14.7838 19.7438 15.0718 19.4558 15.4558 19.4558Z" fill="currentcolor"/>\n</g>\n</svg>\n',"image/svg+xml").firstChild},Pt=d((s=>{var i,o,r,a,n;return n=class extends(l(g,ut,k,b)(s)){constructor(){super(...arguments),i.add(this),a.set(this,c((e=>{e.length&&(e.forEach((({type:e,msg:s})=>{const a=t(this,i,"m",r).call(this,e);a.setContent(t(this,i,"m",o).call(this,{type:e,msg:s})),a.show()})),setTimeout((()=>this.actions.clearNotifications())))})))}init(){const s=Object.create(null,{init:{get:()=>super.init}});return e(this,void 0,void 0,(function*(){var e;yield null===(e=s.init)||void 0===e?void 0:e.call(this),this.subscribe(t(this,a,"f").bind(this),G)}))}},a=new WeakMap,i=new WeakSet,o=function({type:e,msg:t}){const s=Ct[e],i=Object.assign((new DOMParser).parseFromString('<svg width="2em" height="2em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<g id="Icon">\n<path id="Shape" d="M10.6712 12L7.27521 8.60406C6.90826 8.23711 6.90826 7.64216 7.27521 7.27521C7.64216 6.90826 8.23711 6.90826 8.60406 7.27521L12 10.6712L15.3959 7.27521C15.7629 6.90826 16.3578 6.90826 16.7248 7.27521C17.0917 7.64216 17.0917 8.23711 16.7248 8.60406L13.3288 12L16.7248 15.3959C17.0917 15.7629 17.0917 16.3578 16.7248 16.7248C16.3578 17.0917 15.7629 17.0917 15.3959 16.7248L12 13.3288L8.60406 16.7248C8.23711 17.0917 7.64216 17.0917 7.27521 16.7248C6.90826 16.3578 6.90826 15.7629 7.27521 15.3959L10.6712 12Z" fill="currentcolor"/>\n</g>\n</svg>\n',"image/svg+xml").firstChild,{slot:"close"});return`${(null==s?void 0:s.outerHTML)||""}${t}${i.outerHTML}`},r=function(e){return this.createNotification({mode:e,duration:"error"===e?0:3e3,position:"bottom-start",size:"sm"})},n})),St=d((s=>{var i,r,a,n,d;return d=class extends(l(ut,W,g,U,vt)(s)){constructor(){super(...arguments),i.add(this)}onWidgetRootReady(){const s=Object.create(null,{onWidgetRootReady:{get:()=>super.onWidgetRootReady}});return e(this,void 0,void 0,(function*(){var e;yield null===(e=s.onWidgetRootReady)||void 0===e?void 0:e.call(this),yield t(this,i,"m",n).call(this)}))}},i=new WeakSet,r=function(){new S((()=>{var e;return null===(e=this.removePasskeyModal.ele)||void 0===e?void 0:e.querySelector('[data-id="modal-cancel"]')}),{logger:this.logger}).onClick((()=>this.removePasskeyModal.close()))},a=function(){new S((()=>{var e;return null===(e=this.removePasskeyModal.ele)||void 0===e?void 0:e.querySelector('[data-id="modal-submit"]')}),{logger:this.logger}).onClick((()=>{const e=ae(this.state);this.actions.removePasskey(e),this.removePasskeyModal.close()}))},n=function(){return e(this,void 0,void 0,(function*(){var s;this.removePasskeyModal=this.createModal(),this.removePasskeyModal.setContent(o(yield this.fetchWidgetPage("remove-passkey-modal.html"))),t(this,i,"m",r).call(this),t(this,i,"m",a).call(this);const n=new I(null===(s=this.removePasskeyModal.ele)||void 0===s?void 0:s.querySelector('[data-id="body-text"]'),{logger:this.logger});this.removePasskeyModal.beforeOpen=()=>e(this,void 0,void 0,(function*(){const e=le(this.state);n.text=`Remove passkey for ${e}?`}))}))},d})),xt=d((s=>{var i,o,r,a;return a=class extends(l(g,vt,ut,St,U)(s)){constructor(){super(...arguments),i.add(this),r.set(this,c((e=>{e?this.removePasskeyButton.enable():this.removePasskeyButton.disable()})))}onWidgetRootReady(){const s=Object.create(null,{onWidgetRootReady:{get:()=>super.onWidgetRootReady}});return e(this,void 0,void 0,(function*(){var e;t(this,i,"m",o).call(this),yield null===(e=s.onWidgetRootReady)||void 0===e?void 0:e.call(this),this.subscribe(t(this,r,"f").bind(this),ve)}))}},r=new WeakMap,i=new WeakSet,o=function(){var e;this.removePasskeyButton=new S(null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector('[data-id="remove-passkey"]'),{logger:this.logger}),this.removePasskeyButton.disable(),this.removePasskeyButton.onClick((()=>{this.removePasskeyModal.open()}))},a})),It=d((s=>{var i,o,r,a,n,d,h,v;return v=class extends(l(ut,g,vt)(s)){constructor(){super(...arguments),i.add(this),a.set(this,c((e=>{this.usersTable.data=e}))),n.set(this,u(((e,t)=>{const s=[],{value:i}=t;if(i){const t=e.path;s.push({field:t,desc:"desc"===i})}this.actions.searchUsers({sort:s})}))),d.set(this,c((e=>{this.usersTable.filterColumns((t=>{var s;const[i,o]=(null===(s=t.path)||void 0===s?void 0:s.split("."))||[];return"customAttributes"!==i||!!(null==e?void 0:e.find((e=>e.name===o)))}))})))}onWidgetRootReady(){const s=Object.create(null,{onWidgetRootReady:{get:()=>super.onWidgetRootReady}});return e(this,void 0,void 0,(function*(){var e;yield null===(e=s.onWidgetRootReady)||void 0===e?void 0:e.call(this),t(this,i,"m",r).call(this),t(this,a,"f").call(this,Y(this.state)),t(this,d,"f").call(this,K(this.state)),this.subscribe(t(this,d,"f").bind(this),K),this.subscribe(t(this,a,"f").bind(this),Y)}))}},a=new WeakMap,n=new WeakMap,d=new WeakMap,i=new WeakSet,o=function(){const e=e=>{var t;return null===(t=this.usersTable.ele)||void 0===t?void 0:t.querySelector(`[path="${e}"]`)},t=e=>{var t;const s=`descope-grid-${e}-column`;return null===(t=this.usersTable.ele)||void 0===t?void 0:t.querySelector(s)},s=this.usersTable.renderColumn;this.usersTable.renderColumn=({path:i,header:o,type:r,attrs:a})=>{const n=e(i)||t(r);if(!n)return s({path:i,header:o,type:r,attrs:a});const d=n.cloneNode(!0),l=Object.assign(Object.assign({},a),{header:o});return Object.entries(l).forEach((([e,t])=>{d.setAttribute(e,t)})),d.outerHTML}},r=function(){var e;this.usersTable=new N(null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector('[data-id="users-table"]'),{logger:this.logger}),this.usersTable.onSelectedItemsChange((e=>{this.actions.setSelectedUsersIds(e.detail.value.map((({loginIds:e})=>e)))})),this.usersTable.onColumnsChange(t(this,i,"m",h).bind(this)),t(this,i,"m",o).call(this),t(this,i,"m",h).call(this)},h=function(){this.usersTable.columns.forEach((e=>{e.onSortDirectionChange((e=>{t(this,n,"f").call(this,e.target,e.detail)}))}))},v})),jt=d((s=>{var i,r,a;return a=class extends(l(ut,W,g,U,vt)(s)){constructor(){super(...arguments),i.add(this)}onWidgetRootReady(){const s=Object.create(null,{onWidgetRootReady:{get:()=>super.onWidgetRootReady}});return e(this,void 0,void 0,(function*(){var e;yield null===(e=s.onWidgetRootReady)||void 0===e?void 0:e.call(this),yield t(this,i,"m",r).call(this)}))}},i=new WeakSet,r=function(){return e(this,void 0,void 0,(function*(){this.generatedPasswordModal=this.createModal(),this.generatedPasswordModal.setContent(o(yield this.fetchWidgetPage("generated-password-modal.html")));new S((()=>{var e;return null===(e=this.generatedPasswordModal.ele)||void 0===e?void 0:e.querySelector('[data-id="modal-close"]')}),{logger:this.logger}).onClick((()=>{navigator.clipboard.writeText(this.getFormData(this.generatedPasswordModal.ele)["generated-password"]),this.resetFormData(this.generatedPasswordModal.ele),this.generatedPasswordModal.close()}))}))},a})),Nt=d((s=>{var i,r,a,n,d;return d=class extends(l(ut,W,g,U,vt,jt)(s)){constructor(){super(...arguments),i.add(this)}onWidgetRootReady(){const s=Object.create(null,{onWidgetRootReady:{get:()=>super.onWidgetRootReady}});return e(this,void 0,void 0,(function*(){var e;yield null===(e=s.onWidgetRootReady)||void 0===e?void 0:e.call(this),yield t(this,i,"m",n).call(this)}))}},i=new WeakSet,r=function(){new S((()=>{var e;return null===(e=this.resetPasswordModal.ele)||void 0===e?void 0:e.querySelector('[data-id="modal-cancel"]')}),{logger:this.logger}).onClick((()=>this.resetPasswordModal.close()))},a=function(){new S((()=>{var e;return null===(e=this.resetPasswordModal.ele)||void 0===e?void 0:e.querySelector('[data-id="modal-submit"]')}),{logger:this.logger}).onClick((()=>e(this,void 0,void 0,(function*(){var e;const t=ae(this.state),s=yield this.actions.setTempUserPassword(t);this.resetPasswordModal.close(),this.setFormData(this.generatedPasswordModal.ele,{"generated-password":null===(e=null==s?void 0:s.payload)||void 0===e?void 0:e.cleartext}),this.generatedPasswordModal.open()}))))},n=function(){return e(this,void 0,void 0,(function*(){var s;this.resetPasswordModal=this.createModal(),this.resetPasswordModal.setContent(o(yield this.fetchWidgetPage("reset-password-modal.html"))),t(this,i,"m",r).call(this),t(this,i,"m",a).call(this);const n=new I(null===(s=this.resetPasswordModal.ele)||void 0===s?void 0:s.querySelector('[data-id="body-text"]'),{logger:this.logger});this.resetPasswordModal.beforeOpen=()=>e(this,void 0,void 0,(function*(){const e=le(this.state);n.text=`This will generate a new temporary password for ${e}?`}))}))},d})),Ot=d((s=>{var i,o,r,a;return a=class extends(l(g,vt,ut,Nt,U)(s)){constructor(){super(...arguments),i.add(this),r.set(this,c((e=>{e?this.resetPasswordButton.enable():this.resetPasswordButton.disable()})))}onWidgetRootReady(){const s=Object.create(null,{onWidgetRootReady:{get:()=>super.onWidgetRootReady}});return e(this,void 0,void 0,(function*(){var e;t(this,i,"m",o).call(this),yield null===(e=s.onWidgetRootReady)||void 0===e?void 0:e.call(this),this.subscribe(t(this,r,"f").bind(this),ge)}))}},r=new WeakMap,i=new WeakSet,o=function(){var e;this.resetPasswordButton=new S(null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector('[data-id="reset-password"]'),{logger:this.logger}),this.resetPasswordButton.disable(),this.resetPasswordButton.onClick((()=>{this.resetPasswordModal.open()}))},a})),Lt=d((e=>class extends(l(C,v)(e)){syncFlowTheme(e){e.theme=this.theme,this.observeAttributes(["theme"],(()=>{e.theme=this.theme}))}})),Tt=d((i=>{var o,r,a,n,d,u,h,v,m,f,p,y,b,w;return w=class extends(l(Lt,ut,W,g,U,vt)(i)){constructor(){super(...arguments),o.add(this),r.set(this,void 0),a.set(this,void 0),n.set(this,[]),d.set(this,null),u.set(this,null),b.set(this,c((e=>{t(this,n,"f").forEach((t=>{"onlyOne"===t.enableMode&&1===e.length||"oneOrMore"===t.enableMode&&e.length>0||"always"===t.enableMode?t.enable():t.disable()}))})))}onWidgetRootReady(){const s=Object.create(null,{onWidgetRootReady:{get:()=>super.onWidgetRootReady}});return e(this,void 0,void 0,(function*(){var e;yield null===(e=s.onWidgetRootReady)||void 0===e?void 0:e.call(this),t(this,o,"m",m).call(this),t(this,o,"m",v).call(this),t(this,b,"f").call(this,z(this.state))}))}},r=new WeakMap,a=new WeakMap,n=new WeakMap,d=new WeakMap,u=new WeakMap,b=new WeakMap,o=new WeakSet,h=function(e){const s=new L(e,{logger:this.logger});s.onClick((()=>{t(this,o,"m",y).call(this,s.flowId)})),this.subscribe(t(this,b,"f").bind(this),z),t(this,n,"f").push(s)},v=function(){var e;const s=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelectorAll("[data-generic-flow-button-id]");Array.from(s).forEach((e=>{t(this,o,"m",h).call(this,e)}))},m=function(){s(this,r,this.createModal({"data-id":"generic-flow-modal"}),"f"),t(this,r,"f").afterClose=()=>{var e;t(this,d,"f")&&(null===(e=t(this,u,"f"))||void 0===e||e.call(this),s(this,d,null,"f"))},s(this,a,new O((()=>{var e;return null===(e=t(this,r,"f").ele)||void 0===e?void 0:e.querySelector("descope-wc")}),{logger:this.logger}),"f"),this.syncFlowTheme(t(this,a,"f"))},f=function(){var e;t(this,r,"f").open(),null===(e=t(this,u,"f"))||void 0===e||e.call(this)},p=function(e,i){i=()=>t(this,o,"m",f).call(this),s(this,u,t(this,a,"f").onPageUpdated(i),"f")},y=function(e){t(this,r,"f").setContent(H({projectId:this.projectId,flowId:e,baseUrl:this.baseUrl,baseStaticUrl:this.baseStaticUrl,baseCdnUrl:this.baseCdnUrl,refreshCookieName:this.refreshCookieName,theme:this.theme,client:JSON.stringify({userIds:ee(this.state),loginIds:te(this.state)})})),t(this,o,"m",p).call(this,t(this,r,"f"),t(this,d,"f")),t(this,a,"f").onSuccess((()=>{t(this,r,"f").close(),this.actions.searchUsers()}))},w})),At="widget-flow",qt=d((s=>{var i,o,r;return r=class extends(l(b,W,ut,f,g,C)(s)){constructor(){super(...arguments),i.add(this)}init(){const s=Object.create(null,{init:{get:()=>super.init}});return e(this,void 0,void 0,(function*(){var e;yield null===(e=s.init)||void 0===e?void 0:e.call(this);const r=Z(At);r&&(!function(e){if(window.history.replaceState&&Z(e)){const t=new URL(window.location.href),s=new URLSearchParams(t.search);s.delete(e),t.search=s.toString(),window.history.replaceState({},"",t.toString())}}(At),t(this,i,"m",o).call(this,r))}))}},i=new WeakSet,o=function(e){const t=this.createModal({"data-id":"redirect-flow"});t.setContent(H({projectId:this.projectId,flowId:e,baseUrl:this.baseUrl,baseStaticUrl:this.baseStaticUrl,baseCdnUrl:this.baseCdnUrl,refreshCookieName:this.refreshCookieName,theme:this.theme}));new O((()=>{var e;return null===(e=t.ele)||void 0===e?void 0:e.querySelector("descope-wc")}),{logger:this.logger}).onSuccess((()=>{t.close()})),t.afterClose=()=>{t.remove()},t.open()},r})),Ft=d((t=>class extends(l(P,C,qt,It,mt,pt,Mt,Ut,bt,Ot,xt,kt,Pt,Tt)(t)){init(){const t=Object.create(null,{init:{get:()=>super.init}});return e(this,void 0,void 0,(function*(){var e;yield null===(e=t.init)||void 0===e?void 0:e.call(this)}))}})),$t=l((t=>class extends(Ft(t)){init(){const t=Object.create(null,{init:{get:()=>super.init}});return e(this,void 0,void 0,(function*(){var e;yield null===(e=t.init)||void 0===e?void 0:e.call(this);(customElements.get("descope-wc")||(yield import("@descope/web-component").then((e=>e.default)))).sdkConfigOverrides={baseHeaders:{"x-descope-widget-type":"user-management-widget","x-descope-widget-id":this.getAttribute("widget-id"),"x-descope-widget-version":"0.9.6"}}}))}}))(HTMLElement);customElements.define("descope-user-management-widget",$t);export{$t as default};
//# sourceMappingURL=index.js.map
