import{__rest as e}from"../node_modules/.pnpm/@rollup_plugin-typescript@11.1.6_rollup@4.22.4_tslib@2.8.1_typescript@5.4.5/node_modules/tslib/tslib.es6.js";import t,{lazy as r,useMemo as n,useState as s,useImperativeHandle as o,useCallback as a,useEffect as l,Suspense as u}from"react";import{baseHeaders as d}from"../constants.js";import i from"../hooks/Context.js";import{getGlobalSdk as c}from"../sdk.js";import p from"./withPropsMapping/index.js";const m=r((async()=>(((null===customElements||void 0===customElements?void 0:customElements.get("descope-wc"))||await import("@descope/web-component").then((e=>e.default))).sdkConfigOverrides={baseHeaders:d,persistTokens:!1,hooks:{get beforeRequest(){return c().httpClient.hooks.beforeRequest},set beforeRequest(e){}}},{default:p(t.forwardRef(((r,s)=>{var{"external-request-id":o}=r,a=e(r,["external-request-id"]);return n((()=>{var e,t;e="x-external-rid",(t=o)?d[e]=t:delete d[e]}),[o]),t.createElement("descope-wc",Object.assign({ref:s},a))})))}))),f=t.forwardRef((({flowId:e,onSuccess:r,onError:n,onReady:d,logger:c,tenant:p,theme:f,nonce:v,locale:E,debug:b,client:h,form:L,telemetryKey:g,redirectUrl:y,autoFocus:k,validateOnBlur:U,restartOnError:w,errorTransformer:x,styleId:I,onScreenUpdate:R,dismissScreenErrorOnInput:C,outboundAppId:j,outboundAppScopes:q,children:O,externalRequestId:S},A)=>{const[_,N]=s(null);o(A,(()=>_));const{projectId:T,baseUrl:B,baseStaticUrl:F,baseCdnUrl:K,storeLastAuthenticatedUser:H,keepLastAuthenticatedUserAfterLogout:J,refreshCookieName:M,sdk:P}=t.useContext(i),z=a((async e=>{await P.httpClient.hooks.afterRequest({},new Response(JSON.stringify(e.detail))),r&&r(e)}),[r]);return l((()=>{const e=_;return null==e||e.addEventListener("success",z),n&&(null==e||e.addEventListener("error",n)),d&&(null==e||e.addEventListener("ready",d)),()=>{n&&(null==e||e.removeEventListener("error",n)),d&&(null==e||e.removeEventListener("ready",d)),null==e||e.removeEventListener("success",z)}}),[_,n,z]),l((()=>{const e=_;return null==e||e.addEventListener("success",z),()=>{null==e||e.removeEventListener("success",z)}}),[_,z]),l((()=>{const e=_;return n&&(null==e||e.addEventListener("error",n)),()=>{n&&(null==e||e.removeEventListener("error",n))}}),[_,n]),l((()=>{const e=_;return d&&(null==e||e.addEventListener("ready",d)),()=>{d&&(null==e||e.removeEventListener("error",d))}}),[_,d]),t.createElement("form",null,t.createElement(u,{fallback:null},t.createElement(m,{projectId:T,flowId:e,baseUrl:B,baseStaticUrl:F,baseCdnUrl:K,ref:N,telemetryKey:g,redirectUrl:y,autoFocus:k,styleId:I,validateOnBlur:U,restartOnError:w,keepLastAuthenticatedUserAfterLogout:J,tenant:p,externalRequestId:S,"theme.attr":f,"nonce.attr":v,"locale.attr":E,"form.attr":L,"client.attr":h,"debug.attr":b,"outbound-app-id.attr":j,"outbound-app-scopes.attr":q,"store-last-authenticated-user.attr":H,"refreshCookieName.attr":M,"dismiss-screen-error-on-input.attr":C,"errorTransformer.prop":x,"logger.prop":c,"onScreenUpdate.prop":R},O)))}));export{f as default};
//# sourceMappingURL=Descope.js.map
